<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="《Java编程思想》第19章枚举类型" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="19.1 基本enum特性" /><meta property="og:description" content="19.1 基本enum特性" /><link rel="canonical" href="https://malinkang.cn/posts/thinking-in-java-enumerated-types/" /><meta property="og:url" content="https://malinkang.cn/posts/thinking-in-java-enumerated-types/" /><meta property="og:site_name" content="malinkang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2013-07-16T21:39:36+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="《Java编程思想》第19章枚举类型" /><meta name="twitter:site" content="@malinkang" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"19.1 基本enum特性","headline":"《Java编程思想》第19章枚举类型","dateModified":"2013-07-16T21:39:36+08:00","url":"https://malinkang.cn/posts/thinking-in-java-enumerated-types/","datePublished":"2013-07-16T21:39:36+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://malinkang.cn/posts/thinking-in-java-enumerated-types/"},"@context":"https://schema.org"}</script><title>《Java编程思想》第19章枚举类型 | malinkang</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="malinkang"><meta name="application-name" content="malinkang"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/images/avatar.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">malinkang</a></div><div class="site-subtitle font-italic">人生最可悲的事情，莫过于胸怀大志，却又虚度光阴。</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/malinkang" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/malinkang" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['linkang.ma','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>《Java编程思想》第19章枚举类型</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>《Java编程思想》第19章枚举类型</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> malinkang </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jul 16, 2013, 9:39 PM +0800" prep="on" > Jul 16, 2013 <i class="unloaded">2013-07-16T21:39:36+08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6438 words">35 min</span></div></div><div class="post-content"><h2 id="191-基本enum特性">19.1 基本enum特性</h2><p>调用<code class="language-plaintext highlighter-rouge">enum</code>的<code class="language-plaintext highlighter-rouge">values()</code>方法，可以遍历<code class="language-plaintext highlighter-rouge">enum</code>实例。<code class="language-plaintext highlighter-rouge">values()</code>方法返回<code class="language-plaintext highlighter-rouge">enum</code>实例的数组，而且该数组中的元素严格保持其在<code class="language-plaintext highlighter-rouge">enum</code>中声明时的顺序。</p><p>创建<code class="language-plaintext highlighter-rouge">enum</code>时，编译器会为你生成一个相关的类，这个类继承自<code class="language-plaintext highlighter-rouge">java.lang.Enum</code>。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/EnumClass.java</span>
<span class="c1">// Capabilities of the Enum class</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">enum</span> <span class="nc">Shrubbery</span> <span class="o">{</span> <span class="no">GROUND</span><span class="o">,</span> <span class="no">CRAWLING</span><span class="o">,</span> <span class="no">HANGING</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EnumClass</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Shrubbery</span> <span class="n">s</span> <span class="o">:</span> <span class="nc">Shrubbery</span><span class="o">.</span><span class="na">values</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">print</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">" ordinal: "</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="na">ordinal</span><span class="o">());</span>
      <span class="n">printnb</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="nc">Shrubbery</span><span class="o">.</span><span class="na">CRAWLING</span><span class="o">)</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
      <span class="n">printnb</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">Shrubbery</span><span class="o">.</span><span class="na">CRAWLING</span><span class="o">)</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
      <span class="n">print</span><span class="o">(</span><span class="n">s</span> <span class="o">==</span> <span class="nc">Shrubbery</span><span class="o">.</span><span class="na">CRAWLING</span><span class="o">);</span>
      <span class="n">print</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">getDeclaringClass</span><span class="o">());</span>
      <span class="n">print</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">name</span><span class="o">());</span>
      <span class="n">print</span><span class="o">(</span><span class="s">"----------------------"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">// Produce an enum value from a string name:</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="s">"HANGING CRAWLING GROUND"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">))</span> <span class="o">{</span>
      <span class="nc">Shrubbery</span> <span class="n">shrub</span> <span class="o">=</span> <span class="nc">Enum</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="nc">Shrubbery</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">s</span><span class="o">);</span>
      <span class="n">print</span><span class="o">(</span><span class="n">shrub</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
GROUND ordinal: 0
-1 false false
class Shrubbery
GROUND
----------------------
CRAWLING ordinal: 1
0 true true
class Shrubbery
CRAWLING
----------------------
HANGING ordinal: 2
1 false false
class Shrubbery
HANGING
----------------------
HANGING
CRAWLING
GROUND
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">ordinal()</code>方法返回一个int值，这是每个<code class="language-plaintext highlighter-rouge">enum</code>实例在声明时的次序，从0开始。</p><p><code class="language-plaintext highlighter-rouge">name()</code>方法按返回<code class="language-plaintext highlighter-rouge">enum</code>实例声明时的名字，这与使用<code class="language-plaintext highlighter-rouge">toString()</code>方法效果相同。</p><p><code class="language-plaintext highlighter-rouge">valueOf()</code>是在<code class="language-plaintext highlighter-rouge">Enum</code>中定义的<code class="language-plaintext highlighter-rouge">static</code>方法，它根据给定的名字返回相应的<code class="language-plaintext highlighter-rouge">enum</code>实例，如果不存在给定名字的实例，将会抛出异常。</p><h3 id="1911-将静态导入用于enum">19.1.1 将静态导入用于enum</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/Spiciness.java</span>
<span class="kn">package</span> <span class="nn">enumerated</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Spiciness</span> <span class="o">{</span>
  <span class="no">NOT</span><span class="o">,</span> <span class="no">MILD</span><span class="o">,</span> <span class="no">MEDIUM</span><span class="o">,</span> <span class="no">HOT</span><span class="o">,</span> <span class="no">FLAMING</span>
<span class="o">}</span> <span class="c1">///:~</span>

<span class="c1">//: enumerated/Burrito.java</span>
<span class="kn">package</span> <span class="nn">enumerated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">enumerated</span><span class="o">.</span><span class="na">Spiciness</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Burrito</span> <span class="o">{</span>
  <span class="nc">Spiciness</span> <span class="n">degree</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">Burrito</span><span class="o">(</span><span class="nc">Spiciness</span> <span class="n">degree</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">degree</span> <span class="o">=</span> <span class="n">degree</span><span class="o">;}</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="s">"Burrito is "</span><span class="o">+</span> <span class="n">degree</span><span class="o">;}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="nc">Burrito</span><span class="o">(</span><span class="no">NOT</span><span class="o">));</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="nc">Burrito</span><span class="o">(</span><span class="no">MEDIUM</span><span class="o">));</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="nc">Burrito</span><span class="o">(</span><span class="no">HOT</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
Burrito is NOT
Burrito is MEDIUM
Burrito is HOT
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h2 id="192-向enum中添加新方法">19.2 向enum中添加新方法</h2><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/OzWitch.java</span>
<span class="c1">// The witches in the land of Oz.</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">OzWitch</span> <span class="o">{</span>
  <span class="c1">// Instances must be defined first, before methods:</span>
  <span class="no">WEST</span><span class="o">(</span><span class="s">"Miss Gulch, aka the Wicked Witch of the West"</span><span class="o">),</span>
  <span class="no">NORTH</span><span class="o">(</span><span class="s">"Glinda, the Good Witch of the North"</span><span class="o">),</span>
  <span class="no">EAST</span><span class="o">(</span><span class="s">"Wicked Witch of the East, wearer of the Ruby "</span> <span class="o">+</span>
    <span class="s">"Slippers, crushed by Dorothy's house"</span><span class="o">),</span>
  <span class="no">SOUTH</span><span class="o">(</span><span class="s">"Good by inference, but missing"</span><span class="o">);</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">description</span><span class="o">;</span>
  <span class="c1">// Constructor must be package or private access:</span>
  <span class="kd">private</span> <span class="nf">OzWitch</span><span class="o">(</span><span class="nc">String</span> <span class="n">description</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getDescription</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">description</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">OzWitch</span> <span class="n">witch</span> <span class="o">:</span> <span class="nc">OzWitch</span><span class="o">.</span><span class="na">values</span><span class="o">())</span>
      <span class="n">print</span><span class="o">(</span><span class="n">witch</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="n">witch</span><span class="o">.</span><span class="na">getDescription</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
WEST: Miss Gulch, aka the Wicked Witch of the West
NORTH: Glinda, the Good Witch of the North
EAST: Wicked Witch of the East, wearer of the Ruby Slippers, crushed by Dorothy's house
SOUTH: Good by inference, but missing
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p>如果你打算定义自己的方法，那么必须在<code class="language-plaintext highlighter-rouge">emum</code>实例序列的最后添加一个分号。同时，<code class="language-plaintext highlighter-rouge">Java</code>要求你必须先定义<code class="language-plaintext highlighter-rouge">enum</code>实例。如果在定义<code class="language-plaintext highlighter-rouge">enum</code>实例之前定义了任何方法或属性，那么在编译时就会得到错误信息。</p><h3 id="21-覆盖enum的方法">2.1 覆盖enum的方法</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/SpaceShip.java</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">SpaceShip</span> <span class="o">{</span>
  <span class="no">SCOUT</span><span class="o">,</span> <span class="no">CARGO</span><span class="o">,</span> <span class="no">TRANSPORT</span><span class="o">,</span> <span class="no">CRUISER</span><span class="o">,</span> <span class="no">BATTLESHIP</span><span class="o">,</span> <span class="no">MOTHERSHIP</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">id</span> <span class="o">=</span> <span class="n">name</span><span class="o">();</span>
    <span class="nc">String</span> <span class="n">lower</span> <span class="o">=</span> <span class="n">id</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">toLowerCase</span><span class="o">();</span>
    <span class="k">return</span> <span class="n">id</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="n">lower</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">SpaceShip</span> <span class="n">s</span> <span class="o">:</span> <span class="n">values</span><span class="o">())</span> <span class="o">{</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
Scout
Cargo
Transport
Cruiser
Battleship
Mothership
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h2 id="3switch语句中的enum">3.Switch语句中的enum</h2><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/TrafficLight.java</span>
<span class="c1">// Enums in switch statements.</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="c1">// Define an enum type:</span>
<span class="kd">enum</span> <span class="nc">Signal</span> <span class="o">{</span> <span class="no">GREEN</span><span class="o">,</span> <span class="no">YELLOW</span><span class="o">,</span> <span class="no">RED</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TrafficLight</span> <span class="o">{</span>
  <span class="nc">Signal</span> <span class="n">color</span> <span class="o">=</span> <span class="nc">Signal</span><span class="o">.</span><span class="na">RED</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">change</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">switch</span><span class="o">(</span><span class="n">color</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Note that you don't have to say Signal.RED</span>
      <span class="c1">// in the case statement:</span>
      <span class="k">case</span> <span class="nl">RED:</span>    <span class="n">color</span> <span class="o">=</span> <span class="nc">Signal</span><span class="o">.</span><span class="na">GREEN</span><span class="o">;</span>
                   <span class="k">break</span><span class="o">;</span>
      <span class="k">case</span> <span class="nl">GREEN:</span>  <span class="n">color</span> <span class="o">=</span> <span class="nc">Signal</span><span class="o">.</span><span class="na">YELLOW</span><span class="o">;</span>
                   <span class="k">break</span><span class="o">;</span>
      <span class="k">case</span> <span class="nl">YELLOW:</span> <span class="n">color</span> <span class="o">=</span> <span class="nc">Signal</span><span class="o">.</span><span class="na">RED</span><span class="o">;</span>
                   <span class="k">break</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"The traffic light is "</span> <span class="o">+</span> <span class="n">color</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">TrafficLight</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TrafficLight</span><span class="o">();</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">print</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
      <span class="n">t</span><span class="o">.</span><span class="na">change</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
The traffic light is RED
The traffic light is GREEN
The traffic light is YELLOW
The traffic light is RED
The traffic light is GREEN
The traffic light is YELLOW
The traffic light is RED
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h2 id="4values的神秘之处">4.values()的神秘之处</h2><p>编译器为你创建的<code class="language-plaintext highlighter-rouge">enum</code>类都继承自<code class="language-plaintext highlighter-rouge">Enum</code>类。然而，如果你研究一下<code class="language-plaintext highlighter-rouge">Enum</code>类就会发现，它并没有<code class="language-plaintext highlighter-rouge">values()</code>方法。我们可以利用反射机制编写一个简单的程序，来查看其中的究竟。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/Reflection.java</span>
<span class="c1">// Analyzing enums using reflection.</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">enum</span> <span class="nc">Explore</span> <span class="o">{</span> <span class="no">HERE</span><span class="o">,</span> <span class="no">THERE</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Reflection</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">analyze</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">enumClass</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">print</span><span class="o">(</span><span class="s">"----- Analyzing "</span> <span class="o">+</span> <span class="n">enumClass</span> <span class="o">+</span> <span class="s">" -----"</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="s">"Interfaces:"</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Type</span> <span class="n">t</span> <span class="o">:</span> <span class="n">enumClass</span><span class="o">.</span><span class="na">getGenericInterfaces</span><span class="o">())</span>
      <span class="n">print</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="s">"Base: "</span> <span class="o">+</span> <span class="n">enumClass</span><span class="o">.</span><span class="na">getSuperclass</span><span class="o">());</span>
    <span class="n">print</span><span class="o">(</span><span class="s">"Methods: "</span><span class="o">);</span>
    <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">methods</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TreeSet</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Method</span> <span class="n">m</span> <span class="o">:</span> <span class="n">enumClass</span><span class="o">.</span><span class="na">getMethods</span><span class="o">())</span>
      <span class="n">methods</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
    <span class="n">print</span><span class="o">(</span><span class="n">methods</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">methods</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">exploreMethods</span> <span class="o">=</span> <span class="n">analyze</span><span class="o">(</span><span class="nc">Explore</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">enumMethods</span> <span class="o">=</span> <span class="n">analyze</span><span class="o">(</span><span class="nc">Enum</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="s">"Explore.containsAll(Enum)? "</span> <span class="o">+</span> <span class="n">exploreMethods</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">enumMethods</span><span class="o">));</span>
    <span class="n">printnb</span><span class="o">(</span><span class="s">"Explore.removeAll(Enum): "</span><span class="o">);</span>
    <span class="n">exploreMethods</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">enumMethods</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">exploreMethods</span><span class="o">);</span>
    <span class="c1">// Decompile the code for the enum:</span>
    <span class="nc">OSExecute</span><span class="o">.</span><span class="na">command</span><span class="o">(</span><span class="s">"javap Explore"</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
----- Analyzing class Explore -----
Interfaces:
Base: class java.lang.Enum
Methods:
[compareTo, equals, getClass, getDeclaringClass, hashCode, name, notify, notifyAll, ordinal, toString, valueOf, values, wait]
----- Analyzing class java.lang.Enum -----
Interfaces:
java.lang.Comparable&lt;E&gt;
interface java.io.Serializable
Base: class java.lang.Object
Methods:
[compareTo, equals, getClass, getDeclaringClass, hashCode, name, notify, notifyAll, ordinal, toString, valueOf, wait]
Explore.containsAll(Enum)? true
Explore.removeAll(Enum): [values]
Compiled from "Reflection.java"
final class Explore extends java.lang.Enum{
    public static final Explore HERE;
    public static final Explore THERE;
    public static final Explore[] values();
    public static Explore valueOf(java.lang.String);
    static {};
}
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">values()</code>由编译器添加的<code class="language-plaintext highlighter-rouge">static</code>方法。可以看出，在创建<code class="language-plaintext highlighter-rouge">Explore</code>的过程中，编译器还为其添加了<code class="language-plaintext highlighter-rouge">valueOf()</code>方法。这可能有点令人迷惑，<code class="language-plaintext highlighter-rouge">Enum</code>类不会已经有<code class="language-plaintext highlighter-rouge">valueOf()</code>方法了吗。不过<code class="language-plaintext highlighter-rouge">Enum</code>中的<code class="language-plaintext highlighter-rouge">valueOf()</code>方法需要两个参数，而这个新增的方法只需一个参数。由于这里使用的<code class="language-plaintext highlighter-rouge">Set</code>只存储方法的名字，而不考虑方法的签名，所以在调用<code class="language-plaintext highlighter-rouge">Explore.removeAll(Enum)</code>之后，就只剩下<code class="language-plaintext highlighter-rouge">[values]</code>了。</p><p>由于<code class="language-plaintext highlighter-rouge">values()</code>方法是由编译器插入到<code class="language-plaintext highlighter-rouge">enum</code>定义中的<code class="language-plaintext highlighter-rouge">static</code>方法，所以，如果你将<code class="language-plaintext highlighter-rouge">enum</code>实例向上转型为<code class="language-plaintext highlighter-rouge">Enum</code>，那么<code class="language-plaintext highlighter-rouge">values()</code>方法就不可访问了。不过，在<code class="language-plaintext highlighter-rouge">Class</code>中有一个<code class="language-plaintext highlighter-rouge">getEnumConstants()</code>方法，所以即便<code class="language-plaintext highlighter-rouge">Enum</code>接口中没有<code class="language-plaintext highlighter-rouge">values()</code>方法，我们仍然可以通过<code class="language-plaintext highlighter-rouge">Class</code>对象取得所有<code class="language-plaintext highlighter-rouge">enum</code>实例：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/UpcastEnum.java</span>
<span class="c1">// No values() method if you upcast an enum</span>

<span class="kd">enum</span> <span class="nc">Search</span> <span class="o">{</span> <span class="no">HITHER</span><span class="o">,</span> <span class="no">YON</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UpcastEnum</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Search</span><span class="o">[]</span> <span class="n">vals</span> <span class="o">=</span> <span class="nc">Search</span><span class="o">.</span><span class="na">values</span><span class="o">();</span>
    <span class="nc">Enum</span> <span class="n">e</span> <span class="o">=</span> <span class="nc">Search</span><span class="o">.</span><span class="na">HITHER</span><span class="o">;</span> <span class="c1">// Upcast</span>
    <span class="c1">// e.values(); // No values() in Enum</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Enum</span> <span class="n">en</span> <span class="o">:</span> <span class="n">e</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getEnumConstants</span><span class="o">())</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">en</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
HITHER
YON
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p>因为<code class="language-plaintext highlighter-rouge">getEnumConstants()</code>是<code class="language-plaintext highlighter-rouge">Class</code>上的方法，所以你甚至可以对不是枚举的类调用此方法：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/NonEnum.java</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NonEnum</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Class</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">intClass</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">for</span><span class="o">(</span><span class="nc">Object</span> <span class="n">en</span> <span class="o">:</span> <span class="n">intClass</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">())</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">en</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
java.lang.NullPointerException
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p>只不过，此时该方法返回<code class="language-plaintext highlighter-rouge">null</code>，所以当你试图使用其返回的结果时会发生异常。</p><h2 id="5实现而非继承">5.实现，而非继承</h2><p>所有的<code class="language-plaintext highlighter-rouge">enum</code>都继承自<code class="language-plaintext highlighter-rouge">java.lang.Enum</code>类。由于<code class="language-plaintext highlighter-rouge">Java</code>不支持多重继承，所以你的<code class="language-plaintext highlighter-rouge">enum</code>不能再继承其他类。然而，在我们创建一个新的<code class="language-plaintext highlighter-rouge">enum</code>时，可以同时实现一个或多个接口：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/cartoons/EnumImplementation.java</span>
<span class="c1">// An enum can implement an interface</span>
<span class="kn">package</span> <span class="nn">enumerated.cartoons</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">enum</span> <span class="nc">CartoonCharacter</span> <span class="kd">implements</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="nc">CartoonCharacter</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="no">SLAPPY</span><span class="o">,</span> <span class="no">SPANKY</span><span class="o">,</span> <span class="no">PUNCHY</span><span class="o">,</span> <span class="no">SILLY</span><span class="o">,</span> <span class="no">BOUNCY</span><span class="o">,</span> <span class="no">NUTTY</span><span class="o">,</span> <span class="no">BOB</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
  <span class="kd">public</span> <span class="nc">CartoonCharacter</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">values</span><span class="o">()[</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">values</span><span class="o">().</span><span class="na">length</span><span class="o">)];</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EnumImplementation</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">printNext</span><span class="o">(</span><span class="nc">Generator</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">rg</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">rg</span><span class="o">.</span><span class="na">next</span><span class="o">()</span> <span class="o">+</span> <span class="s">", "</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Choose any instance:</span>
    <span class="nc">CartoonCharacter</span> <span class="n">cc</span> <span class="o">=</span> <span class="nc">CartoonCharacter</span><span class="o">.</span><span class="na">BOB</span><span class="o">;</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="n">printNext</span><span class="o">(</span><span class="n">cc</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
BOB, PUNCHY, BOB, SPANKY, NUTTY, PUNCHY, SLAPPY, NUTTY, NUTTY, SLAPPY,
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h2 id="6随机选取">6.随机选取</h2><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c1">//: net/mindview/util/Enums.java</span>
<span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Enums</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span> <span class="kd">extends</span> <span class="nc">Enum</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;&gt;</span> <span class="no">T</span> <span class="nf">random</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">ec</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">random</span><span class="o">(</span><span class="n">ec</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">());</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">random</span><span class="o">(</span><span class="no">T</span><span class="o">[]</span> <span class="n">values</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">values</span><span class="o">[</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">values</span><span class="o">.</span><span class="na">length</span><span class="o">)];</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~</span>
</pre></table></code></div></div><p>下面是<code class="language-plaintext highlighter-rouge">random()</code>方法的一个简单示例：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/RandomTest.java</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">enum</span> <span class="nc">Activity</span> <span class="o">{</span> <span class="no">SITTING</span><span class="o">,</span> <span class="no">LYING</span><span class="o">,</span> <span class="no">STANDING</span><span class="o">,</span> <span class="no">HOPPING</span><span class="o">,</span>
  <span class="no">RUNNING</span><span class="o">,</span> <span class="no">DODGING</span><span class="o">,</span> <span class="no">JUMPING</span><span class="o">,</span> <span class="no">FALLING</span><span class="o">,</span> <span class="no">FLYING</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RandomTest</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="nc">Activity</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
STANDING FLYING RUNNING STANDING RUNNING STANDING LYING DODGING SITTING RUNNING HOPPING HOPPING HOPPING RUNNING STANDING LYING FALLING RUNNING FLYING LYING
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h2 id="7使用接口组织枚举">7.使用接口组织枚举</h2><p>假设你想用<code class="language-plaintext highlighter-rouge">enum</code>来表示不同类型的食物，同时还希望每个<code class="language-plaintext highlighter-rouge">enum</code>元素仍然保持<code class="language-plaintext highlighter-rouge">Food</code>类型。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/menu/Food.java</span>
<span class="c1">// Subcategorization of enums within interfaces.</span>
<span class="kn">package</span> <span class="nn">enumerated.menu</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Food</span> <span class="o">{</span>
  <span class="kd">enum</span> <span class="nc">Appetizer</span> <span class="kd">implements</span> <span class="nc">Food</span> <span class="o">{</span>
    <span class="no">SALAD</span><span class="o">,</span> <span class="no">SOUP</span><span class="o">,</span> <span class="no">SPRING_ROLLS</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">enum</span> <span class="nc">MainCourse</span> <span class="kd">implements</span> <span class="nc">Food</span> <span class="o">{</span>
    <span class="no">LASAGNE</span><span class="o">,</span> <span class="no">BURRITO</span><span class="o">,</span> <span class="no">PAD_THAI</span><span class="o">,</span>
    <span class="no">LENTILS</span><span class="o">,</span> <span class="no">HUMMOUS</span><span class="o">,</span> <span class="no">VINDALOO</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">enum</span> <span class="nc">Dessert</span> <span class="kd">implements</span> <span class="nc">Food</span> <span class="o">{</span>
    <span class="no">TIRAMISU</span><span class="o">,</span> <span class="no">GELATO</span><span class="o">,</span> <span class="no">BLACK_FOREST_CAKE</span><span class="o">,</span>
    <span class="no">FRUIT</span><span class="o">,</span> <span class="no">CREME_CARAMEL</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">enum</span> <span class="nc">Coffee</span> <span class="kd">implements</span> <span class="nc">Food</span> <span class="o">{</span>
    <span class="no">BLACK_COFFEE</span><span class="o">,</span> <span class="no">DECAF_COFFEE</span><span class="o">,</span> <span class="no">ESPRESSO</span><span class="o">,</span>
    <span class="no">LATTE</span><span class="o">,</span> <span class="no">CAPPUCCINO</span><span class="o">,</span> <span class="no">TEA</span><span class="o">,</span> <span class="no">HERB_TEA</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~</span>
</pre></table></code></div></div><p>对于<code class="language-plaintext highlighter-rouge">enum</code>而言，实现接口是使其自泪花的唯一办法，所以嵌入在<code class="language-plaintext highlighter-rouge">Food</code>中的每个<code class="language-plaintext highlighter-rouge">enum</code>都实现了<code class="language-plaintext highlighter-rouge">Food</code>接口。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/menu/TypeOfFood.java</span>
<span class="kn">package</span> <span class="nn">enumerated.menu</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">enumerated</span><span class="o">.</span><span class="na">menu</span><span class="o">.</span><span class="na">Food</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TypeOfFood</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Food</span> <span class="n">food</span> <span class="o">=</span> <span class="nc">Appetizer</span><span class="o">.</span><span class="na">SALAD</span><span class="o">;</span>
    <span class="n">food</span> <span class="o">=</span> <span class="nc">MainCourse</span><span class="o">.</span><span class="na">LASAGNE</span><span class="o">;</span>
    <span class="n">food</span> <span class="o">=</span> <span class="nc">Dessert</span><span class="o">.</span><span class="na">GELATO</span><span class="o">;</span>
    <span class="n">food</span> <span class="o">=</span> <span class="nc">Coffee</span><span class="o">.</span><span class="na">CAPPUCCINO</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~</span>
</pre></table></code></div></div><p>如果你想创建一个“枚举的枚举”，那么可以创建一个新的<code class="language-plaintext highlighter-rouge">enum</code>，然后用其实例包装<code class="language-plaintext highlighter-rouge">Food</code>中的每一个<code class="language-plaintext highlighter-rouge">enum</code>类：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/menu/Course.java</span>
<span class="kn">package</span> <span class="nn">enumerated.menu</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Course</span> <span class="o">{</span>
  <span class="no">APPETIZER</span><span class="o">(</span><span class="nc">Food</span><span class="o">.</span><span class="na">Appetizer</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
  <span class="no">MAINCOURSE</span><span class="o">(</span><span class="nc">Food</span><span class="o">.</span><span class="na">MainCourse</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
  <span class="no">DESSERT</span><span class="o">(</span><span class="nc">Food</span><span class="o">.</span><span class="na">Dessert</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
  <span class="no">COFFEE</span><span class="o">(</span><span class="nc">Food</span><span class="o">.</span><span class="na">Coffee</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="kd">private</span> <span class="nc">Food</span><span class="o">[]</span> <span class="n">values</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nf">Course</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Food</span><span class="o">&gt;</span> <span class="n">kind</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">kind</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">Food</span> <span class="nf">randomSelection</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="n">values</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~</span>
</pre></table></code></div></div><p>通过每一个<code class="language-plaintext highlighter-rouge">Course</code>实例中随机地选择一个<code class="language-plaintext highlighter-rouge">Food</code>，我们便能够生成一份菜单：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/menu/Meal.java</span>
<span class="kn">package</span> <span class="nn">enumerated.menu</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Meal</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="k">for</span><span class="o">(</span><span class="nc">Course</span> <span class="n">course</span> <span class="o">:</span> <span class="nc">Course</span><span class="o">.</span><span class="na">values</span><span class="o">())</span> <span class="o">{</span>
        <span class="nc">Food</span> <span class="n">food</span> <span class="o">=</span> <span class="n">course</span><span class="o">.</span><span class="na">randomSelection</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">food</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"---"</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
SPRING_ROLLS
VINDALOO
FRUIT
DECAF_COFFEE
---
SOUP
VINDALOO
FRUIT
TEA
---
SALAD
BURRITO
FRUIT
TEA
---
SALAD
BURRITO
CREME_CARAMEL
LATTE
---
SOUP
BURRITO
TIRAMISU
ESPRESSO
---
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p>还有一种更简洁的管理枚举的办法，就是将一个<code class="language-plaintext highlighter-rouge">enum</code>嵌套在另一个<code class="language-plaintext highlighter-rouge">enum</code>内。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/SecurityCategory.java</span>
<span class="c1">// More succinct subcategorization of enums.</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">enum</span> <span class="nc">SecurityCategory</span> <span class="o">{</span>
  <span class="no">STOCK</span><span class="o">(</span><span class="nc">Security</span><span class="o">.</span><span class="na">Stock</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="no">BOND</span><span class="o">(</span><span class="nc">Security</span><span class="o">.</span><span class="na">Bond</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="nc">Security</span><span class="o">[]</span> <span class="n">values</span><span class="o">;</span>
  <span class="nc">SecurityCategory</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Security</span><span class="o">&gt;</span> <span class="n">kind</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">kind</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">interface</span> <span class="nc">Security</span> <span class="o">{</span>
    <span class="kd">enum</span> <span class="nc">Stock</span> <span class="kd">implements</span> <span class="nc">Security</span> <span class="o">{</span> <span class="no">SHORT</span><span class="o">,</span> <span class="no">LONG</span><span class="o">,</span> <span class="no">MARGIN</span> <span class="o">}</span>
    <span class="kd">enum</span> <span class="nc">Bond</span> <span class="kd">implements</span> <span class="nc">Security</span> <span class="o">{</span> <span class="no">MUNICIPAL</span><span class="o">,</span> <span class="no">JUNK</span> <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">Security</span> <span class="nf">randomSelection</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="n">values</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="nc">SecurityCategory</span> <span class="n">category</span> <span class="o">=</span>
        <span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="nc">SecurityCategory</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">category</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span>
        <span class="n">category</span><span class="o">.</span><span class="na">randomSelection</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
BOND: MUNICIPAL
BOND: MUNICIPAL
STOCK: MARGIN
STOCK: MARGIN
BOND: JUNK
STOCK: SHORT
STOCK: LONG
STOCK: LONG
BOND: MUNICIPAL
BOND: JUNK
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p>如果我们将这种方式应用于<code class="language-plaintext highlighter-rouge">Food</code>的例子，结果应该这样：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/menu/Meal2.java</span>
<span class="kn">package</span> <span class="nn">enumerated.menu</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Meal2</span> <span class="o">{</span>
  <span class="no">APPETIZER</span><span class="o">(</span><span class="nc">Food</span><span class="o">.</span><span class="na">Appetizer</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
  <span class="no">MAINCOURSE</span><span class="o">(</span><span class="nc">Food</span><span class="o">.</span><span class="na">MainCourse</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
  <span class="no">DESSERT</span><span class="o">(</span><span class="nc">Food</span><span class="o">.</span><span class="na">Dessert</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
  <span class="no">COFFEE</span><span class="o">(</span><span class="nc">Food</span><span class="o">.</span><span class="na">Coffee</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="kd">private</span> <span class="nc">Food</span><span class="o">[]</span> <span class="n">values</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nf">Meal2</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Food</span><span class="o">&gt;</span> <span class="n">kind</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">kind</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Food</span> <span class="o">{</span>
    <span class="kd">enum</span> <span class="nc">Appetizer</span> <span class="kd">implements</span> <span class="nc">Food</span> <span class="o">{</span>
      <span class="no">SALAD</span><span class="o">,</span> <span class="no">SOUP</span><span class="o">,</span> <span class="no">SPRING_ROLLS</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">enum</span> <span class="nc">MainCourse</span> <span class="kd">implements</span> <span class="nc">Food</span> <span class="o">{</span>
      <span class="no">LASAGNE</span><span class="o">,</span> <span class="no">BURRITO</span><span class="o">,</span> <span class="no">PAD_THAI</span><span class="o">,</span>
      <span class="no">LENTILS</span><span class="o">,</span> <span class="no">HUMMOUS</span><span class="o">,</span> <span class="no">VINDALOO</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">enum</span> <span class="nc">Dessert</span> <span class="kd">implements</span> <span class="nc">Food</span> <span class="o">{</span>
      <span class="no">TIRAMISU</span><span class="o">,</span> <span class="no">GELATO</span><span class="o">,</span> <span class="no">BLACK_FOREST_CAKE</span><span class="o">,</span>
      <span class="no">FRUIT</span><span class="o">,</span> <span class="no">CREME_CARAMEL</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">enum</span> <span class="nc">Coffee</span> <span class="kd">implements</span> <span class="nc">Food</span> <span class="o">{</span>
      <span class="no">BLACK_COFFEE</span><span class="o">,</span> <span class="no">DECAF_COFFEE</span><span class="o">,</span> <span class="no">ESPRESSO</span><span class="o">,</span>
      <span class="no">LATTE</span><span class="o">,</span> <span class="no">CAPPUCCINO</span><span class="o">,</span> <span class="no">TEA</span><span class="o">,</span> <span class="no">HERB_TEA</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">Food</span> <span class="nf">randomSelection</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="n">values</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="k">for</span><span class="o">(</span><span class="nc">Meal2</span> <span class="n">meal</span> <span class="o">:</span> <span class="nc">Meal2</span><span class="o">.</span><span class="na">values</span><span class="o">())</span> <span class="o">{</span>
        <span class="nc">Food</span> <span class="n">food</span> <span class="o">=</span> <span class="n">meal</span><span class="o">.</span><span class="na">randomSelection</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">food</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"---"</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Same output as Meal.java */</span><span class="c1">//:~</span>
</pre></table></code></div></div><h2 id="8使用enumset替代标志">8.使用EnumSet替代标志</h2><p><code class="language-plaintext highlighter-rouge">Java SE5</code>引入<code class="language-plaintext highlighter-rouge">EnumSet</code>，是为了通过<code class="language-plaintext highlighter-rouge">enum</code>创建一种替代品，以替代传统的基于<code class="language-plaintext highlighter-rouge">int</code>的“位标志”。这种标志可以用来表示某种“开/关”信息。</p><p><code class="language-plaintext highlighter-rouge">EnumSet</code>的设计充分考虑到了速度因素，因为它必须与非常高效的<code class="language-plaintext highlighter-rouge">bit</code>标志相竞争。就其内部而言，它就是将一个long值作为比特向量，所以<code class="language-plaintext highlighter-rouge">EnumSet</code>非常快速高效。使用<code class="language-plaintext highlighter-rouge">EnumSet</code>的优点是，它在说明一个二进制位是否存在时，具有更好的表达能力，并且无须担心性能。</p><p>下面的<code class="language-plaintext highlighter-rouge">enum</code>表示在一座大楼中，警报传感器的安放位置：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/AlarmPoints.java</span>
<span class="kn">package</span> <span class="nn">enumerated</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">AlarmPoints</span> <span class="o">{</span>
  <span class="no">STAIR1</span><span class="o">,</span> <span class="no">STAIR2</span><span class="o">,</span> <span class="no">LOBBY</span><span class="o">,</span> <span class="no">OFFICE1</span><span class="o">,</span> <span class="no">OFFICE2</span><span class="o">,</span> <span class="no">OFFICE3</span><span class="o">,</span>
  <span class="no">OFFICE4</span><span class="o">,</span> <span class="no">BATHROOM</span><span class="o">,</span> <span class="no">UTILITY</span><span class="o">,</span> <span class="no">KITCHEN</span>
<span class="o">}</span> <span class="c1">///:~</span>
</pre></table></code></div></div><p>然后，我们用<code class="language-plaintext highlighter-rouge">EnumSet</code>来跟踪报警器的状态：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/EnumSets.java</span>
<span class="c1">// Operations on EnumSets</span>
<span class="kn">package</span> <span class="nn">enumerated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">enumerated</span><span class="o">.</span><span class="na">AlarmPoints</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EnumSets</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">EnumSet</span><span class="o">&lt;</span><span class="nc">AlarmPoints</span><span class="o">&gt;</span> <span class="n">points</span> <span class="o">=</span>
      <span class="nc">EnumSet</span><span class="o">.</span><span class="na">noneOf</span><span class="o">(</span><span class="nc">AlarmPoints</span><span class="o">.</span><span class="na">class</span><span class="o">);</span> <span class="c1">// Empty set</span>
    <span class="n">points</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="no">BATHROOM</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">points</span><span class="o">);</span>
    <span class="n">points</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="nc">EnumSet</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="no">STAIR1</span><span class="o">,</span> <span class="no">STAIR2</span><span class="o">,</span> <span class="no">KITCHEN</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">points</span><span class="o">);</span>
    <span class="n">points</span> <span class="o">=</span> <span class="nc">EnumSet</span><span class="o">.</span><span class="na">allOf</span><span class="o">(</span><span class="nc">AlarmPoints</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">points</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="nc">EnumSet</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="no">STAIR1</span><span class="o">,</span> <span class="no">STAIR2</span><span class="o">,</span> <span class="no">KITCHEN</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">points</span><span class="o">);</span>
    <span class="n">points</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="nc">EnumSet</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="no">OFFICE1</span><span class="o">,</span> <span class="no">OFFICE4</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">points</span><span class="o">);</span>
    <span class="n">points</span> <span class="o">=</span> <span class="nc">EnumSet</span><span class="o">.</span><span class="na">complementOf</span><span class="o">(</span><span class="n">points</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">points</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
[BATHROOM]
[STAIR1, STAIR2, BATHROOM, KITCHEN]
[LOBBY, OFFICE1, OFFICE2, OFFICE3, OFFICE4, BATHROOM, UTILITY]
[LOBBY, BATHROOM, UTILITY]
[STAIR1, STAIR2, OFFICE1, OFFICE2, OFFICE3, OFFICE4, KITCHEN]
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">EnumSet</code>的基础是<code class="language-plaintext highlighter-rouge">long</code>，一个<code class="language-plaintext highlighter-rouge">long</code>值有64位，而一个<code class="language-plaintext highlighter-rouge">enum</code>实例只需一位<code class="language-plaintext highlighter-rouge">bit</code>表示其是否存在。也就是说，在不超过一个<code class="language-plaintext highlighter-rouge">long</code>的表达能力的情况下，你的<code class="language-plaintext highlighter-rouge">EnumSet</code>可以应用于最多不超过64个元素的<code class="language-plaintext highlighter-rouge">enum</code>。如果<code class="language-plaintext highlighter-rouge">enum</code>超过了64个元素会发生什么呢？</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>//: enumerated/BigEnumSet.java
import java.util.*;

public class BigEnumSet {
  enum Big { A0, A1, A2, A3, A4, A5, A6, A7, A8, A9, A10,
    A11, A12, A13, A14, A15, A16, A17, A18, A19, A20, A21,
    A22, A23, A24, A25, A26, A27, A28, A29, A30, A31, A32,
    A33, A34, A35, A36, A37, A38, A39, A40, A41, A42, A43,
    A44, A45, A46, A47, A48, A49, A50, A51, A52, A53, A54,
    A55, A56, A57, A58, A59, A60, A61, A62, A63, A64, A65,
    A66, A67, A68, A69, A70, A71, A72, A73, A74, A75 }
  public static void main(String[] args) {
    EnumSet&lt;Big&gt; bigEnumSet = EnumSet.allOf(Big.class);
    System.out.println(bigEnumSet);
  }
} /* Output:
[A0, A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19, A20, A21, A22, A23, A24, A25, A26, A27, A28, A29, A30, A31, A32, A33, A34, A35, A36, A37, A38, A39, A40, A41, A42, A43, A44, A45, A46, A47, A48, A49, A50, A51, A52, A53, A54, A55, A56, A57, A58, A59, A60, A61, A62, A63, A64, A65, A66, A67, A68, A69, A70, A71, A72, A73, A74, A75]
*///:~
</pre></table></code></div></div><p>显然，<code class="language-plaintext highlighter-rouge">EnumSet</code>可以应用于多过64个元素的<code class="language-plaintext highlighter-rouge">enum</code>，所以我猜测，<code class="language-plaintext highlighter-rouge">Enum</code>会在必要的时候增加一个<code class="language-plaintext highlighter-rouge">long</code>。</p><h2 id="9使用enummap">9.使用EnumMap</h2><p><code class="language-plaintext highlighter-rouge">EnumMap</code>是一种特殊的<code class="language-plaintext highlighter-rouge">Map</code>，它要求其中的键必须来自一个<code class="language-plaintext highlighter-rouge">enum</code>。由于enum本身的限制，所以<code class="language-plaintext highlighter-rouge">EnumMap</code>在内部可由数组实现。因此<code class="language-plaintext highlighter-rouge">EnumMap</code>的速度很快，我们可以放心地使用<code class="language-plaintext highlighter-rouge">enum</code>实例在<code class="language-plaintext highlighter-rouge">EnumMap</code>中进行查找操作。不过，我们只能将<code class="language-plaintext highlighter-rouge">enum</code>的实例作为键来调用<code class="language-plaintext highlighter-rouge">put()</code>方法，其他操作与使用一般的<code class="language-plaintext highlighter-rouge">Map</code>差不多。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/EnumMaps.java</span>
<span class="c1">// Basics of EnumMaps.</span>
<span class="kn">package</span> <span class="nn">enumerated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">enumerated</span><span class="o">.</span><span class="na">AlarmPoints</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">interface</span> <span class="nc">Command</span> <span class="o">{</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">();</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EnumMaps</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">EnumMap</span><span class="o">&lt;</span><span class="nc">AlarmPoints</span><span class="o">,</span><span class="nc">Command</span><span class="o">&gt;</span> <span class="n">em</span> <span class="o">=</span>
      <span class="k">new</span> <span class="nc">EnumMap</span><span class="o">&lt;</span><span class="nc">AlarmPoints</span><span class="o">,</span><span class="nc">Command</span><span class="o">&gt;(</span><span class="nc">AlarmPoints</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">em</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">KITCHEN</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Command</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Kitchen fire!"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">});</span>
    <span class="n">em</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="no">BATHROOM</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Command</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Bathroom alert!"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">});</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">AlarmPoints</span><span class="o">,</span><span class="nc">Command</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">:</span> <span class="n">em</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">printnb</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getKey</span><span class="o">()</span> <span class="o">+</span> <span class="s">": "</span><span class="o">);</span>
      <span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">action</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span> <span class="c1">// If there's no value for a particular key:</span>
      <span class="n">em</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="no">UTILITY</span><span class="o">).</span><span class="na">action</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">print</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
BATHROOM: Bathroom alert!
KITCHEN: Kitchen fire!
java.lang.NullPointerException
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p>与<code class="language-plaintext highlighter-rouge">EnumSet</code>一样，<code class="language-plaintext highlighter-rouge">enum</code>实例定义时的次序决定了其在<code class="language-plaintext highlighter-rouge">EnumMap</code>中声明时的顺序。</p><h2 id="10常量相关的方法">10.常量相关的方法</h2><p><code class="language-plaintext highlighter-rouge">Java</code>的<code class="language-plaintext highlighter-rouge">enum</code>有一个非常有趣的特性，即它允许程序员为<code class="language-plaintext highlighter-rouge">enum</code>实例编写方法，从而为每个<code class="language-plaintext highlighter-rouge">enum</code>实例赋予各自不同的行为。要实现常量相关的方法，你需要为<code class="language-plaintext highlighter-rouge">enum</code>定义一个或多个<code class="language-plaintext highlighter-rouge">abstract</code>方法，然后为每个<code class="language-plaintext highlighter-rouge">enum</code>实例实现该抽象方法。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/ConstantSpecificMethod.java</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.text.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">ConstantSpecificMethod</span> <span class="o">{</span>
  <span class="no">DATE_TIME</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">getInfo</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span>
        <span class="nc">DateFormat</span><span class="o">.</span><span class="na">getDateInstance</span><span class="o">().</span><span class="na">format</span><span class="o">(</span><span class="k">new</span> <span class="nc">Date</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">},</span>
  <span class="no">CLASSPATH</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">getInfo</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="nc">System</span><span class="o">.</span><span class="na">getenv</span><span class="o">(</span><span class="s">"CLASSPATH"</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">},</span>
  <span class="no">VERSION</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">getInfo</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"java.version"</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">};</span>
  <span class="kd">abstract</span> <span class="nc">String</span> <span class="nf">getInfo</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">ConstantSpecificMethod</span> <span class="n">csm</span> <span class="o">:</span> <span class="n">values</span><span class="o">())</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">csm</span><span class="o">.</span><span class="na">getInfo</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* (Execute to see output) */</span><span class="c1">//:~</span>
</pre></table></code></div></div><p>并不能真的将<code class="language-plaintext highlighter-rouge">enum</code>实例作为一个类型来使用：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/NotClasses.java</span>
<span class="c1">// {Exec: javap -c LikeClasses}</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">enum</span> <span class="nc">LikeClasses</span> <span class="o">{</span>
  <span class="no">WINKEN</span> <span class="o">{</span> <span class="kt">void</span> <span class="nf">behavior</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Behavior1"</span><span class="o">);</span> <span class="o">}</span> <span class="o">},</span>
  <span class="no">BLINKEN</span> <span class="o">{</span> <span class="kt">void</span> <span class="nf">behavior</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Behavior2"</span><span class="o">);</span> <span class="o">}</span> <span class="o">},</span>
  <span class="no">NOD</span> <span class="o">{</span> <span class="kt">void</span> <span class="nf">behavior</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Behavior3"</span><span class="o">);</span> <span class="o">}</span> <span class="o">};</span>
  <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">behavior</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NotClasses</span> <span class="o">{</span>
  <span class="c1">// void f1(LikeClasses.WINKEN instance) {} // Nope</span>
<span class="o">}</span> <span class="cm">/* Output:
Compiled from "NotClasses.java"
abstract class LikeClasses extends java.lang.Enum{
public static final LikeClasses WINKEN;
public static final LikeClasses BLINKEN;
public static final LikeClasses NOD;
...
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/CarWash.java</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CarWash</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Cycle</span> <span class="o">{</span>
    <span class="no">UNDERBODY</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Spraying the underbody"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">WHEELWASH</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Washing the wheels"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">PREWASH</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Loosening the dirt"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">BASIC</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"The basic wash"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">HOTWAX</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Applying hot wax"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">RINSE</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Rinsing"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">BLOWDRY</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Blowing dry"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">};</span>
    <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="nc">EnumSet</span><span class="o">&lt;</span><span class="nc">Cycle</span><span class="o">&gt;</span> <span class="n">cycles</span> <span class="o">=</span>
    <span class="nc">EnumSet</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="nc">Cycle</span><span class="o">.</span><span class="na">BASIC</span><span class="o">,</span> <span class="nc">Cycle</span><span class="o">.</span><span class="na">RINSE</span><span class="o">);</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">Cycle</span> <span class="n">cycle</span><span class="o">)</span> <span class="o">{</span> <span class="n">cycles</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">cycle</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">washCar</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Cycle</span> <span class="n">c</span> <span class="o">:</span> <span class="n">cycles</span><span class="o">)</span>
      <span class="n">c</span><span class="o">.</span><span class="na">action</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">cycles</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">CarWash</span> <span class="n">wash</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CarWash</span><span class="o">();</span>
    <span class="n">print</span><span class="o">(</span><span class="n">wash</span><span class="o">);</span>
    <span class="n">wash</span><span class="o">.</span><span class="na">washCar</span><span class="o">();</span>
    <span class="c1">// Order of addition is unimportant:</span>
    <span class="n">wash</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Cycle</span><span class="o">.</span><span class="na">BLOWDRY</span><span class="o">);</span>
    <span class="n">wash</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Cycle</span><span class="o">.</span><span class="na">BLOWDRY</span><span class="o">);</span> <span class="c1">// Duplicates ignored</span>
    <span class="n">wash</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Cycle</span><span class="o">.</span><span class="na">RINSE</span><span class="o">);</span>
    <span class="n">wash</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Cycle</span><span class="o">.</span><span class="na">HOTWAX</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">wash</span><span class="o">);</span>
    <span class="n">wash</span><span class="o">.</span><span class="na">washCar</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
[BASIC, RINSE]
The basic wash
Rinsing
[BASIC, HOTWAX, RINSE, BLOWDRY]
The basic wash
Applying hot wax
Rinsing
Blowing dry
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p>与使用匿名内部类相比较，定义常量相关方法的语法更高效、简洁。</p><p>除了实现<code class="language-plaintext highlighter-rouge">abstarct</code>方法以外，程序员是否可以覆盖常量相关的方法呢？答案是肯定的。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/OverrideConstantSpecific.java</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">OverrideConstantSpecific</span> <span class="o">{</span>
  <span class="no">NUT</span><span class="o">,</span> <span class="no">BOLT</span><span class="o">,</span>
  <span class="no">WASHER</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Overridden method"</span><span class="o">);</span> <span class="o">}</span>
  <span class="o">};</span>
  <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"default behavior"</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">OverrideConstantSpecific</span> <span class="n">ocs</span> <span class="o">:</span> <span class="n">values</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">printnb</span><span class="o">(</span><span class="n">ocs</span> <span class="o">+</span> <span class="s">": "</span><span class="o">);</span>
      <span class="n">ocs</span><span class="o">.</span><span class="na">f</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
NUT: default behavior
BOLT: default behavior
WASHER: Overridden method
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h3 id="101使用enum的职责链">10.1使用enum的职责链</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/PostOffice.java</span>
<span class="c1">// Modeling a post office.</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">class</span> <span class="nc">Mail</span> <span class="o">{</span>
  <span class="c1">// The NO's lower the probability of random selection:</span>
  <span class="kd">enum</span> <span class="nc">GeneralDelivery</span> <span class="o">{</span><span class="no">YES</span><span class="o">,</span><span class="no">NO1</span><span class="o">,</span><span class="no">NO2</span><span class="o">,</span><span class="no">NO3</span><span class="o">,</span><span class="no">NO4</span><span class="o">,</span><span class="no">NO5</span><span class="o">}</span>
  <span class="kd">enum</span> <span class="nc">Scannability</span> <span class="o">{</span><span class="no">UNSCANNABLE</span><span class="o">,</span><span class="no">YES1</span><span class="o">,</span><span class="no">YES2</span><span class="o">,</span><span class="no">YES3</span><span class="o">,</span><span class="no">YES4</span><span class="o">}</span>
  <span class="kd">enum</span> <span class="nc">Readability</span> <span class="o">{</span><span class="no">ILLEGIBLE</span><span class="o">,</span><span class="no">YES1</span><span class="o">,</span><span class="no">YES2</span><span class="o">,</span><span class="no">YES3</span><span class="o">,</span><span class="no">YES4</span><span class="o">}</span>
  <span class="kd">enum</span> <span class="nc">Address</span> <span class="o">{</span><span class="no">INCORRECT</span><span class="o">,</span><span class="no">OK1</span><span class="o">,</span><span class="no">OK2</span><span class="o">,</span><span class="no">OK3</span><span class="o">,</span><span class="no">OK4</span><span class="o">,</span><span class="no">OK5</span><span class="o">,</span><span class="no">OK6</span><span class="o">}</span>
  <span class="kd">enum</span> <span class="nc">ReturnAddress</span> <span class="o">{</span><span class="no">MISSING</span><span class="o">,</span><span class="no">OK1</span><span class="o">,</span><span class="no">OK2</span><span class="o">,</span><span class="no">OK3</span><span class="o">,</span><span class="no">OK4</span><span class="o">,</span><span class="no">OK5</span><span class="o">}</span>
  <span class="nc">GeneralDelivery</span> <span class="n">generalDelivery</span><span class="o">;</span>
  <span class="nc">Scannability</span> <span class="n">scannability</span><span class="o">;</span>
  <span class="nc">Readability</span> <span class="n">readability</span><span class="o">;</span>
  <span class="nc">Address</span> <span class="n">address</span><span class="o">;</span>
  <span class="nc">ReturnAddress</span> <span class="n">returnAddress</span><span class="o">;</span>
  <span class="kd">static</span> <span class="kt">long</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
  <span class="kt">long</span> <span class="n">id</span> <span class="o">=</span> <span class="n">counter</span><span class="o">++;</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="s">"Mail "</span> <span class="o">+</span> <span class="n">id</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">details</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">+</span>
      <span class="s">", General Delivery: "</span> <span class="o">+</span> <span class="n">generalDelivery</span> <span class="o">+</span>
      <span class="s">", Address Scanability: "</span> <span class="o">+</span> <span class="n">scannability</span> <span class="o">+</span>
      <span class="s">", Address Readability: "</span> <span class="o">+</span> <span class="n">readability</span> <span class="o">+</span>
      <span class="s">", Address Address: "</span> <span class="o">+</span> <span class="n">address</span> <span class="o">+</span>
      <span class="s">", Return address: "</span> <span class="o">+</span> <span class="n">returnAddress</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="c1">// Generate test Mail:</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Mail</span> <span class="nf">randomMail</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">Mail</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Mail</span><span class="o">();</span>
    <span class="n">m</span><span class="o">.</span><span class="na">generalDelivery</span><span class="o">=</span> <span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="nc">GeneralDelivery</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">m</span><span class="o">.</span><span class="na">scannability</span> <span class="o">=</span> <span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="nc">Scannability</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">m</span><span class="o">.</span><span class="na">readability</span> <span class="o">=</span> <span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="nc">Readability</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">m</span><span class="o">.</span><span class="na">address</span> <span class="o">=</span> <span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="nc">Address</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">m</span><span class="o">.</span><span class="na">returnAddress</span> <span class="o">=</span> <span class="nc">Enums</span><span class="o">.</span><span class="na">random</span><span class="o">(</span><span class="nc">ReturnAddress</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">m</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Mail</span><span class="o">&gt;</span> <span class="nf">generator</span><span class="o">(</span><span class="kd">final</span> <span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Mail</span><span class="o">&gt;()</span> <span class="o">{</span>
      <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">count</span><span class="o">;</span>
      <span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Mail</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Mail</span><span class="o">&gt;()</span> <span class="o">{</span>
          <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">n</span><span class="o">--</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">;</span> <span class="o">}</span>
          <span class="kd">public</span> <span class="nc">Mail</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">randomMail</span><span class="o">();</span> <span class="o">}</span>
          <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// Not implemented</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
          <span class="o">}</span>
        <span class="o">};</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PostOffice</span> <span class="o">{</span>
  <span class="kd">enum</span> <span class="nc">MailHandler</span> <span class="o">{</span>
    <span class="no">GENERAL_DELIVERY</span> <span class="o">{</span>
      <span class="kt">boolean</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">Mail</span> <span class="n">m</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">generalDelivery</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nl">YES:</span>
            <span class="n">print</span><span class="o">(</span><span class="s">"Using general delivery for "</span> <span class="o">+</span> <span class="n">m</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
          <span class="k">default</span><span class="o">:</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">MACHINE_SCAN</span> <span class="o">{</span>
      <span class="kt">boolean</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">Mail</span> <span class="n">m</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">scannability</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nl">UNSCANNABLE:</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
          <span class="k">default</span><span class="o">:</span>
            <span class="k">switch</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">address</span><span class="o">)</span> <span class="o">{</span>
              <span class="k">case</span> <span class="nl">INCORRECT:</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
              <span class="k">default</span><span class="o">:</span>
                <span class="n">print</span><span class="o">(</span><span class="s">"Delivering "</span><span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="s">" automatically"</span><span class="o">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">VISUAL_INSPECTION</span> <span class="o">{</span>
      <span class="kt">boolean</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">Mail</span> <span class="n">m</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">readability</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nl">ILLEGIBLE:</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
          <span class="k">default</span><span class="o">:</span>
            <span class="k">switch</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">address</span><span class="o">)</span> <span class="o">{</span>
              <span class="k">case</span> <span class="nl">INCORRECT:</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
              <span class="k">default</span><span class="o">:</span>
                <span class="n">print</span><span class="o">(</span><span class="s">"Delivering "</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="s">" normally"</span><span class="o">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">RETURN_TO_SENDER</span> <span class="o">{</span>
      <span class="kt">boolean</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">Mail</span> <span class="n">m</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">returnAddress</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nl">MISSING:</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
          <span class="k">default</span><span class="o">:</span>
            <span class="n">print</span><span class="o">(</span><span class="s">"Returning "</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="s">" to sender"</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">};</span>
    <span class="kd">abstract</span> <span class="kt">boolean</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">Mail</span> <span class="n">m</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">static</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">Mail</span> <span class="n">m</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">MailHandler</span> <span class="n">handler</span> <span class="o">:</span> <span class="nc">MailHandler</span><span class="o">.</span><span class="na">values</span><span class="o">())</span>
      <span class="k">if</span><span class="o">(</span><span class="n">handler</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">m</span><span class="o">))</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="n">print</span><span class="o">(</span><span class="n">m</span> <span class="o">+</span> <span class="s">" is a dead letter"</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Mail</span> <span class="n">mail</span> <span class="o">:</span> <span class="nc">Mail</span><span class="o">.</span><span class="na">generator</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">print</span><span class="o">(</span><span class="n">mail</span><span class="o">.</span><span class="na">details</span><span class="o">());</span>
      <span class="n">handle</span><span class="o">(</span><span class="n">mail</span><span class="o">);</span>
      <span class="n">print</span><span class="o">(</span><span class="s">"*****"</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
Mail 0, General Delivery: NO2, Address Scanability: UNSCANNABLE, Address Readability: YES3, Address Address: OK1, Return address: OK1
Delivering Mail 0 normally
*****
Mail 1, General Delivery: NO5, Address Scanability: YES3, Address Readability: ILLEGIBLE, Address Address: OK5, Return address: OK1
Delivering Mail 1 automatically
*****
Mail 2, General Delivery: YES, Address Scanability: YES3, Address Readability: YES1, Address Address: OK1, Return address: OK5
Using general delivery for Mail 2
*****
Mail 3, General Delivery: NO4, Address Scanability: YES3, Address Readability: YES1, Address Address: INCORRECT, Return address: OK4
Returning Mail 3 to sender
*****
Mail 4, General Delivery: NO4, Address Scanability: UNSCANNABLE, Address Readability: YES1, Address Address: INCORRECT, Return address: OK2
Returning Mail 4 to sender
*****
Mail 5, General Delivery: NO3, Address Scanability: YES1, Address Readability: ILLEGIBLE, Address Address: OK4, Return address: OK2
Delivering Mail 5 automatically
*****
Mail 6, General Delivery: YES, Address Scanability: YES4, Address Readability: ILLEGIBLE, Address Address: OK4, Return address: OK4
Using general delivery for Mail 6
*****
Mail 7, General Delivery: YES, Address Scanability: YES3, Address Readability: YES4, Address Address: OK2, Return address: MISSING
Using general delivery for Mail 7
*****
Mail 8, General Delivery: NO3, Address Scanability: YES1, Address Readability: YES3, Address Address: INCORRECT, Return address: MISSING
Mail 8 is a dead letter
*****
Mail 9, General Delivery: NO1, Address Scanability: UNSCANNABLE, Address Readability: YES2, Address Address: OK1, Return address: OK4
Delivering Mail 9 normally
*****
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h3 id="102-使用enum的状态机">10.2 使用enum的状态机</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/Input.java</span>
<span class="kn">package</span> <span class="nn">enumerated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Input</span> <span class="o">{</span>
  <span class="no">NICKEL</span><span class="o">(</span><span class="mi">5</span><span class="o">),</span> <span class="no">DIME</span><span class="o">(</span><span class="mi">10</span><span class="o">),</span> <span class="no">QUARTER</span><span class="o">(</span><span class="mi">25</span><span class="o">),</span> <span class="no">DOLLAR</span><span class="o">(</span><span class="mi">100</span><span class="o">),</span>
  <span class="no">TOOTHPASTE</span><span class="o">(</span><span class="mi">200</span><span class="o">),</span> <span class="no">CHIPS</span><span class="o">(</span><span class="mi">75</span><span class="o">),</span> <span class="no">SODA</span><span class="o">(</span><span class="mi">100</span><span class="o">),</span> <span class="no">SOAP</span><span class="o">(</span><span class="mi">50</span><span class="o">),</span>
  <span class="no">ABORT_TRANSACTION</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">amount</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// Disallow</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"ABORT.amount()"</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">},</span>
  <span class="no">STOP</span> <span class="o">{</span> <span class="c1">// This must be the last instance.</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">amount</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// Disallow</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"SHUT_DOWN.amount()"</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">};</span>    
  <span class="kt">int</span> <span class="n">value</span><span class="o">;</span> <span class="c1">// In cents</span>
  <span class="nc">Input</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
  <span class="nc">Input</span><span class="o">()</span> <span class="o">{}</span>
  <span class="kt">int</span> <span class="nf">amount</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">value</span><span class="o">;</span> <span class="o">};</span> <span class="c1">// In cents</span>
  <span class="kd">static</span> <span class="nc">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Input</span> <span class="nf">randomSelection</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// Don't include STOP:</span>
    <span class="k">return</span> <span class="nf">values</span><span class="o">()[</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">values</span><span class="o">().</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)];</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
</pre><td class="rouge-code"><pre><span class="c1">//: enumerated/VendingMachine.java</span>
<span class="c1">// {Args: VendingMachineInput.txt}</span>
<span class="kn">package</span> <span class="nn">enumerated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">enumerated</span><span class="o">.</span><span class="na">Input</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">enum</span> <span class="nc">Category</span> <span class="o">{</span>
  <span class="no">MONEY</span><span class="o">(</span><span class="no">NICKEL</span><span class="o">,</span> <span class="no">DIME</span><span class="o">,</span> <span class="no">QUARTER</span><span class="o">,</span> <span class="no">DOLLAR</span><span class="o">),</span>
  <span class="no">ITEM_SELECTION</span><span class="o">(</span><span class="no">TOOTHPASTE</span><span class="o">,</span> <span class="no">CHIPS</span><span class="o">,</span> <span class="no">SODA</span><span class="o">,</span> <span class="no">SOAP</span><span class="o">),</span>
  <span class="no">QUIT_TRANSACTION</span><span class="o">(</span><span class="no">ABORT_TRANSACTION</span><span class="o">),</span>
  <span class="no">SHUT_DOWN</span><span class="o">(</span><span class="no">STOP</span><span class="o">);</span>
  <span class="kd">private</span> <span class="nc">Input</span><span class="o">[]</span> <span class="n">values</span><span class="o">;</span>
  <span class="nc">Category</span><span class="o">(</span><span class="nc">Input</span><span class="o">...</span> <span class="n">types</span><span class="o">)</span> <span class="o">{</span> <span class="n">values</span> <span class="o">=</span> <span class="n">types</span><span class="o">;</span> <span class="o">}</span>    
  <span class="kd">private</span> <span class="kd">static</span> <span class="nc">EnumMap</span><span class="o">&lt;</span><span class="nc">Input</span><span class="o">,</span><span class="nc">Category</span><span class="o">&gt;</span> <span class="n">categories</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">EnumMap</span><span class="o">&lt;</span><span class="nc">Input</span><span class="o">,</span><span class="nc">Category</span><span class="o">&gt;(</span><span class="nc">Input</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="kd">static</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Category</span> <span class="n">c</span> <span class="o">:</span> <span class="nc">Category</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">())</span>
      <span class="k">for</span><span class="o">(</span><span class="nc">Input</span> <span class="n">type</span> <span class="o">:</span> <span class="n">c</span><span class="o">.</span><span class="na">values</span><span class="o">)</span>
        <span class="n">categories</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">c</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Category</span> <span class="nf">categorize</span><span class="o">(</span><span class="nc">Input</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">categories</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>    

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">VendingMachine</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="nc">State</span> <span class="n">state</span> <span class="o">=</span> <span class="nc">State</span><span class="o">.</span><span class="na">RESTING</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">amount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Input</span> <span class="n">selection</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="kd">enum</span> <span class="nc">StateDuration</span> <span class="o">{</span> <span class="no">TRANSIENT</span> <span class="o">}</span> <span class="c1">// Tagging enum</span>
  <span class="kd">enum</span> <span class="nc">State</span> <span class="o">{</span>
    <span class="no">RESTING</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">next</span><span class="o">(</span><span class="nc">Input</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="nc">Category</span><span class="o">.</span><span class="na">categorize</span><span class="o">(</span><span class="n">input</span><span class="o">))</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nl">MONEY:</span>
            <span class="n">amount</span> <span class="o">+=</span> <span class="n">input</span><span class="o">.</span><span class="na">amount</span><span class="o">();</span>
            <span class="n">state</span> <span class="o">=</span> <span class="no">ADDING_MONEY</span><span class="o">;</span>
            <span class="k">break</span><span class="o">;</span>
          <span class="k">case</span> <span class="nl">SHUT_DOWN:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="no">TERMINAL</span><span class="o">;</span>
          <span class="k">default</span><span class="o">:</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">},</span>    
    <span class="no">ADDING_MONEY</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">next</span><span class="o">(</span><span class="nc">Input</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="nc">Category</span><span class="o">.</span><span class="na">categorize</span><span class="o">(</span><span class="n">input</span><span class="o">))</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nl">MONEY:</span>
            <span class="n">amount</span> <span class="o">+=</span> <span class="n">input</span><span class="o">.</span><span class="na">amount</span><span class="o">();</span>
            <span class="k">break</span><span class="o">;</span>
          <span class="k">case</span> <span class="nl">ITEM_SELECTION:</span>
            <span class="n">selection</span> <span class="o">=</span> <span class="n">input</span><span class="o">;</span>
            <span class="k">if</span><span class="o">(</span><span class="n">amount</span> <span class="o">&lt;</span> <span class="n">selection</span><span class="o">.</span><span class="na">amount</span><span class="o">())</span>
              <span class="n">print</span><span class="o">(</span><span class="s">"Insufficient money for "</span> <span class="o">+</span> <span class="n">selection</span><span class="o">);</span>
            <span class="k">else</span> <span class="n">state</span> <span class="o">=</span> <span class="no">DISPENSING</span><span class="o">;</span>
            <span class="k">break</span><span class="o">;</span>
          <span class="k">case</span> <span class="nl">QUIT_TRANSACTION:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="no">GIVING_CHANGE</span><span class="o">;</span>
            <span class="k">break</span><span class="o">;</span>
          <span class="k">case</span> <span class="nl">SHUT_DOWN:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="no">TERMINAL</span><span class="o">;</span>
          <span class="k">default</span><span class="o">:</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">},</span>    
    <span class="no">DISPENSING</span><span class="o">(</span><span class="nc">StateDuration</span><span class="o">.</span><span class="na">TRANSIENT</span><span class="o">)</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">print</span><span class="o">(</span><span class="s">"here is your "</span> <span class="o">+</span> <span class="n">selection</span><span class="o">);</span>
        <span class="n">amount</span> <span class="o">-=</span> <span class="n">selection</span><span class="o">.</span><span class="na">amount</span><span class="o">();</span>
        <span class="n">state</span> <span class="o">=</span> <span class="no">GIVING_CHANGE</span><span class="o">;</span>
      <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">GIVING_CHANGE</span><span class="o">(</span><span class="nc">StateDuration</span><span class="o">.</span><span class="na">TRANSIENT</span><span class="o">)</span> <span class="o">{</span>
      <span class="kt">void</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">print</span><span class="o">(</span><span class="s">"Your change: "</span> <span class="o">+</span> <span class="n">amount</span><span class="o">);</span>
          <span class="n">amount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">state</span> <span class="o">=</span> <span class="no">RESTING</span><span class="o">;</span>
      <span class="o">}</span>
    <span class="o">},</span>    
    <span class="no">TERMINAL</span> <span class="o">{</span> <span class="kt">void</span> <span class="nf">output</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="s">"Halted"</span><span class="o">);</span> <span class="o">}</span> <span class="o">};</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isTransient</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="nc">State</span><span class="o">()</span> <span class="o">{}</span>
    <span class="nc">State</span><span class="o">(</span><span class="nc">StateDuration</span> <span class="n">trans</span><span class="o">)</span> <span class="o">{</span> <span class="n">isTransient</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span> <span class="o">}</span>
    <span class="kt">void</span> <span class="nf">next</span><span class="o">(</span><span class="nc">Input</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Only call "</span> <span class="o">+</span>
        <span class="s">"next(Input input) for non-transient states"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kt">void</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Only call next() for "</span> <span class="o">+</span>
        <span class="s">"StateDuration.TRANSIENT states"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kt">void</span> <span class="nf">output</span><span class="o">()</span> <span class="o">{</span> <span class="n">print</span><span class="o">(</span><span class="n">amount</span><span class="o">);</span> <span class="o">}</span>
  <span class="o">}</span>    
  <span class="kd">static</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">(</span><span class="nc">Generator</span><span class="o">&lt;</span><span class="nc">Input</span><span class="o">&gt;</span> <span class="n">gen</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">while</span><span class="o">(</span><span class="n">state</span> <span class="o">!=</span> <span class="nc">State</span><span class="o">.</span><span class="na">TERMINAL</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">state</span><span class="o">.</span><span class="na">next</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
      <span class="k">while</span><span class="o">(</span><span class="n">state</span><span class="o">.</span><span class="na">isTransient</span><span class="o">)</span>
        <span class="n">state</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
      <span class="n">state</span><span class="o">.</span><span class="na">output</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Generator</span><span class="o">&lt;</span><span class="nc">Input</span><span class="o">&gt;</span> <span class="n">gen</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomInputGenerator</span><span class="o">();</span>
    <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>
      <span class="n">gen</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputGenerator</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
    <span class="n">run</span><span class="o">(</span><span class="n">gen</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>    

<span class="c1">// For a basic sanity check:</span>
<span class="kd">class</span> <span class="nc">RandomInputGenerator</span> <span class="kd">implements</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="nc">Input</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">Input</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="nc">Input</span><span class="o">.</span><span class="na">randomSelection</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Create Inputs from a file of ';'-separated strings:</span>
<span class="kd">class</span> <span class="nc">FileInputGenerator</span> <span class="kd">implements</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="nc">Input</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">input</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">FileInputGenerator</span><span class="o">(</span><span class="nc">String</span> <span class="n">fileName</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextFile</span><span class="o">(</span><span class="n">fileName</span><span class="o">,</span> <span class="s">";"</span><span class="o">).</span><span class="na">iterator</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">Input</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(!</span><span class="n">input</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">return</span> <span class="nc">Enum</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="nc">Input</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">input</span><span class="o">.</span><span class="na">next</span><span class="o">().</span><span class="na">trim</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
25
50
75
here is your CHIPS
0
100
200
here is your TOOTHPASTE
0
25
35
Your change: 35
0
25
35
Insufficient money for SODA
35
60
70
75
Insufficient money for SODA
75
Your change: 75
0
Halted
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>QUARTER; QUARTER; QUARTER; CHIPS;
DOLLAR; DOLLAR; TOOTHPASTE;
QUARTER; DIME; ABORT_TRANSACTION;
QUARTER; DIME; SODA;
QUARTER; DIME; NICKEL; SODA;
ABORT_TRANSACTION;
STOP;
</pre></table></code></div></div><h2 id="11多路分发">11.多路分发</h2><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
</pre><td class="rouge-code"><pre>//: enumerated/Outcome.java
package enumerated;
public enum Outcome { WIN, LOSE, DRAW } ///:~

//: enumerated/RoShamBo1.java
// Demonstration of multiple dispatching.
package enumerated;
import java.util.*;
import static enumerated.Outcome.*;

interface Item {
  Outcome compete(Item it);
  Outcome eval(Paper p);
  Outcome eval(Scissors s);
  Outcome eval(Rock r);
}

class Paper implements Item {
  public Outcome compete(Item it) { return it.eval(this); }
  public Outcome eval(Paper p) { return DRAW; }
  public Outcome eval(Scissors s) { return WIN; }
  public Outcome eval(Rock r) { return LOSE; }
  public String toString() { return "Paper"; }
}    

class Scissors implements Item {
  public Outcome compete(Item it) { return it.eval(this); }
  public Outcome eval(Paper p) { return LOSE; }
  public Outcome eval(Scissors s) { return DRAW; }
  public Outcome eval(Rock r) { return WIN; }
  public String toString() { return "Scissors"; }
}

class Rock implements Item {
  public Outcome compete(Item it) { return it.eval(this); }
  public Outcome eval(Paper p) { return WIN; }
  public Outcome eval(Scissors s) { return LOSE; }
  public Outcome eval(Rock r) { return DRAW; }
  public String toString() { return "Rock"; }
}    

public class RoShamBo1 {
  static final int SIZE = 20;
  private static Random rand = new Random(47);
  public static Item newItem() {
    switch(rand.nextInt(3)) {
      default:
      case 0: return new Scissors();
      case 1: return new Paper();
      case 2: return new Rock();
    }
  }
  public static void match(Item a, Item b) {
    System.out.println(
      a + " vs. " + b + ": " +  a.compete(b));
  }
  public static void main(String[] args) {
    for(int i = 0; i &lt; SIZE; i++)
      match(newItem(), newItem());
  }
} /* Output:    
Rock vs. Rock: DRAW
Paper vs. Rock: WIN
Paper vs. Rock: WIN
Paper vs. Rock: WIN
Scissors vs. Paper: WIN
Scissors vs. Scissors: DRAW
Scissors vs. Paper: WIN
Rock vs. Paper: LOSE
Paper vs. Paper: DRAW
Rock vs. Paper: LOSE
Paper vs. Scissors: LOSE
Paper vs. Scissors: LOSE
Rock vs. Scissors: WIN
Rock vs. Paper: LOSE
Paper vs. Rock: WIN
Scissors vs. Paper: WIN
Paper vs. Scissors: LOSE
Paper vs. Scissors: LOSE
Paper vs. Scissors: LOSE
Paper vs. Scissors: LOSE
*///:~
</pre></table></code></div></div><h3 id="111-使用enum分发">11.1 使用enum分发</h3><h3 id="112-使用常量相关的方法">11.2 使用常量相关的方法</h3><h3 id="114-使用二维数组">11.4 使用二维数组</h3></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/thinking-in-java/" class="post-tag no-text-decoration" >Thinking in Java</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=《Java编程思想》第19章枚举类型 - malinkang&url=https://malinkang.cn/posts/thinking-in-java-enumerated-types/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=《Java编程思想》第19章枚举类型 - malinkang&u=https://malinkang.cn/posts/thinking-in-java-enumerated-types/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=《Java编程思想》第19章枚举类型 - malinkang&url=https://malinkang.cn/posts/thinking-in-java-enumerated-types/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/dagger-guide/">Dagger使用指南</a><li><a href="/posts/understanding-the-jvm-runtime-data-areas/">《深入理解JVM》第2章Java内存区域与内存溢出异常</a><li><a href="/posts/understanding-the-jvm-garbage-collection/">《深入理解JVM》第3章垃圾收集器</a><li><a href="/posts/understanding-the-jvm-class-file-structure/">《深入理解JVM》第6章类文件结构</a><li><a href="/posts/understanding-the-jvm-class-loader/">《深入理解JVM》第7章虚拟机类加载机制</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/thinking-in-java/">Thinking in Java</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">Java并发编程实战</a> <a class="post-tag" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3jvm/">深入理解JVM</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/databinding/">databinding</a> <a class="post-tag" href="/tags/recyclerview/">RecyclerView</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/thinking-in-java-everything-is-an-object/"><div class="card-body"> <span class="timeago small" > Mar 20, 2013 <i class="unloaded">2013-03-20T00:26:34+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《Java编程思想》第2章一切都是对象</h3><div class="text-muted small"><p> 2.2 必须由你创建所有对象 2.2.1 存储到什么地方 2.2.2 特例：基本类型 在程序设计中经常用到一系列类型，它们需要特殊对待。可以把它们想象成“基本”类型。之所以特殊对待，是因为new将对象存储在“堆”里，故用new创建一个对象，特别是小的、简单的变量，往往不是很有效。因此，对于这些类型，Java采取与C和C++相同的方法。也就是说，不用new来创建变量，而是创建一个并非是引...</p></div></div></a></div><div class="card"> <a href="/posts/thinking-in-java-operators/"><div class="card-body"> <span class="timeago small" > Mar 26, 2013 <i class="unloaded">2013-03-26T21:39:36+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《Java编程思想》第3章操作符</h3><div class="text-muted small"><p></p></div></div></a></div><div class="card"> <a href="/posts/thinking-in-java-controlling-execution/"><div class="card-body"> <span class="timeago small" > Apr 2, 2013 <i class="unloaded">2013-04-02T21:39:36+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《Java编程思想》第4章控制流程</h3><div class="text-muted small"><p></p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/thinking-in-java-i-o/" class="btn btn-outline-primary" prompt="Older"><p>《Java编程思想》第18章I/O系统</p></a> <a href="/posts/thinking-in-java-annotations/" class="btn btn-outline-primary" prompt="Newer"><p>《Java编程思想》第20章注解</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//malinkang-cn.disqus.com/embed.js', disqusConfig: function() { this.page.title = '《Java编程思想》第19章枚举类型'; this.page.url = 'https://malinkang.cn/posts/thinking-in-java-enumerated-types/'; this.page.identifier = '/posts/thinking-in-java-enumerated-types/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/malinkang">malinkang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/thinking-in-java/">Thinking in Java</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">Java并发编程实战</a> <a class="post-tag" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3jvm/">深入理解JVM</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/databinding/">databinding</a> <a class="post-tag" href="/tags/recyclerview/">RecyclerView</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://malinkang.cn{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
