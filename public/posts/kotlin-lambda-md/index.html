<!DOCTYPE html>
<html><head>
<title>Kotlin 高阶函数和lambda表达式</title>

<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">




<script src="/vendor/js/jquery.min.js" ></script>
<script src="/vendor/js/popper.min.js" ></script>
<script src="/vendor/js/bootstrap.min.js" ></script>
<script src="/vendor/js/smooth-scroll.polyfills.min.js" ></script>
<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">
<script src="/vendor/js/vue.min.js" ></script>




<link rel="stylesheet" href="https://malinkang.cn/scss/journal.min.56b67b8b01d7cd1015ed14414fd2fc33ebfb2e8413dcbc47c5cd734544c92cd7.css" integrity="sha256-VrZ7iwHXzRAV7RRBT9L8M&#43;v7LoQT3LxHxc1zRUTJLNc=" media="screen">



<link rel="stylesheet" href="https://malinkang.cn/scss/dark-mode.min.5a2bbd1758c83affd639a91fbfd5cc681b1a5574df99442825c444dd40504b13.css" integrity="sha256-Wiu9F1jIOv/WOakfv9XMaBsaVXTfmUQoJcRE3UBQSxM=" media="screen">


<script src="https://malinkang.cn//js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons");
</script>

<script src="https://malinkang.cn//js/table.js"></script>




<script src="https://malinkang.cn//js/toc.js"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="/vendor/js/md5.min.js"></script>
<script>
  var gitalk = new Gitalk({
  clientID: 'd84786eae9edb9e6521b',
  clientSecret: 'a30a17b679a15e85b8f257eec4231d5b286e1b58',
  repo: 'malinkang.github.io',
  owner: 'malinkang',
  admin: ['malinkang'],
  id: md5(location.pathname),
  distractionFreeMode: 'false'
  });
  window.onload = function () {
        gitalk.render('gitalk-container')
  }
</script>






</head><body>
    	<div id="app"><div ref="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://malinkang.cn/">
    
        <div class="nav-title">
            Malinkang‘s Blog
        </div>
        
        <div class="nav-subtitle">
            人生最可悲的事情，莫过于胸怀大志，却又虚度光阴。
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                Archive
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="https://android.malinkang.cn">
                Android笔记
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="https://kotlin.malinkang.cn">
                Kotlin笔记
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/index.xml">
                RSS Feed
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	This is a customized copyright.
	
    </div>
    
</div><div ref="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e9%ab%98%e9%98%b6%e5%87%bd%e6%95%b0" v-on:click="closeDrawer" id="高阶函数-nav">
										 高阶函数
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#it%e5%8d%95%e4%b8%aa%e5%8f%82%e6%95%b0%e7%9a%84%e9%9a%90%e5%bc%8f%e5%90%8d%e7%a7%b0" v-on:click="closeDrawer" id="it单个参数的隐式名称-nav">
										 it：单个参数的隐式名称
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e4%b8%8b%e5%88%92%e7%ba%bf%e7%94%a8%e4%ba%8e%e6%9c%aa%e4%bd%bf%e7%94%a8%e7%9a%84%e5%8f%98%e9%87%8f%e8%87%aa-11-%e8%b5%b7" v-on:click="closeDrawer" id="下划线用于未使用的变量自-11-起-nav">
										 下划线用于未使用的变量（自 1.1 起）
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#lambda-%e8%a1%a8%e8%be%be%e5%bc%8f%e4%b8%8e%e5%8c%bf%e5%90%8d%e5%87%bd%e6%95%b0" v-on:click="closeDrawer" id="lambda-表达式与匿名函数-nav">
										 Lambda 表达式与匿名函数
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%87%bd%e6%95%b0%e7%b1%bb%e5%9e%8b" v-on:click="closeDrawer" id="函数类型-nav">
										 函数类型
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#lambda-%e8%a1%a8%e8%be%be%e5%bc%8f%e8%af%ad%e6%b3%95" v-on:click="closeDrawer" id="lambda-表达式语法-nav">
										 Lambda 表达式语法
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8c%bf%e5%90%8d%e5%87%bd%e6%95%b0" v-on:click="closeDrawer" id="匿名函数-nav">
										 匿名函数
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a class="pagination-action" v-on:click="toggleDarkMode">
            <i class="material-icons pagination-action-icon" v-if="isDarkMode">
                brightness_4
            </i>
            <i class="material-icons pagination-action-icon" v-else="isDarkMode">
                brightness_7
            </i>
        </a>
        
        
    </div>
</div><div class="single-column-drawer-container" ref="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    Archive
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="https://android.malinkang.cn">
                    Android笔记
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="https://kotlin.malinkang.cn">
                    Kotlin笔记
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/index.xml">
                    RSS Feed
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e9%ab%98%e9%98%b6%e5%87%bd%e6%95%b0" v-on:click="closeDrawer" id="高阶函数-nav">
										 高阶函数
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#it%e5%8d%95%e4%b8%aa%e5%8f%82%e6%95%b0%e7%9a%84%e9%9a%90%e5%bc%8f%e5%90%8d%e7%a7%b0" v-on:click="closeDrawer" id="it单个参数的隐式名称-nav">
										 it：单个参数的隐式名称
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e4%b8%8b%e5%88%92%e7%ba%bf%e7%94%a8%e4%ba%8e%e6%9c%aa%e4%bd%bf%e7%94%a8%e7%9a%84%e5%8f%98%e9%87%8f%e8%87%aa-11-%e8%b5%b7" v-on:click="closeDrawer" id="下划线用于未使用的变量自-11-起-nav">
										 下划线用于未使用的变量（自 1.1 起）
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#lambda-%e8%a1%a8%e8%be%be%e5%bc%8f%e4%b8%8e%e5%8c%bf%e5%90%8d%e5%87%bd%e6%95%b0" v-on:click="closeDrawer" id="lambda-表达式与匿名函数-nav">
										 Lambda 表达式与匿名函数
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%87%bd%e6%95%b0%e7%b1%bb%e5%9e%8b" v-on:click="closeDrawer" id="函数类型-nav">
										 函数类型
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#lambda-%e8%a1%a8%e8%be%be%e5%bc%8f%e8%af%ad%e6%b3%95" v-on:click="closeDrawer" id="lambda-表达式语法-nav">
										 Lambda 表达式语法
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
				
				
					
						
						
							<ul>
						
							<ul>
						
							<ul>
						
							<ul>
						
						
								<li>
				 					<a href="#%e5%8c%bf%e5%90%8d%e5%87%bd%e6%95%b0" v-on:click="closeDrawer" id="匿名函数-nav">
										 匿名函数
									</a>
								</li>
						
							</ul>
						
							</ul>
						
							</ul>
						
							</ul>
						
					
				
			
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav ref="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div ref="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a ref="navTitle" class="navbar-brand" href="https://malinkang.cn/">
            Malinkang‘s Blog
        </a>
        
        <button type="button" class="nav-darkmode-toggle" v-on:click="toggleDarkMode">
            <i class="material-icons" v-if="isDarkMode">
                brightness_4
            </i>
            <i class="material-icons" v-else="isDarkMode">
                brightness_7
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" ref="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://malinkang.cn/">
        <div class="single-column-header-title">Malinkang‘s Blog</div>
        
        <div class="single-column-header-subtitle">人生最可悲的事情，莫过于胸怀大志，却又虚度光阴。</div>
        

    </a>
</div>
            <div id="content">
<div ref="streamContainer" class="stream-container">
    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    Kotlin 高阶函数和lambda表达式
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2017-08-02 13:47
                        </time>
                        

                        

                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                <div class="post-body">
                    <h3 id="高阶函数">高阶函数</h3>
<p>高阶函数是将函数用作参数或返回值的函数。 这种函数的一个很好的例子是 <code>lock()</code>，它接受一个锁对象和一个函数，获取锁，运行函数并释放锁：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">fun</span> &lt;T&gt; <span style="color:#a6e22e">lock</span>(lock: Lock, body: () -&gt; T): T {
    lock.lock()
    <span style="color:#66d9ef">try</span> {
        <span style="color:#66d9ef">return</span> body()
    }
    <span style="color:#66d9ef">finally</span> {
        lock.unlock()
    }
}
</code></pre></div><p><code>body</code> 拥有函数类型：<code>() -&gt; T</code>， 所以它应该是一个不带参数并且返回 <code>T</code> 类型值的函数。 它在 <code>try</code>代码块内部调用、被 <code>lock</code> 保护，其结果由<code>lock()</code>函数返回。</p>
<p>如果我们想调用 <code>lock()</code> 函数，我们可以把另一个函数传给它作为参数：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">toBeSynchronized</span>() = sharedResource.operation()

<span style="color:#66d9ef">val</span> result = lock(lock, <span style="color:#f92672">::</span>toBeSynchronized)
</code></pre></div><p>通常会更方便的另一种方式是传一个<code>lambda</code>表达式：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">val</span> result = lock(lock, { sharedResource.operation() })
</code></pre></div><ul>
<li><code>lambda</code>表达式总是括在花括号中；</li>
<li>其参数（如果有的话）在 <code>-&gt;</code> 之前声明（参数类型可以省略）；</li>
<li>函数体（如果存在的话）在 <code>-&gt;</code> 后面</li>
</ul>
<p><strong>在 <code>Kotlin</code> 中有一个约定，如果函数的最后一个参数是一个函数，并且你传递一个 <code>lambda</code> 表达式作为相应的参数，你可以在圆括号之外指定它</strong>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin">lock (lock) {
    sharedResource.operation()
}
</code></pre></div><p>高阶函数的另一个例子是 map()：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">fun</span> &lt;T, R&gt; <span style="color:#a6e22e">List</span>&lt;T&gt;.map(transform: (T) -&gt; R): List&lt;R&gt; {
    <span style="color:#66d9ef">val</span> result = arrayListOf&lt;R&gt;()
    <span style="color:#66d9ef">for</span> (item <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">this</span>)
        result.add(transform(item))
    <span style="color:#66d9ef">return</span> result
}
</code></pre></div><p>该函数可以如下调用:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">val</span> doubled = ints.map { value -&gt; value * <span style="color:#ae81ff">2</span> }
</code></pre></div><p>请注意，如果<code>lambda</code>是该调用的唯一参数，则调用中的圆括号可以完全省略。</p>
<h4 id="it单个参数的隐式名称">it：单个参数的隐式名称</h4>
<p>另一个有用的约定是，如果函数字面值只有一个参数， 那么它的声明可以省略（连同 <code>-&gt;</code>），其名称是 <code>it</code>。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin">ints.map { it * <span style="color:#ae81ff">2</span> }
</code></pre></div><h4 id="下划线用于未使用的变量自-11-起">下划线用于未使用的变量（自 1.1 起）</h4>
<p>如果<code>lambda</code>表达式的参数未使用，那么可以用下划线取代其名称：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin">map.forEach { _, value -&gt; println(<span style="color:#e6db74">&#34;$value!&#34;</span>) }
</code></pre></div><h3 id="lambda-表达式与匿名函数">Lambda 表达式与匿名函数</h3>
<p>一个<code>lambda</code>表达式或匿名函数是一个“函数字面值”，即一个未声明的函数， 但立即做为表达式传递。考虑下面的例子：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin">max(strings, { a, b -&gt; a.length &lt; b.length })
</code></pre></div><p>函数<code>max</code>是一个高阶函数，换句话说它接受一个函数作为第二个参数。 其第二个参数是一个表达式，它本身是一个函数，即函数字面值。写成函数的话，它相当于：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">compare</span>(a: String, b: String): Boolean = a.length &lt; b.length
</code></pre></div><h4 id="函数类型">函数类型</h4>
<p>对于接受另一个函数作为参数的函数，我们必须为该参数指定函数类型。 例如上述函数<code>max</code>定义如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">fun</span> &lt;T&gt; <span style="color:#a6e22e">max</span>(collection: Collection&lt;T&gt;, less: (T, T) -&gt; Boolean): T? {
    <span style="color:#66d9ef">var</span> max: T? = <span style="color:#66d9ef">null</span>
    <span style="color:#66d9ef">for</span> (it <span style="color:#66d9ef">in</span> collection)
        <span style="color:#66d9ef">if</span> (max == <span style="color:#66d9ef">null</span> || less(max, it))
            max = it
    <span style="color:#66d9ef">return</span> max
}
</code></pre></div><p>参数<code>less</code>的类型是 <code>(T, T) -&gt; Boolean</code>，即一个接受两个类型<code>T</code>的参数并返回一个布尔值的函数： 如果第一个参数小于第二个那么该函数返回<code>true</code>。</p>
<p>在上面第 4 行代码中，<code>less</code>作为一个函数使用：通过传入两个<code>T</code>类型的参数来调用。</p>
<p>如上所写的是就函数类型，或者可以有命名参数，如果你想文档化每个参数的含义的话。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">val</span> compare: (x: T, y: T) -&gt; Int = <span style="color:#960050;background-color:#1e0010">……</span>
</code></pre></div><p>如要声明一个函数类型的可空变量，请将整个函数类型括在括号中并在其后加上问号：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">var</span> sum: ((Int, Int) -&gt; Int)? = <span style="color:#66d9ef">null</span>
</code></pre></div><h3 id="lambda-表达式语法">Lambda 表达式语法</h3>
<p>Lambda 表达式的完整语法形式，即函数类型的字面值如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">val</span> sum = { x: Int, y: Int -&gt; x + y }
</code></pre></div><p><code>lambda</code>表达式总是括在花括号中， 完整语法形式的参数声明放在花括号内，并有可选的类型标注， 函数体跟在一个 -&gt; 符号之后。如果推断出的该<code>lambda</code>的返回类型不是<code>Unit</code>，那么该<code>lambda</code> 主体中的最后一个（或可能是单个）表达式会视为返回值。</p>
<p>如果我们把所有可选标注都留下，看起来如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">val</span> sum: (Int, Int) -&gt; Int = { x, y -&gt; x + y }
</code></pre></div><p>一个<code>lambda</code>表达式只有一个参数是很常见的。 如果<code>Kotlin</code>可以自己计算出签名，它允许我们不声明唯一的参数，并且将隐含地为我们声明其名称为 <code>it</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin">ints.filter { it &gt; <span style="color:#ae81ff">0</span> } <span style="color:#75715e">// 这个字面值是“(it: Int) -&gt; Boolean”类型的
</span></code></pre></div><p>我们可以使用<code>限定的返回</code>语法从<code>lambda</code>显式返回一个值。否则，将隐式返回最后一个表达式的值。因此，以下两个片段是等价的：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin">ints.filter {
    <span style="color:#66d9ef">val</span> shouldFilter = it &gt; <span style="color:#ae81ff">0</span> 
    shouldFilter
}

ints.filter {
    <span style="color:#66d9ef">val</span> shouldFilter = it &gt; <span style="color:#ae81ff">0</span> 
    <span style="color:#66d9ef">return</span>@filter shouldFilter
}
</code></pre></div><p>请注意，如果一个函数接受另一个函数作为最后一个参数，lambda 表达式参数可以在圆括号参数列表之外传递。</p>
<h4 id="匿名函数">匿名函数</h4>
<p>上面提供的<code>lambda</code>表达式语法缺少的一个东西是指定函数的返回类型的能力。在大多数情况下，这是不必要的。因为返回类型可以自动推断出来。然而，如果确实需要显式指定，可以使用另一种语法： 匿名函数 。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">fun</span>(x: Int, y: Int): Int = x + y
</code></pre></div><p>匿名函数看起来非常像一个常规函数声明，除了其名称省略了。其函数体可以是表达式（如上所示）或代码块：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#66d9ef">fun</span>(x: Int, y: Int): Int {
    <span style="color:#66d9ef">return</span> x + y
}
</code></pre></div><p>参数和返回类型的指定方式与常规函数相同，除了能够从上下文推断出的参数类型可以省略：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin">ints.filter(<span style="color:#66d9ef">fun</span>(item) = item &gt; <span style="color:#ae81ff">0</span>)
</code></pre></div><p>匿名函数的返回类型推断机制与正常函数一样：对于具有表达式函数体的匿名函数将自动推断返回类型，而具有代码块函数体的返回类型必须显式指定（或者已假定为 Unit）。</p>
<p>请注意，匿名函数参数总是在括号内传递。 允许将函数留在圆括号外的简写语法仅适用于<code>lambda</code>表达式。</p>
<p><code>Lambda</code>表达式与匿名函数之间的另一个区别是非局部返回的行为。一个不带标签的<code>return</code>语句总是在用<code>fun</code>关键字声明的函数中返回。这意味着<code>lambda</code>表达式中的<code>return</code>将从包含它的函数返回，而匿名函数中的<code>return</code>将从匿名函数自身返回。</p>

                    
                    <HR width="100%" id="EOF">
                    <p style="color:#777;">Last modified on 2017-08-02</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://malinkang.cn/posts/signing-android-app/">
                    Next<br>签署Android应用
                </a>
                
                
                
                <a class="older-posts" href="https://malinkang.cn/posts/goodbye-xiao-hua/">
                    Previous<br>小花，再见
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                


<div id="gitalk-container"></div>





            </div>
        </div>
    </div>
</div>

            </div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	This is a customized copyright.
	</div>
    	</div>
    <script src="https://malinkang.cn//js/journal.js"></script>
    </body>
</html>
