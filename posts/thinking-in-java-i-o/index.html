<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="《Java编程思想》第18章I/O系统" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="1.File类" /><meta property="og:description" content="1.File类" /><link rel="canonical" href="https://malinkang.cn/posts/thinking-in-java-i-o/" /><meta property="og:url" content="https://malinkang.cn/posts/thinking-in-java-i-o/" /><meta property="og:site_name" content="malinkang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2013-07-09T21:39:36+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="《Java编程思想》第18章I/O系统" /><meta name="twitter:site" content="@malinkang" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"1.File类","headline":"《Java编程思想》第18章I/O系统","dateModified":"2013-07-09T21:39:36+08:00","url":"https://malinkang.cn/posts/thinking-in-java-i-o/","datePublished":"2013-07-09T21:39:36+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://malinkang.cn/posts/thinking-in-java-i-o/"},"@context":"https://schema.org"}</script><title>《Java编程思想》第18章I/O系统 | malinkang</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="malinkang"><meta name="application-name" content="malinkang"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/images/avatar.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">malinkang</a></div><div class="site-subtitle font-italic">人生最可悲的事情，莫过于胸怀大志，却又虚度光阴。</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/malinkang" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/malinkang" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['linkang.ma','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>《Java编程思想》第18章I/O系统</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>《Java编程思想》第18章I/O系统</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> malinkang </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jul 9, 2013, 9:39 PM +0800" prep="on" > Jul 9, 2013 <i class="unloaded">2013-07-09T21:39:36+08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2124 words">11 min</span></div></div><div class="post-content"><h2 id="1file类">1.File类</h2><h3 id="11-目录列表器">1.1 目录列表器</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="c1">//: io/DirList.java</span>
<span class="c1">// Display a directory listing using regular expressions.</span>
<span class="c1">// {Args: "D.*\.java"}</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DirList</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">File</span> <span class="n">path</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"."</span><span class="o">);</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">list</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
      <span class="n">list</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">list</span><span class="o">();</span>
    <span class="k">else</span>
      <span class="n">list</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="k">new</span> <span class="nc">DirFilter</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]));</span>
    <span class="nc">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">CASE_INSENSITIVE_ORDER</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">dirItem</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dirItem</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//目录过滤器</span>
<span class="kd">class</span> <span class="nc">DirFilter</span> <span class="kd">implements</span> <span class="nc">FilenameFilter</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="nc">Pattern</span> <span class="n">pattern</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">DirFilter</span><span class="o">(</span><span class="nc">String</span> <span class="n">regex</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="nc">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">regex</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">File</span> <span class="n">dir</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">name</span><span class="o">).</span><span class="na">matches</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
DirectoryDemo.java
DirList.java
DirList2.java
DirList3.java
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">DirFilter</code>这个类存在的唯一原因就是将<code class="language-plaintext highlighter-rouge">accept()</code>方法提供给<code class="language-plaintext highlighter-rouge">list()</code>使用。</p><p>用一个匿名内部类进行改写。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="c1">//: io/DirList2.java</span>
<span class="c1">// Uses anonymous inner classes.</span>
<span class="c1">// {Args: "D.*\.java"}</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DirList2</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">FilenameFilter</span> <span class="nf">filter</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">regex</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Creation of anonymous inner class:</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">FilenameFilter</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">private</span> <span class="nc">Pattern</span> <span class="n">pattern</span> <span class="o">=</span> <span class="nc">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">regex</span><span class="o">);</span>
      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">File</span> <span class="n">dir</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">name</span><span class="o">).</span><span class="na">matches</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">};</span> <span class="c1">// End of anonymous inner class</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">File</span> <span class="n">path</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"."</span><span class="o">);</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">list</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
      <span class="n">list</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">list</span><span class="o">();</span>
    <span class="k">else</span>
      <span class="n">list</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">filter</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]));</span>
    <span class="nc">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">CASE_INSENSITIVE_ORDER</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">dirItem</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dirItem</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
DirectoryDemo.java
DirList.java
DirList2.java
DirList3.java
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><p>进一步修改该方法</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="c1">//: io/DirList3.java</span>
<span class="c1">// Building the anonymous inner class "in-place."</span>
<span class="c1">// {Args: "D.*\.java"}</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DirList3</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">File</span> <span class="n">path</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"."</span><span class="o">);</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">list</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
      <span class="n">list</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">list</span><span class="o">();</span>
    <span class="k">else</span>
      <span class="n">list</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="k">new</span> <span class="nc">FilenameFilter</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">Pattern</span> <span class="n">pattern</span> <span class="o">=</span> <span class="nc">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">File</span> <span class="n">dir</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">name</span><span class="o">).</span><span class="na">matches</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">});</span>
    <span class="nc">Arrays</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">CASE_INSENSITIVE_ORDER</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">dirItem</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dirItem</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
DirectoryDemo.java
DirList.java
DirList2.java
DirList3.java
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h3 id="12-目录实用工具">1.2 目录实用工具</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
</pre><td class="rouge-code"><pre><span class="c1">//: net/mindview/util/Directory.java</span>
<span class="c1">// Produce a sequence of File objects that match a</span>
<span class="c1">// regular expression in either a local directory,</span>
<span class="c1">// or by walking a directory tree.</span>
<span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Directory</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">File</span><span class="o">[]</span> <span class="nf">local</span><span class="o">(</span><span class="nc">File</span> <span class="n">dir</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">regex</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">dir</span><span class="o">.</span><span class="na">listFiles</span><span class="o">(</span><span class="k">new</span> <span class="nc">FilenameFilter</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">private</span> <span class="nc">Pattern</span> <span class="n">pattern</span> <span class="o">=</span> <span class="nc">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">regex</span><span class="o">);</span>
      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">File</span> <span class="n">dir</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span>
          <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="n">name</span><span class="o">).</span><span class="na">getName</span><span class="o">()).</span><span class="na">matches</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">});</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">File</span><span class="o">[]</span> <span class="nf">local</span><span class="o">(</span><span class="nc">String</span> <span class="n">path</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">regex</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// Overloaded</span>
    <span class="k">return</span> <span class="nf">local</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">path</span><span class="o">),</span> <span class="n">regex</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="c1">// A two-tuple for returning a pair of objects:</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TreeInfo</span> <span class="kd">implements</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;</span> <span class="n">files</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;();</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;</span> <span class="n">dirs</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;();</span>
    <span class="c1">// The default iterable element is the file list:</span>
    <span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">File</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">files</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kt">void</span> <span class="nf">addAll</span><span class="o">(</span><span class="nc">TreeInfo</span> <span class="n">other</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">files</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">other</span><span class="o">.</span><span class="na">files</span><span class="o">);</span>
      <span class="n">dirs</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">other</span><span class="o">.</span><span class="na">dirs</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">//容器默认的toString()方法会在单个行中打印容器中的所有元素，对于大型集合来说，难以阅读。</span>
    <span class="c1">//PPrint是一个可以添加新行并缩排所有元素的工具</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="s">"dirs: "</span> <span class="o">+</span> <span class="nc">PPrint</span><span class="o">.</span><span class="na">pformat</span><span class="o">(</span><span class="n">dirs</span><span class="o">)</span> <span class="o">+</span>
        <span class="s">"\n\nfiles: "</span> <span class="o">+</span> <span class="nc">PPrint</span><span class="o">.</span><span class="na">pformat</span><span class="o">(</span><span class="n">files</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">TreeInfo</span> <span class="nf">walk</span><span class="o">(</span><span class="nc">String</span> <span class="n">start</span><span class="o">,</span> <span class="nc">String</span> <span class="n">regex</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// Begin recursion</span>
    <span class="k">return</span> <span class="nf">recurseDirs</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">start</span><span class="o">),</span> <span class="n">regex</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">TreeInfo</span> <span class="nf">walk</span><span class="o">(</span><span class="nc">File</span> <span class="n">start</span><span class="o">,</span> <span class="nc">String</span> <span class="n">regex</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// Overloaded</span>
    <span class="k">return</span> <span class="nf">recurseDirs</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">regex</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">TreeInfo</span> <span class="nf">walk</span><span class="o">(</span><span class="nc">File</span> <span class="n">start</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// Everything</span>
    <span class="k">return</span> <span class="nf">recurseDirs</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="s">".*"</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">TreeInfo</span> <span class="nf">walk</span><span class="o">(</span><span class="nc">String</span> <span class="n">start</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">recurseDirs</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">start</span><span class="o">),</span> <span class="s">".*"</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">static</span> <span class="nc">TreeInfo</span> <span class="nf">recurseDirs</span><span class="o">(</span><span class="nc">File</span> <span class="n">startDir</span><span class="o">,</span> <span class="nc">String</span> <span class="n">regex</span><span class="o">){</span>
    <span class="nc">TreeInfo</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TreeInfo</span><span class="o">();</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">File</span> <span class="n">item</span> <span class="o">:</span> <span class="n">startDir</span><span class="o">.</span><span class="na">listFiles</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">if</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">result</span><span class="o">.</span><span class="na">dirs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
        <span class="n">result</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">recurseDirs</span><span class="o">(</span><span class="n">item</span><span class="o">,</span> <span class="n">regex</span><span class="o">));</span>
      <span class="o">}</span> <span class="k">else</span> <span class="c1">// Regular file</span>
        <span class="k">if</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">matches</span><span class="o">(</span><span class="n">regex</span><span class="o">))</span>
          <span class="n">result</span><span class="o">.</span><span class="na">files</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="c1">// Simple validation test:</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">walk</span><span class="o">(</span><span class="s">"."</span><span class="o">));</span>
    <span class="k">else</span>
      <span class="nf">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">arg</span> <span class="o">:</span> <span class="n">args</span><span class="o">)</span>
       <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">walk</span><span class="o">(</span><span class="n">arg</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~</span>

<span class="c1">//: net/mindview/util/PPrint.java</span>
<span class="c1">// Pretty-printer for collections</span>
<span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PPrint</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">pformat</span><span class="o">(</span><span class="nc">Collection</span><span class="o">&lt;?&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="k">return</span> <span class="s">"[]"</span><span class="o">;</span>
    <span class="nc">StringBuilder</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">(</span><span class="s">"["</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">Object</span> <span class="n">elem</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="o">)</span>
        <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"\n  "</span><span class="o">);</span>
      <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">elem</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="o">)</span>
      <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
    <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"]"</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">pprint</span><span class="o">(</span><span class="nc">Collection</span><span class="o">&lt;?&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pformat</span><span class="o">(</span><span class="n">c</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">pprint</span><span class="o">(</span><span class="nc">Object</span><span class="o">[]</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pformat</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">c</span><span class="o">)));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~</span>
<span class="c1">//: io/DirectoryDemo.java</span>
<span class="c1">// Sample use of Directory utilities.</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">net</span><span class="o">.</span><span class="na">mindview</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Print</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DirectoryDemo</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// All directories:</span>
    <span class="nc">PPrint</span><span class="o">.</span><span class="na">pprint</span><span class="o">(</span><span class="nc">Directory</span><span class="o">.</span><span class="na">walk</span><span class="o">(</span><span class="s">"."</span><span class="o">).</span><span class="na">dirs</span><span class="o">);</span>
    <span class="c1">// All files beginning with 'T'</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span> <span class="o">:</span> <span class="nc">Directory</span><span class="o">.</span><span class="na">local</span><span class="o">(</span><span class="s">"."</span><span class="o">,</span> <span class="s">"T.*"</span><span class="o">))</span>
      <span class="n">print</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="s">"----------------------"</span><span class="o">);</span>
    <span class="c1">// All Java files beginning with 'T':</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span> <span class="o">:</span> <span class="nc">Directory</span><span class="o">.</span><span class="na">walk</span><span class="o">(</span><span class="s">"."</span><span class="o">,</span> <span class="s">"T.*\\.java"</span><span class="o">))</span>
      <span class="n">print</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="s">"======================"</span><span class="o">);</span>
    <span class="c1">// Class files containing "Z" or "z":</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span> <span class="o">:</span> <span class="nc">Directory</span><span class="o">.</span><span class="na">walk</span><span class="o">(</span><span class="s">"."</span><span class="o">,</span><span class="s">".*[Zz].*\\.class"</span><span class="o">))</span>
      <span class="n">print</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output: (Sample)
[.\xfiles]
.\TestEOF.class
.\TestEOF.java
.\TransferTo.class
.\TransferTo.java
----------------------
.\TestEOF.java
.\TransferTo.java
.\xfiles\ThawAlien.java
======================
.\FreezeAlien.class
.\GZIPcompress.class
.\ZipCompress.class
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="c1">//: net/mindview/util/ProcessFiles.java</span>
<span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProcessFiles</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Strategy</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">private</span> <span class="nc">Strategy</span> <span class="n">strategy</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">ext</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">ProcessFiles</span><span class="o">(</span><span class="nc">Strategy</span> <span class="n">strategy</span><span class="o">,</span> <span class="nc">String</span> <span class="n">ext</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">strategy</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
        <span class="n">processDirectoryTree</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"."</span><span class="o">));</span>
      <span class="k">else</span>
        <span class="nf">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">arg</span> <span class="o">:</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
          <span class="nc">File</span> <span class="n">fileArg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">arg</span><span class="o">);</span>
          <span class="k">if</span><span class="o">(</span><span class="n">fileArg</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">())</span>
            <span class="n">processDirectoryTree</span><span class="o">(</span><span class="n">fileArg</span><span class="o">);</span>
          <span class="k">else</span> <span class="o">{</span>
            <span class="c1">// Allow user to leave off extension:</span>
            <span class="k">if</span><span class="o">(!</span><span class="n">arg</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">"."</span> <span class="o">+</span> <span class="n">ext</span><span class="o">))</span>
              <span class="n">arg</span> <span class="o">+=</span> <span class="s">"."</span> <span class="o">+</span> <span class="n">ext</span><span class="o">;</span>
            <span class="n">strategy</span><span class="o">.</span><span class="na">process</span><span class="o">(</span>
              <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="n">arg</span><span class="o">).</span><span class="na">getCanonicalFile</span><span class="o">());</span>
          <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">processDirectoryTree</span><span class="o">(</span><span class="nc">File</span> <span class="n">root</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span> <span class="o">:</span> <span class="nc">Directory</span><span class="o">.</span><span class="na">walk</span><span class="o">(</span>
        <span class="n">root</span><span class="o">.</span><span class="na">getAbsolutePath</span><span class="o">(),</span> <span class="s">".*\\."</span> <span class="o">+</span> <span class="n">ext</span><span class="o">))</span>
      <span class="n">strategy</span><span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">getCanonicalFile</span><span class="o">());</span>
  <span class="o">}</span>
  <span class="c1">// Demonstration of how to use it:</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">new</span> <span class="nf">ProcessFiles</span><span class="o">(</span><span class="k">new</span> <span class="nc">ProcessFiles</span><span class="o">.</span><span class="na">Strategy</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
      <span class="o">}</span>
    <span class="o">},</span> <span class="s">"java"</span><span class="o">).</span><span class="na">start</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* (Execute to see output) */</span><span class="c1">//:~</span>
</pre></table></code></div></div><h3 id="13-目录的检查及创建">1.3 目录的检查及创建</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
</pre><td class="rouge-code"><pre><span class="c1">//: io/MakeDirectories.java</span>
<span class="c1">// Demonstrates the use of the File class to</span>
<span class="c1">// create directories and manipulate files.</span>
<span class="c1">// {Args: MakeDirectoriesTest}</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MakeDirectories</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">usage</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span>
      <span class="s">"Usage:MakeDirectories path1 ...\n"</span> <span class="o">+</span>
      <span class="s">"Creates each path\n"</span> <span class="o">+</span>
      <span class="s">"Usage:MakeDirectories -d path1 ...\n"</span> <span class="o">+</span>
      <span class="s">"Deletes each path\n"</span> <span class="o">+</span>
      <span class="s">"Usage:MakeDirectories -r path1 path2\n"</span> <span class="o">+</span>
      <span class="s">"Renames from path1 to path2"</span><span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">fileData</span><span class="o">(</span><span class="nc">File</span> <span class="n">f</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span>
      <span class="s">"Absolute path: "</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="na">getAbsolutePath</span><span class="o">()</span> <span class="o">+</span>
      <span class="s">"\n Can read: "</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="na">canRead</span><span class="o">()</span> <span class="o">+</span>
      <span class="s">"\n Can write: "</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="na">canWrite</span><span class="o">()</span> <span class="o">+</span>
      <span class="s">"\n getName: "</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span>
      <span class="s">"\n getParent: "</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="na">getParent</span><span class="o">()</span> <span class="o">+</span>
      <span class="s">"\n getPath: "</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="na">getPath</span><span class="o">()</span> <span class="o">+</span>
      <span class="s">"\n length: "</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">+</span>
      <span class="s">"\n lastModified: "</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="na">lastModified</span><span class="o">());</span><span class="c1">//最后修改时间</span>
    <span class="k">if</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">isFile</span><span class="o">())</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"It's a file"</span><span class="o">);</span>
    <span class="k">else</span> <span class="nf">if</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">())</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"It's a directory"</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="n">usage</span><span class="o">();</span>
    <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="s">"-r"</span><span class="o">))</span> <span class="o">{</span>
      <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">3</span><span class="o">)</span> <span class="n">usage</span><span class="o">();</span>
      <span class="nc">File</span>
        <span class="n">old</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]),</span>
        <span class="n">rname</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">2</span><span class="o">]);</span>
      <span class="n">old</span><span class="o">.</span><span class="na">renameTo</span><span class="o">(</span><span class="n">rname</span><span class="o">);</span><span class="c1">//重命名</span>
      <span class="n">fileData</span><span class="o">(</span><span class="n">old</span><span class="o">);</span>
      <span class="n">fileData</span><span class="o">(</span><span class="n">rname</span><span class="o">);</span>
      <span class="k">return</span><span class="o">;</span> <span class="c1">// Exit main</span>
    <span class="o">}</span>
    <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kt">boolean</span> <span class="n">del</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="s">"-d"</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">count</span><span class="o">++;</span>
      <span class="n">del</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="n">count</span><span class="o">--;</span>
    <span class="k">while</span><span class="o">(++</span><span class="n">count</span> <span class="o">&lt;</span> <span class="n">args</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">File</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="n">count</span><span class="o">]);</span>
      <span class="k">if</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">f</span> <span class="o">+</span> <span class="s">" exists"</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">del</span><span class="o">)</span> <span class="o">{</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"deleting..."</span> <span class="o">+</span> <span class="n">f</span><span class="o">);</span>
          <span class="n">f</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">else</span> <span class="o">{</span> <span class="c1">// Doesn't exist</span>
        <span class="k">if</span><span class="o">(!</span><span class="n">del</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">f</span><span class="o">.</span><span class="na">mkdirs</span><span class="o">();</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"created "</span> <span class="o">+</span> <span class="n">f</span><span class="o">);</span>
        <span class="o">}</span>
      <span class="o">}</span>
      <span class="n">fileData</span><span class="o">(</span><span class="n">f</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output: (80% match)
created MakeDirectoriesTest
Absolute path: d:\aaa-TIJ4\code\io\MakeDirectoriesTest
 Can read: true
 Can write: true
 getName: MakeDirectoriesTest
 getParent: null
 getPath: MakeDirectoriesTest
 length: 0
 lastModified: 1101690308831
It's a directory
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h2 id="2输入输出">2.输入输出</h2><h3 id="21-inputstream类型">2.1 InputStream类型</h3><h3 id="22-outputstream类型">2.2 OutputStream类型</h3><h2 id="3添加属性和有用的接口">3.添加属性和有用的接口</h2><h3 id="31-通过filterinputstream从inputstream读取数据">3.1 通过FilterInputStream从InputStream读取数据</h3><h3 id="32-通过filteroutputstream向outputstream写入">3.2 通过FilterOutputStream向OutputStream写入</h3><h2 id="4reader和writer">4.Reader和Writer</h2><h3 id="41-数据的来源和去处">4.1 数据的来源和去处</h3><h3 id="42-更改流的行为">4.2 更改流的行为</h3><h3 id="43-未发生变化的类">4.3 未发生变化的类</h3><h2 id="5自我独立的类randomaccessfile">5.自我独立的类：RandomAccessFile</h2><h2 id="6io流的典型使用方式">6.I/O流的典型使用方式</h2><h3 id="61-缓冲输入文件">6.1 缓冲输入文件</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BufferedInputFile</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">read</span><span class="o">(</span><span class="nc">String</span> <span class="n">fileName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span><span class="o">{</span>
        <span class="nc">BufferedReader</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">FileReader</span><span class="o">(</span><span class="n">fileName</span><span class="o">));</span>
        <span class="nc">String</span> <span class="n">s</span><span class="o">;</span>
        <span class="nc">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">((</span><span class="n">s</span><span class="o">=</span><span class="n">in</span><span class="o">.</span><span class="na">readLine</span><span class="o">())!=</span><span class="kc">null</span><span class="o">){</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">s</span><span class="o">+</span><span class="s">"\n"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">read</span><span class="o">(</span><span class="s">"src/main/java/BufferedInputFile.java"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="62-从内存输入">6.2 从内存输入</h3><h3 id="63-格式化的内存输入">6.3 格式化的内存输入</h3><h3 id="64-基本的文件输出">6.4 基本的文件输出</h3><h3 id="65-存储和恢复数据">6.5 存储和恢复数据</h3><h3 id="66-读写随机访问文件">6.6 读写随机访问文件</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="c1">//: io/UsingRandomAccessFile.java</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UsingRandomAccessFile</span> <span class="o">{</span>
  <span class="kd">static</span> <span class="nc">String</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"rtest.dat"</span><span class="o">;</span>
  <span class="kd">static</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="nc">RandomAccessFile</span> <span class="n">rf</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomAccessFile</span><span class="o">(</span><span class="n">file</span><span class="o">,</span> <span class="s">"r"</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span>
        <span class="s">"Value "</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="n">rf</span><span class="o">.</span><span class="na">readDouble</span><span class="o">());</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rf</span><span class="o">.</span><span class="na">readUTF</span><span class="o">());</span>
    <span class="n">rf</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="nc">RandomAccessFile</span> <span class="n">rf</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomAccessFile</span><span class="o">(</span><span class="n">file</span><span class="o">,</span> <span class="s">"rw"</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="n">rf</span><span class="o">.</span><span class="na">writeDouble</span><span class="o">(</span><span class="n">i</span><span class="o">*</span><span class="mf">1.414</span><span class="o">);</span>
    <span class="n">rf</span><span class="o">.</span><span class="na">writeUTF</span><span class="o">(</span><span class="s">"The end of the file"</span><span class="o">);</span>
    <span class="n">rf</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="n">display</span><span class="o">();</span>
    <span class="n">rf</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomAccessFile</span><span class="o">(</span><span class="n">file</span><span class="o">,</span> <span class="s">"rw"</span><span class="o">);</span>
    <span class="n">rf</span><span class="o">.</span><span class="na">seek</span><span class="o">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">8</span><span class="o">);</span>
    <span class="n">rf</span><span class="o">.</span><span class="na">writeDouble</span><span class="o">(</span><span class="mf">47.0001</span><span class="o">);</span>
    <span class="n">rf</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="n">display</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
Value 0: 0.0
Value 1: 1.414
Value 2: 2.828
Value 3: 4.242
Value 4: 5.656
Value 5: 7.069999999999999
Value 6: 8.484
The end of the file
Value 0: 0.0
Value 1: 1.414
Value 2: 2.828
Value 3: 4.242
Value 4: 5.656
Value 5: 47.0001
Value 6: 8.484
The end of the file
*/</span><span class="c1">//:~</span>
</pre></table></code></div></div><h3 id="67-管道流">6.7 管道流</h3><h2 id="7文件读写的实用工具">7.文件读写的实用工具</h2><h3 id="71-读取二进制文件">7.1 读取二进制文件</h3><h2 id="8标准io">8.标准I/O</h2><h3 id="81-从标准输入中读取">8.1 从标准输入中读取</h3><h3 id="82-将systemout转换为printwriter">8.2 将System.out转换为PrintWriter</h3><h3 id="83-标准io重定向">8.3 标准I/O重定向</h3><h2 id="9进程控制">9.进程控制</h2><h2 id="10新io">10.新I/O</h2><h3 id="101-转换数据">10.1 转换数据</h3><h3 id="102-获取基本类型">10.2 获取基本类型</h3><h3 id="103-视图缓冲器">10.3 视图缓冲器</h3><h3 id="104-用缓冲器操纵数据">10.4 用缓冲器操纵数据</h3><h3 id="105-缓冲器的细节">10.5 缓冲器的细节</h3><h3 id="106-内存映射文件">10.6 内存映射文件</h3><h3 id="107-文件加锁">10.7 文件加锁</h3><h2 id="11压缩">11.压缩</h2><h3 id="111-用gzip进行简单压缩">11.1 用GZIP进行简单压缩</h3><h3 id="112-用zip进行多文件保存">11.2 用Zip进行多文件保存</h3><h3 id="113-java档案文件">11.3 Java档案文件</h3><h2 id="12对象序列化">12.对象序列化</h2><h3 id="121-寻找类">12.1 寻找类</h3><h3 id="122-序列化的控制">12.2 序列化的控制</h3><h3 id="123-使用持久性">12.3 使用“持久性”</h3><h2 id="13xml">13.XML</h2><h2 id="14preference">14.Preference</h2></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/thinking-in-java/" class="post-tag no-text-decoration" >Thinking in Java</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=《Java编程思想》第18章I/O系统 - malinkang&url=https://malinkang.cn/posts/thinking-in-java-i-o/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=《Java编程思想》第18章I/O系统 - malinkang&u=https://malinkang.cn/posts/thinking-in-java-i-o/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=《Java编程思想》第18章I/O系统 - malinkang&url=https://malinkang.cn/posts/thinking-in-java-i-o/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/dagger-guide/">Dagger使用指南</a><li><a href="/posts/understanding-the-jvm-runtime-data-areas/">《深入理解JVM》第2章Java内存区域与内存溢出异常</a><li><a href="/posts/understanding-the-jvm-garbage-collection/">《深入理解JVM》第3章垃圾收集器</a><li><a href="/posts/understanding-the-jvm-class-file-structure/">《深入理解JVM》第6章类文件结构</a><li><a href="/posts/understanding-the-jvm-class-loader/">《深入理解JVM》第7章虚拟机类加载机制</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/thinking-in-java/">Thinking in Java</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">Java并发编程实战</a> <a class="post-tag" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3jvm/">深入理解JVM</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/databinding/">databinding</a> <a class="post-tag" href="/tags/recyclerview/">RecyclerView</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/thinking-in-java-everything-is-an-object/"><div class="card-body"> <span class="timeago small" > Mar 20, 2013 <i class="unloaded">2013-03-20T00:26:34+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《Java编程思想》第2章一切都是对象</h3><div class="text-muted small"><p> 2.2 必须由你创建所有对象 2.2.1 存储到什么地方 2.2.2 特例：基本类型 在程序设计中经常用到一系列类型，它们需要特殊对待。可以把它们想象成“基本”类型。之所以特殊对待，是因为new将对象存储在“堆”里，故用new创建一个对象，特别是小的、简单的变量，往往不是很有效。因此，对于这些类型，Java采取与C和C++相同的方法。也就是说，不用new来创建变量，而是创建一个并非是引...</p></div></div></a></div><div class="card"> <a href="/posts/thinking-in-java-operators/"><div class="card-body"> <span class="timeago small" > Mar 26, 2013 <i class="unloaded">2013-03-26T21:39:36+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《Java编程思想》第3章操作符</h3><div class="text-muted small"><p></p></div></div></a></div><div class="card"> <a href="/posts/thinking-in-java-controlling-execution/"><div class="card-body"> <span class="timeago small" > Apr 2, 2013 <i class="unloaded">2013-04-02T21:39:36+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《Java编程思想》第4章控制流程</h3><div class="text-muted small"><p></p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/thinking-in-java-containers-in-depth/" class="btn btn-outline-primary" prompt="Older"><p>《Java编程思想》第17章容器深入研究</p></a> <a href="/posts/thinking-in-java-enumerated-types/" class="btn btn-outline-primary" prompt="Newer"><p>《Java编程思想》第19章枚举类型</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//malinkang-cn.disqus.com/embed.js', disqusConfig: function() { this.page.title = '《Java编程思想》第18章I/O系统'; this.page.url = 'https://malinkang.cn/posts/thinking-in-java-i-o/'; this.page.identifier = '/posts/thinking-in-java-i-o/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/malinkang">malinkang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/thinking-in-java/">Thinking in Java</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">Java并发编程实战</a> <a class="post-tag" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3jvm/">深入理解JVM</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/databinding/">databinding</a> <a class="post-tag" href="/tags/recyclerview/">RecyclerView</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://malinkang.cn{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
