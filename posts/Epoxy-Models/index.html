<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Epoxy Models" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="概览（Overview）" /><meta property="og:description" content="概览（Overview）" /><link rel="canonical" href="https://malinkang.cn/posts/Epoxy-Models/" /><meta property="og:url" content="https://malinkang.cn/posts/Epoxy-Models/" /><meta property="og:site_name" content="malinkang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-01-05T23:52:23+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Epoxy Models" /><meta name="twitter:site" content="@malinkang" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"概览（Overview）","headline":"Epoxy Models","dateModified":"2020-01-05T23:52:23+08:00","url":"https://malinkang.cn/posts/Epoxy-Models/","datePublished":"2020-01-05T23:52:23+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://malinkang.cn/posts/Epoxy-Models/"},"@context":"https://schema.org"}</script><title>Epoxy Models | malinkang</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="malinkang"><meta name="application-name" content="malinkang"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/images/avatar.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">malinkang</a></div><div class="site-subtitle font-italic">人生最可悲的事情，莫过于胸怀大志，却又虚度光阴。</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/malinkang" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/malinkang" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['linkang.ma','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Epoxy Models</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Epoxy Models</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> malinkang </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 5, 2020, 11:52 PM +0800" prep="on" > Jan 5, 2020 <i class="unloaded">2020-01-05T23:52:23+08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2882 words">16 min</span></div></div><div class="post-content"><h2 id="概览overview">概览（Overview）</h2><blockquote><p>Epoxy uses EpoxyModel objects to decide which views to display and how to bind data to them. This is similar to the popular ViewModel pattern. Models also allow you to control other aspects of the view, such as the grid span size, id, and saved state.</p></blockquote><p><code class="language-plaintext highlighter-rouge">Epoxy</code>使用<code class="language-plaintext highlighter-rouge">EpoxyModel</code>对象来确定要显示的<code class="language-plaintext highlighter-rouge">view</code>以及如何为这些<code class="language-plaintext highlighter-rouge">view</code>绑定数据。这类似于流行的<code class="language-plaintext highlighter-rouge">ViewModel</code>模式。<code class="language-plaintext highlighter-rouge">Models</code>也允许控制<code class="language-plaintext highlighter-rouge">view</code>的其他方面，例如网格范围大小，id和保存状态。</p><h2 id="创建modelcreating-models">创建Model（Creating Models）</h2><blockquote><p>There are several ways to have Epoxy generate your model classes.</p></blockquote><p>有多种方法可以使<code class="language-plaintext highlighter-rouge">Epoxy</code>生成<code class="language-plaintext highlighter-rouge">Model</code>类。</p><ul><li><a href="">Annotate custom views</a><li><a href="">Use Android databinding</a><li><a href="">Use the view holder pattern</a></ul><blockquote><p>Generated model classes are suffixed with _ to indicate that they are generated.</p></blockquote><p>生成的<code class="language-plaintext highlighter-rouge">model</code>类后缀带<code class="language-plaintext highlighter-rouge">_</code>表示已生成。</p><h2 id="model-ids">Model IDs</h2><blockquote><p>The RecyclerView concept of stable ideas is built into Epoxy, meaning each EpoxyModel should have a unique id to identify it. This allows diffing and saved state.</p></blockquote><p><code class="language-plaintext highlighter-rouge">Epoxy</code>中内置了<code class="language-plaintext highlighter-rouge">RecyclerView</code>稳定想法的概念，这意味着每个<code class="language-plaintext highlighter-rouge">EpoxyModel</code>应该有一个唯一的id来识别它。这允许差异和保存状态。</p><blockquote><p>Models are assigned ids via the EpoxyModel#id(long) method. This id value would generally come from a database entry, such as the id of a user.</p></blockquote><p><code class="language-plaintext highlighter-rouge">Model</code>通过<code class="language-plaintext highlighter-rouge">EpoxyModel</code>的<code class="language-plaintext highlighter-rouge">id(long)</code>方法分配id。这个id值一般来自数据库条目，如用户的id。</p><blockquote><p>However, there are many cases where an EpoxyModel is not backed by a database object and doesn’t have a clearly assignable id. In these cases you may use a string as a model’s id.</p></blockquote><p>然而，在许多情况下，<code class="language-plaintext highlighter-rouge">EpoxyModel</code>没有数据库对象的支持，也没有一个明确的可分配的id。在这些情况下，您可以使用一个字符串作为<code class="language-plaintext highlighter-rouge">Model</code>的id。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">model</span><span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="s">"header"</span><span class="o">)</span>
</pre></table></code></div></div><blockquote><p>Alternatively, if you have EpoxyModel’s represented by object’s from different database tables there is a risk of colliding ids. If that is a concern you may use a string to namespace the id.</p></blockquote><p>另外，如果您的EpoxyModel是由不同数据库表中的对象来表示的，那么就有可能发生id冲突。如果这是一个问题，你可以使用一个字符串来命名空间的ID。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">model</span><span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="s">"photo"</span><span class="o">,</span> <span class="n">photoId</span><span class="o">)</span>
<span class="n">model</span><span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="s">"video"</span><span class="o">,</span> <span class="n">videoId</span><span class="o">)</span>
</pre></table></code></div></div><blockquote><p>There are other overloads of id that accept multiple numbers or strings to help you create custom ids as needed. These alternative options are hashed into a 64 bit long to create an id for you. The downside to this approach is that, since the id is computed via a hash, there is the chance for id collisions which will cause an error. However, since a 64 bit hash is used the chance of a collision is extremely small. Assuming an even spread of hashcodes, and several hundred models in the adapter, there would be roughly 1 in 100 trillion chance of a collision. To protected against collisions, EpoxyController supports fallback behavior when duplicates are detected.</p></blockquote><p>id还有其他的重载，可以接受多个数字或字符串，帮助你根据需要创建自定义的id。这些替代选项会被哈希成一个64位的长来为你创建一个id。这种方法的缺点是，由于id是通过哈希计算的，所以有可能出现id碰撞，从而导致错误。然而，由于使用的是64位哈希，所以发生碰撞的几率非常小。假设哈希码的均匀分布，以及适配器中的几百个模型，碰撞的几率大约为100万亿分之一。为了防止碰撞，EpoxyController支持当检测到重复时的回退行为。</p><h3 id="automatic-ids-in-epoxycontroller">Automatic IDs in EpoxyController</h3><blockquote><p>For models that represent static content (such as a header or loader) you can use the AutoModel annotation with the EpoxyController to automatically generate a unique id for you.</p></blockquote><p>对于表示静态内容的模型（如头或加载器），您可以使用EpoxyController的AutoModel注解为您自动生成一个唯一的id。</p><h2 id="model-properties">Model Properties</h2><blockquote><p>Each model holds data that it eventually binds to a view. This data is represented by properties:</p></blockquote><p>每个模型都拥有数据，并最终与视图绑定。这些数据由属性来表示。</p><blockquote><ul><li>In custom views a property is declared with a @ModelProp annotation on a setter.<li>In databinding layouts each variable represents a model property.<li>In view holders the @EpoxyAttribute field annotation declares a property.</ul></blockquote><ul><li>在自定义视图中，一个属性是用一个<code class="language-plaintext highlighter-rouge">@ModelProp</code>注解在<code class="language-plaintext highlighter-rouge">setter</code>上声明的。<li>在数据绑定布局中，每个变量代表一个模型属性。<li>在视图持有者中，<code class="language-plaintext highlighter-rouge">@EpoxyAttribute</code>字段注解声明了一个属性。</ul><blockquote><p>Every property must be a type that implements equals and hashcode. These implementations must correctly identify when the property value changes. Epoxy relies on this for diffing. Your properties may not be updated on the view if Epoxy doesn’t know they have changed. The exception to this is callbacks, such as click listeners, which you should generally apply the DoNotHash option to.</p></blockquote><p>每个属性必须是实现<code class="language-plaintext highlighter-rouge">equals</code>和<code class="language-plaintext highlighter-rouge">hashcode</code>的类型。这些实现必须正确识别属性值的变化。Epoxy依靠这一点来实现差异化。如果Epoxy不知道你的属性发生了变化，你的属性可能不会在视图上更新。例外的情况是回调，比如点击监听器，你一般应该应用<code class="language-plaintext highlighter-rouge">DoNotHash</code>选项。</p><blockquote><p>On the generated EpoxyModels each property has a setter and getter; when you create a new model you build it by setting the value for each property.</p></blockquote><p>在生成的<code class="language-plaintext highlighter-rouge">EpoxyModels</code>上，每个属性都有一个<code class="language-plaintext highlighter-rouge">setter</code>和<code class="language-plaintext highlighter-rouge">getter</code>；当你创建一个新的模型时，你通过设置每个属性的值来建立它。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">new</span> <span class="n">MyModel_</span><span class="o">()</span>
       <span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
       <span class="o">.</span><span class="na">title</span><span class="o">(</span><span class="s">"title"</span><span class="o">)</span>
</pre></table></code></div></div><blockquote><p>Id is a required property for every model.</p></blockquote><p>Id是每一个模型的必备属性。</p><h2 id="model-state">Model State</h2><blockquote><p>A model’s state is determined by its equals and hashCode implementations, which is based on the value of all of the model’s properties.</p></blockquote><p>一个模型的状态是由它的equals和hashCode实现的，它是基于模型的所有属性的值来决定的。</p><blockquote><p>This state is used in diffing to determine when a model has changed so Epoxy can update the view.</p></blockquote><p>这个状态在diffing中用来判断一个模型何时发生了变化，以便Epoxy可以更新视图。</p><blockquote><p>These methods are generated so you don’t have to created them manually.</p></blockquote><p>这些方法是生成的，所以你不必手动创建它们。</p><h2 id="creating-views">Creating Views</h2><blockquote><p>Each model is typed with the View that it supports. The model implements buildView to create a new instance of that view type. Additionally, getViewType returns an int representing that view type for use in view recycling.</p></blockquote><p>每个模型都有它所支持的视图类型。模型实现 buildView 来创建该视图类型的新实例。此外，getViewType 返回一个代表该视图类型的 int，用于视图回收。</p><blockquote><p>When Epoxy receives the calls RecyclerView.Adapter#getItemViewType and RecyclerView.Adapter#onCreateViewHolder it delegates to these methods on the model.</p></blockquote><p>当Epoxy接收到RecyclerView.Adapter#getItemViewType和RecyclerView.Adapter#onCreateViewHolder的调用时，它会将这些方法委托给模型。</p><blockquote><p>These methods are generated for you unless you are creating models manually.</p></blockquote><p>这些方法是为您生成的，除非您是手动创建模型。</p><h2 id="binding-views">Binding Views</h2><blockquote><p>When RecyclerView.Adapter#onBindViewHolder is called, Epoxy delegates to the model at the requested position with EpoxyModel#bind(View). This is the model’s chance to populate the view with the properties in the model.</p></blockquote><p>当RecyclerView.Adapter#onBindViewHolder被调用时，Epoxy会在请求的位置用EpoxyModel#bind(View)委托给模型。这是模型用模型中的属性填充视图的机会。</p><blockquote><p>Similarly, Epoxy delegates RecyclerView.Adapter#onViewRecycled to EpoxyModel#unbind(View), giving the model a chance to release any resources associated with the view. This is a good opportunity to clear the view of large or expensive data such as bitmaps.</p></blockquote><p>类似地，Epoxy将RecyclerView.Adapter#onViewRecycled委托给EpoxyModel#unbind(View)，让模型有机会释放与视图相关的任何资源。这是一个很好的机会来清除视图中的大型或昂贵的数据，如位图。</p><blockquote><p>Since RecyclerView reuses views when possible, a view may be bound multiple times, without unbind necessarily being called in between. You should make sure that your usage of EpoxyModel#bind(View) completely updates the view according to the data in your model.</p></blockquote><p>由于RecyclerView在可能的情况下会重用视图，所以一个视图可能会被多次绑定，中间不一定会被调用unbind。你应该确保EpoxyModel#bind(View)的用法会根据模型中的数据完全更新视图。</p><blockquote><p>Generated models have an onBind method added to them, which you can use to register a callback for when the model is bound to a view.</p></blockquote><p>生成的模型有一个onBind方法，您可以用它来注册一个回调，当模型绑定到视图时，就可以使用这个方法。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">model</span><span class="o">.</span><span class="na">onBind</span><span class="o">((</span><span class="n">model</span><span class="o">,</span> <span class="n">view</span><span class="o">,</span> <span class="n">position</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="c1">// Do something!);</span>
</pre></table></code></div></div><blockquote><p>Similarly, onUnbind can be used for an unbind callback.</p></blockquote><p>同样，onUnbind也可用于解除绑定的回调。</p><blockquote><p>These are useful if you need to take action when a view enters or leaves the screen.</p></blockquote><p>如果您需要在视图进入或离开屏幕时进行操作，这些都很有用。</p><h2 id="view-updates">View Updates</h2><blockquote><p>When a model’s state changes, and the model is bound to a view on screen, Epoxy rebinds the view with only the properties that changed. This partial rebind is more efficient than rebinding the whole view.</p></blockquote><p>当模型的状态发生变化，并且模型被绑定到屏幕上的视图上时，Epoxy仅用变化的属性重新绑定该视图，这种部分重新绑定比重新绑定整个视图更有效。这种部分重新绑定比重新绑定整个视图更有效。</p><blockquote><p>If you are using models generated from custom views or databinding, then the partial rebind is done automatically for you.</p></blockquote><p>如果你使用从自定义视图或数据绑定生成的模型，那么部分重新绑定将自动为你完成。</p><blockquote><p>If you are using manually created models you can implement EpoxyModel#bind(T view, EpoxyModel&lt;?&gt; previouslyBoundModel) to check which properties changed and update the view as needed.</p></blockquote><p>如果你使用的是手动创建的模型，你可以实现EpoxyModel#bind(T view, EpoxyModel&lt;?&gt; previouslyBoundModel)来检查哪些属性改变了，并根据需要更新视图。</p><blockquote><p>Note: This only works with EpoxyController, not the legacy EpoxyAdapter class.</p></blockquote><p>注意：这只适用于EpoxyController，而不是传统的EpoxyAdapter类。</p><h2 id="click-listeners">Click Listeners</h2><blockquote><p>If a model has a property of type View.OnClickListener then the generated model will include an additional, overloaded method for setting that click listener. The overloaded method will take a OnModelClickListener parameter.</p></blockquote><p>如果一个模型有一个View.OnClickListener类型的属性，那么生成的模型将包含一个额外的、重载的方法来设置该点击监听器。该重载方法将取一个OnModelClickListener参数。</p><blockquote><p>This listener is typed with two parameters: the model’s type and the model’s view type. Implementations must implement void onClick(T model, V parentView, View clickedView, int position). This callback gives you the model whose view was clicked, the top level view (or view holder if you are using EpoxyModelWithHolder), the view that received the clicked, and the position of the model in the adapter.</p></blockquote><p>这个监听器的类型有两个参数：模型的类型和模型的视图类型。实现必须实现void onClick(T model, V parentView, View clickedView, int position)。这个回调会给你提供视图被点击的模型、顶层视图（如果你使用的是EpoxyModelWithHolder，则是视图支架）、收到点击的视图以及模型在适配器中的位置。</p><blockquote><p>You should use the position provided by this listener instead of saving a reference to the model’s position when it was added to the adapter/controller. This is because if the model is moved RecyclerView does an optimization to not rebind the new model since it knows the data did not change. This also means that the model returned by onClick is not necessarily the most recently created model, if the model did not need to be rebound to the view.</p></blockquote><p>你应该使用这个监听器提供的位置，而不是保存模型被添加到适配器/控制器时的位置引用。这是因为如果模型被移动，RecyclerView会做一个优化，不重新绑定新的模型，因为它知道数据没有改变。这也就意味着，如果模型不需要重新绑定到视图，那么onClick返回的模型不一定是最近创建的模型。</p><h2 id="oncheckedchangelistener">OnCheckedChangeListener</h2><blockquote><p>Similarly, if a model has a property of type CompoundButton.OnCheckedChangeListener then an overloaded method will be generated on the model of type OnModelCheckedChangeListener - to provide access to the model and position when the listener is triggered.</p></blockquote><p>同样，如果一个模型有一个类型为CompoundButton.OnCheckedChangeListener的属性，那么将在模型上生成一个类型为<code class="language-plaintext highlighter-rouge">OnModelCheckedChangeListener</code>的重载方法–以在触发监听器时提供对模型和位置的访问。</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >Java</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" class="post-tag no-text-decoration" >读书笔记</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Epoxy Models - malinkang&url=https://malinkang.cn/posts/Epoxy-Models/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Epoxy Models - malinkang&u=https://malinkang.cn/posts/Epoxy-Models/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Epoxy Models - malinkang&url=https://malinkang.cn/posts/Epoxy-Models/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/dagger-guide/">Dagger使用指南</a><li><a href="/posts/understanding-the-jvm-runtime-data-areas/">《深入理解JVM》第2章Java内存区域与内存溢出异常</a><li><a href="/posts/understanding-the-jvm-garbage-collection/">《深入理解JVM》第3章垃圾收集器</a><li><a href="/posts/understanding-the-jvm-class-file-structure/">《深入理解JVM》第6章类文件结构</a><li><a href="/posts/understanding-the-jvm-class-loader/">《深入理解JVM》第7章虚拟机类加载机制</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/thinking-in-java/">Thinking in Java</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">Java并发编程实战</a> <a class="post-tag" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3jvm/">深入理解JVM</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/databinding/">databinding</a> <a class="post-tag" href="/tags/recyclerview/">RecyclerView</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/algorithms-4th-edition-chapter3/"><div class="card-body"> <span class="timeago small" > Mar 1, 2016 <i class="unloaded">2016-03-01T14:33:57+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《算法》读书笔记 第3章 查找</h3><div class="text-muted small"><p> 3.1 符号表 3.1.1 API 3.1.2 有序符号表 3.1.3 用例举例 3.1.4 无序链表中的顺序查找 3.1.5 有序数组中的二分查找 import edu.princeton.cs.algs4.BinarySearch; /** * Created by malk on 2018/12/25. */ public class BinarySearchST&l...</p></div></div></a></div><div class="card"> <a href="/posts/thinking-in-java-holding-your-objects/"><div class="card-body"> <span class="timeago small" > May 21, 2013 <i class="unloaded">2013-05-21T21:39:36+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《Java编程思想》第11章持有对象</h3><div class="text-muted small"><p> 第11章 持有对象 1.泛型和类型安全的容器 Apple和Orange都放置在了容器中，然后将它们取出。正常情况下，Java编译器会报告警告信息，因为这个示例没有使用泛型。在这里，我们使用Java SE5所特有的注解来抑制了警告信息。注解以“@”符号开头，可以接受参数，这里的@SuppressWarnings注解及其参数标识只有有关“不受检查的异常”的警告信息应该被压制。 class ...</p></div></div></a></div><div class="card"> <a href="/posts/java-dynamic-proxy/"><div class="card-body"> <span class="timeago small" > Nov 30, 2014 <i class="unloaded">2014-11-30T01:36:33+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java动态代理</h3><div class="text-muted small"><p> 代理是基本的设计模式之一，它是你为了提供额外的或不同的操作，而插入的用来代替”实际“对象的对象。这些操作通常涉及与“实际”对象的通信，因此代理通常充当着中间人的角色。下面是一个用来展示代理结构的简单示例： interface Interface { void doSomething(); void somethingElse(String arg); } //实现In...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/framework-init/" class="btn btn-outline-primary" prompt="Older"><p>init启动流程分析</p></a> <a href="/posts/framework-zygote/" class="btn btn-outline-primary" prompt="Newer"><p>Zygote进程启动流程</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//malinkang-cn.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Epoxy Models'; this.page.url = 'https://malinkang.cn/posts/Epoxy-Models/'; this.page.identifier = '/posts/Epoxy-Models/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/malinkang">malinkang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/thinking-in-java/">Thinking in Java</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">Java并发编程实战</a> <a class="post-tag" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3jvm/">深入理解JVM</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/databinding/">databinding</a> <a class="post-tag" href="/tags/recyclerview/">RecyclerView</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://malinkang.cn{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
