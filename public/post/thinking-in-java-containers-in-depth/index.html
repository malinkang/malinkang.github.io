<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>《Java编程思想》第17章容器深入研究 - 人生最可悲的事情，莫过于胸怀大志，却又虚度光阴。</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="malinkang" /><meta name="description" content="1.完整的容器分类法 2.填充容器 与Arrays版本一样，此fill()方法也是只复制同一个对象引用来填充整个容器的，并且只对List对象有用" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.80.0 with theme even" />


<link rel="canonical" href="https://malinkang.cn/post/thinking-in-java-containers-in-depth/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.c12ac5d6e912b28ec1fcd71d47773cc8112a03296d4ff03660135b54f0923299.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="《Java编程思想》第17章容器深入研究" />
<meta property="og:description" content="1.完整的容器分类法 2.填充容器 与Arrays版本一样，此fill()方法也是只复制同一个对象引用来填充整个容器的，并且只对List对象有用" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://malinkang.cn/post/thinking-in-java-containers-in-depth/" />
<meta property="article:published_time" content="2013-07-02T13:39:36+00:00" />
<meta property="article:modified_time" content="2013-07-02T13:39:36+00:00" />
<meta itemprop="name" content="《Java编程思想》第17章容器深入研究">
<meta itemprop="description" content="1.完整的容器分类法 2.填充容器 与Arrays版本一样，此fill()方法也是只复制同一个对象引用来填充整个容器的，并且只对List对象有用">
<meta itemprop="datePublished" content="2013-07-02T13:39:36+00:00" />
<meta itemprop="dateModified" content="2013-07-02T13:39:36+00:00" />
<meta itemprop="wordCount" content="11433">



<meta itemprop="keywords" content="Thinking in Java," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="《Java编程思想》第17章容器深入研究"/>
<meta name="twitter:description" content="1.完整的容器分类法 2.填充容器 与Arrays版本一样，此fill()方法也是只复制同一个对象引用来填充整个容器的，并且只对List对象有用"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Malinkang&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Malinkang&#39;s Blog</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">《Java编程思想》第17章容器深入研究</h1>

      <div class="post-meta">
        <span class="post-time"> 2013-07-02 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#1完整的容器分类法">1.完整的容器分类法</a></li>
    <li><a href="#2填充容器">2.填充容器</a>
      <ul>
        <li><a href="#21-一种generator解决方案">2.1 一种Generator解决方案</a></li>
        <li><a href="#22-map生成器">2.2 Map生成器</a></li>
        <li><a href="#23-使用abstract类">2.3 使用Abstract类</a></li>
      </ul>
    </li>
    <li><a href="#3collection的功能方法">3.Collection的功能方法</a></li>
    <li><a href="#4可选操作">4.可选操作</a></li>
    <li><a href="#5list的功能方法">5.List的功能方法</a></li>
    <li><a href="#6set和存储顺序">6.Set和存储顺序</a>
      <ul>
        <li><a href="#61-sortedset">6.1 SortedSet</a></li>
      </ul>
    </li>
    <li><a href="#7队列">7.队列</a>
      <ul>
        <li><a href="#71-优先级队列">7.1 优先级队列</a></li>
        <li><a href="#72双向队列">7.2双向队列</a></li>
      </ul>
    </li>
    <li><a href="#8map">8.Map</a>
      <ul>
        <li><a href="#81-性能">8.1 性能</a></li>
        <li><a href="#82-sortedmap">8.2 SortedMap</a></li>
        <li><a href="#83-linkedhashmap">8.3 LinkedHashMap</a></li>
      </ul>
    </li>
    <li><a href="#9散列和散列码">9.散列和散列码</a>
      <ul>
        <li><a href="#91-理解hashcode">9.1 理解hashCode()</a></li>
        <li><a href="#92-为速度而散列">9.2 为速度而散列</a></li>
        <li><a href="#93-覆盖hashcode">9.3 覆盖hashCode()</a></li>
      </ul>
    </li>
    <li><a href="#10选择接口的不同实现">10.选择接口的不同实现</a>
      <ul>
        <li><a href="#101-性能测试框架">10.1 性能测试框架</a></li>
        <li><a href="#102-对list的选择">10.2 对List的选择</a></li>
        <li><a href="#103-微基准测试的危险">10.3 微基准测试的危险</a></li>
        <li><a href="#104-对set的选择">10.4 对Set的选择</a></li>
        <li><a href="#105-对map的选择">10.5 对Map的选择</a></li>
      </ul>
    </li>
    <li><a href="#11实用方法">11.实用方法</a>
      <ul>
        <li><a href="#111-list的排序和查询">11.1 List的排序和查询</a></li>
        <li><a href="#112-设定collection或map为不可修改">11.2 设定Collection或Map为不可修改</a></li>
        <li><a href="#113-collection或map的同步控制">11.3 Collection或Map的同步控制</a></li>
      </ul>
    </li>
    <li><a href="#12持有引用">12.持有引用</a>
      <ul>
        <li><a href="#121-weakhashmap">12.1 WeakHashMap</a></li>
      </ul>
    </li>
    <li><a href="#13java1011的容器">13.Java1.0/1.1的容器</a>
      <ul>
        <li><a href="#132-hashtable">13.2 Hashtable</a></li>
        <li><a href="#133-stack">13.3 Stack</a></li>
        <li><a href="#134-bitset">13.4 BitSet</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="1完整的容器分类法">1.完整的容器分类法</h2>
<p><img src="https://i.imgur.com/OqAEdC5.png" alt="Imgur"></p>
<h2 id="2填充容器">2.填充容器</h2>
<p>与<code>Arrays</code>版本一样，此<code>fill()</code>方法也是只复制同一个对象引用来填充整个容器的，并且只对<code>List</code>对象有用，但是所产生的列表可以传递给构造器或<code>addAll()</code>方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/FillingLists.java
</span><span class="c1">// The Collections.fill() &amp; Collections.nCopies() methods.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">StringAddress</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">s</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">StringAddress</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="n">s</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FillingLists</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">StringAddress</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">StringAddress</span><span class="o">&gt;(</span>
      <span class="n">Collections</span><span class="o">.</span><span class="na">nCopies</span><span class="o">(</span><span class="n">4</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringAddress</span><span class="o">(</span><span class="s">&#34;Hello&#34;</span><span class="o">)));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
    <span class="n">Collections</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringAddress</span><span class="o">(</span><span class="s">&#34;World!&#34;</span><span class="o">));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output: (Sample)
</span><span class="cm">[StringAddress@82ba41 Hello, StringAddress@82ba41 Hello, StringAddress@82ba41 Hello, StringAddress@82ba41 Hello]
</span><span class="cm">[StringAddress@923e30 World!, StringAddress@923e30 World!, StringAddress@923e30 World!, StringAddress@923e30 World!]
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><p>这个示例展示了两种用对单个对象的引用来填充<code>Collection</code>的方式，第一种是使用<code>Collection.nCopies()</code>创建传递给构造器的<code>List</code>，这里填充的是<code>ArrayList</code>。第二种使用的<code>fill()</code>方法的用处更有限，因为它只能替换已经在<code>List</code>中存在的元素，而不能添加新的元素。</p>
<h3 id="21-一种generator解决方案">2.1 一种Generator解决方案</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: net/mindview/util/CollectionData.java
</span><span class="c1">// A Collection filled with data using a generator object.
</span><span class="c1"></span><span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CollectionData</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">CollectionData</span><span class="o">(</span><span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">gen</span><span class="o">,</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">quantity</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="n">add</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
  <span class="o">}</span>
  <span class="c1">// A generic convenience method:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">CollectionData</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">list</span><span class="o">(</span><span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">gen</span><span class="o">,</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">CollectionData</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;(</span><span class="n">gen</span><span class="o">,</span> <span class="n">quantity</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~
</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/CollectionDataTest.java
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Government</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">foundation</span> <span class="o">=</span> <span class="o">(</span><span class="s">&#34;strange women lying in ponds &#34;</span> <span class="o">+</span>
    <span class="s">&#34;distributing swords is no basis for a system of &#34;</span> <span class="o">+</span>
    <span class="s">&#34;government&#34;</span><span class="o">).</span><span class="na">split</span><span class="o">(</span><span class="s">&#34; &#34;</span><span class="o">);</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span><span class="o">;</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">foundation</span><span class="o">[</span><span class="n">index</span><span class="o">++];</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CollectionDataTest</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">set</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span>
      <span class="k">new</span> <span class="n">CollectionData</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Government</span><span class="o">(),</span> <span class="n">15</span><span class="o">));</span>
    <span class="c1">// Using the convenience method:
</span><span class="c1"></span>    <span class="n">set</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">CollectionData</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="k">new</span> <span class="n">Government</span><span class="o">(),</span> <span class="n">15</span><span class="o">));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">set</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">[strange, women, lying, in, ponds, distributing, swords, is, no, basis, for, a, system, of, government]
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><p>这些元素的顺序与它们的插入顺序相同，因为<code>LinkedHashSet</code>维护的是保持了插入顺序的链接列表。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/CollectionDataTest.java
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Government</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="n">String</span><span class="o">[]</span> <span class="n">foundation</span> <span class="o">=</span> <span class="o">(</span><span class="s">&#34;strange women lying in ponds &#34;</span> <span class="o">+</span>
    <span class="s">&#34;distributing swords is no basis for a system of &#34;</span> <span class="o">+</span>
    <span class="s">&#34;government&#34;</span><span class="o">).</span><span class="na">split</span><span class="o">(</span><span class="s">&#34; &#34;</span><span class="o">);</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span><span class="o">;</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">foundation</span><span class="o">[</span><span class="n">index</span><span class="o">++];</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CollectionDataTest</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">set</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span>
      <span class="k">new</span> <span class="n">CollectionData</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Government</span><span class="o">(),</span> <span class="n">15</span><span class="o">));</span>
    <span class="c1">// Using the convenience method:
</span><span class="c1"></span>    <span class="n">set</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">CollectionData</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="k">new</span> <span class="n">Government</span><span class="o">(),</span> <span class="n">15</span><span class="o">));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">set</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">[strange, women, lying, in, ponds, distributing, swords, is, no, basis, for, a, system, of, government]
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/CollectionDataGeneration.java
</span><span class="c1">// Using the Generators defined in the Arrays chapter.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CollectionDataGeneration</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span>
      <span class="n">CollectionData</span><span class="o">.</span><span class="na">list</span><span class="o">(</span> <span class="c1">// Convenience method
</span><span class="c1"></span>        <span class="k">new</span> <span class="n">RandomGenerator</span><span class="o">.</span><span class="na">String</span><span class="o">(</span><span class="n">9</span><span class="o">),</span> <span class="n">10</span><span class="o">)));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span>
      <span class="k">new</span> <span class="n">CollectionData</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span>
        <span class="k">new</span> <span class="n">RandomGenerator</span><span class="o">.</span><span class="na">Integer</span><span class="o">(),</span> <span class="n">10</span><span class="o">)));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">[YNzbrnyGc, FOWZnTcQr, GseGZMmJM, RoEsuEcUO, neOEdLsmw, HLGEahKcx, rEqUCBbkI, naMesbtWH, kjUrUkZPg, wsqPzDyCy]
</span><span class="cm">[573, 4779, 871, 4367, 6090, 7882, 2017, 8037, 3455, 299]
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h3 id="22-map生成器">2.2 Map生成器</h3>
<p>定义第一个<code>Pair</code>类。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: net/mindview/util/Pair.java
</span><span class="c1"></span><span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">final</span> <span class="n">K</span> <span class="n">key</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kd">final</span> <span class="n">V</span> <span class="n">value</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">Pair</span><span class="o">(</span><span class="n">K</span> <span class="n">k</span><span class="o">,</span> <span class="n">V</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">k</span><span class="o">;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">v</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~
</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: net/mindview/util/MapData.java
</span><span class="c1">// A Map filled with data using a generator object.
</span><span class="c1"></span><span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="c1">// A single Pair Generator:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="nf">MapData</span><span class="o">(</span><span class="n">Generator</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="n">gen</span><span class="o">,</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">quantity</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
      <span class="n">put</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">key</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">value</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="c1">// Two separate Generators:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="nf">MapData</span><span class="o">(</span><span class="n">Generator</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">genK</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">genV</span><span class="o">,</span><span class="kt">int</span> <span class="n">quantity</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">quantity</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">put</span><span class="o">(</span><span class="n">genK</span><span class="o">.</span><span class="na">next</span><span class="o">(),</span> <span class="n">genV</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="c1">// A key Generator and a single value:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="nf">MapData</span><span class="o">(</span><span class="n">Generator</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">genK</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">,</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">){</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">quantity</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">put</span><span class="o">(</span><span class="n">genK</span><span class="o">.</span><span class="na">next</span><span class="o">(),</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="c1">// An Iterable and a value Generator:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="nf">MapData</span><span class="o">(</span><span class="n">Iterable</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">genK</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">genV</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span> <span class="o">:</span> <span class="n">genK</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">genV</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="c1">// An Iterable and a single value:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="nf">MapData</span><span class="o">(</span><span class="n">Iterable</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">genK</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span> <span class="o">:</span> <span class="n">genK</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="c1">// Generic convenience methods:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="n">Generator</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="n">gen</span><span class="o">,</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;(</span><span class="n">gen</span><span class="o">,</span> <span class="n">quantity</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="n">Generator</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">genK</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">genV</span><span class="o">,</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;(</span><span class="n">genK</span><span class="o">,</span> <span class="n">genV</span><span class="o">,</span> <span class="n">quantity</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="n">Generator</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">genK</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">,</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;(</span><span class="n">genK</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">quantity</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="n">Iterable</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">genK</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">genV</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;(</span><span class="n">genK</span><span class="o">,</span> <span class="n">genV</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="n">Iterable</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">genK</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">MapData</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;(</span><span class="n">genK</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~
</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/MapDataTest.java
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Letters</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;,</span>
  <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">9</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">char</span> <span class="n">letter</span> <span class="o">=</span> <span class="sc">&#39;A&#39;</span><span class="o">;</span>
  <span class="kd">public</span> <span class="n">Pair</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;(</span>
      <span class="n">number</span><span class="o">++,</span> <span class="s">&#34;&#34;</span> <span class="o">+</span> <span class="n">letter</span><span class="o">++);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;()</span> <span class="o">{</span>
      <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">number</span><span class="o">++;</span> <span class="o">}</span>
      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">number</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="o">}</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">UnsupportedOperationException</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MapDataTest</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Pair Generator:
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="n">MapData</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="k">new</span> <span class="n">Letters</span><span class="o">(),</span> <span class="n">11</span><span class="o">));</span>
    <span class="c1">// Two separate generators:
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="n">MapData</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="k">new</span> <span class="n">CountingGenerator</span><span class="o">.</span><span class="na">Character</span><span class="o">(),</span>
      <span class="k">new</span> <span class="n">RandomGenerator</span><span class="o">.</span><span class="na">String</span><span class="o">(</span><span class="n">3</span><span class="o">),</span> <span class="n">8</span><span class="o">));</span>
    <span class="c1">// A key Generator and a single value:
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="n">MapData</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="k">new</span> <span class="n">CountingGenerator</span><span class="o">.</span><span class="na">Character</span><span class="o">(),</span>
      <span class="s">&#34;Value&#34;</span><span class="o">,</span> <span class="n">6</span><span class="o">));</span>
    <span class="c1">// An Iterable and a value Generator:
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="n">MapData</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="k">new</span> <span class="n">Letters</span><span class="o">(),</span>
      <span class="k">new</span> <span class="n">RandomGenerator</span><span class="o">.</span><span class="na">String</span><span class="o">(</span><span class="n">3</span><span class="o">)));</span>
    <span class="c1">// An Iterable and a single value:
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="n">MapData</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="k">new</span> <span class="n">Letters</span><span class="o">(),</span> <span class="s">&#34;Pop&#34;</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">{1=A, 2=B, 3=C, 4=D, 5=E, 6=F, 7=G, 8=H, 9=I, 10=J, 11=K}
</span><span class="cm">{a=YNz, b=brn, c=yGc, d=FOW, e=ZnT, f=cQr, g=Gse, h=GZM}
</span><span class="cm">{a=Value, b=Value, c=Value, d=Value, e=Value, f=Value}
</span><span class="cm">{1=mJM, 2=RoE, 3=suE, 4=cUO, 5=neO, 6=EdL, 7=smw, 8=HLG}
</span><span class="cm">{1=Pop, 2=Pop, 3=Pop, 4=Pop, 5=Pop, 6=Pop, 7=Pop, 8=Pop}
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h3 id="23-使用abstract类">2.3 使用Abstract类</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: net/mindview/util/Countries.java
</span><span class="c1">// &#34;Flyweight&#34; Maps and Lists of sample data.
</span><span class="c1"></span><span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Countries</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span><span class="o">[][]</span> <span class="n">DATA</span> <span class="o">=</span> <span class="o">{</span>
    <span class="c1">// Africa
</span><span class="c1"></span>    <span class="o">{</span><span class="s">&#34;ALGERIA&#34;</span><span class="o">,</span><span class="s">&#34;Algiers&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ANGOLA&#34;</span><span class="o">,</span><span class="s">&#34;Luanda&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BENIN&#34;</span><span class="o">,</span><span class="s">&#34;Porto-Novo&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;BOTSWANA&#34;</span><span class="o">,</span><span class="s">&#34;Gaberone&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BURKINA FASO&#34;</span><span class="o">,</span><span class="s">&#34;Ouagadougou&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BURUNDI&#34;</span><span class="o">,</span><span class="s">&#34;Bujumbura&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;CAMEROON&#34;</span><span class="o">,</span><span class="s">&#34;Yaounde&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;CAPE VERDE&#34;</span><span class="o">,</span><span class="s">&#34;Praia&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;CENTRAL AFRICAN REPUBLIC&#34;</span><span class="o">,</span><span class="s">&#34;Bangui&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;CHAD&#34;</span><span class="o">,</span><span class="s">&#34;N&#39;djamena&#34;</span><span class="o">},</span>  <span class="o">{</span><span class="s">&#34;COMOROS&#34;</span><span class="o">,</span><span class="s">&#34;Moroni&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;CONGO&#34;</span><span class="o">,</span><span class="s">&#34;Brazzaville&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;DJIBOUTI&#34;</span><span class="o">,</span><span class="s">&#34;Dijibouti&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;EGYPT&#34;</span><span class="o">,</span><span class="s">&#34;Cairo&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;EQUATORIAL GUINEA&#34;</span><span class="o">,</span><span class="s">&#34;Malabo&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;ERITREA&#34;</span><span class="o">,</span><span class="s">&#34;Asmara&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ETHIOPIA&#34;</span><span class="o">,</span><span class="s">&#34;Addis Ababa&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;GABON&#34;</span><span class="o">,</span><span class="s">&#34;Libreville&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;THE GAMBIA&#34;</span><span class="o">,</span><span class="s">&#34;Banjul&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;GHANA&#34;</span><span class="o">,</span><span class="s">&#34;Accra&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;GUINEA&#34;</span><span class="o">,</span><span class="s">&#34;Conakry&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BISSAU&#34;</span><span class="o">,</span><span class="s">&#34;Bissau&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;COTE D&#39;IVOIR (IVORY COAST)&#34;</span><span class="o">,</span><span class="s">&#34;Yamoussoukro&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;KENYA&#34;</span><span class="o">,</span><span class="s">&#34;Nairobi&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;LESOTHO&#34;</span><span class="o">,</span><span class="s">&#34;Maseru&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;LIBERIA&#34;</span><span class="o">,</span><span class="s">&#34;Monrovia&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;LIBYA&#34;</span><span class="o">,</span><span class="s">&#34;Tripoli&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MADAGASCAR&#34;</span><span class="o">,</span><span class="s">&#34;Antananarivo&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;MALAWI&#34;</span><span class="o">,</span><span class="s">&#34;Lilongwe&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MALI&#34;</span><span class="o">,</span><span class="s">&#34;Bamako&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;MAURITANIA&#34;</span><span class="o">,</span><span class="s">&#34;Nouakchott&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MAURITIUS&#34;</span><span class="o">,</span><span class="s">&#34;Port Louis&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;MOROCCO&#34;</span><span class="o">,</span><span class="s">&#34;Rabat&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MOZAMBIQUE&#34;</span><span class="o">,</span><span class="s">&#34;Maputo&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;NAMIBIA&#34;</span><span class="o">,</span><span class="s">&#34;Windhoek&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;NIGER&#34;</span><span class="o">,</span><span class="s">&#34;Niamey&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;NIGERIA&#34;</span><span class="o">,</span><span class="s">&#34;Abuja&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;RWANDA&#34;</span><span class="o">,</span><span class="s">&#34;Kigali&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SAO TOME E PRINCIPE&#34;</span><span class="o">,</span><span class="s">&#34;Sao Tome&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SENEGAL&#34;</span><span class="o">,</span><span class="s">&#34;Dakar&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;SEYCHELLES&#34;</span><span class="o">,</span><span class="s">&#34;Victoria&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SIERRA LEONE&#34;</span><span class="o">,</span><span class="s">&#34;Freetown&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;SOMALIA&#34;</span><span class="o">,</span><span class="s">&#34;Mogadishu&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SOUTH AFRICA&#34;</span><span class="o">,</span><span class="s">&#34;Pretoria/Cape Town&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SUDAN&#34;</span><span class="o">,</span><span class="s">&#34;Khartoum&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SWAZILAND&#34;</span><span class="o">,</span><span class="s">&#34;Mbabane&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;TANZANIA&#34;</span><span class="o">,</span><span class="s">&#34;Dodoma&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;TOGO&#34;</span><span class="o">,</span><span class="s">&#34;Lome&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;TUNISIA&#34;</span><span class="o">,</span><span class="s">&#34;Tunis&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;UGANDA&#34;</span><span class="o">,</span><span class="s">&#34;Kampala&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;DEMOCRATIC REPUBLIC OF THE CONGO (ZAIRE)&#34;</span><span class="o">,</span>
     <span class="s">&#34;Kinshasa&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;ZAMBIA&#34;</span><span class="o">,</span><span class="s">&#34;Lusaka&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ZIMBABWE&#34;</span><span class="o">,</span><span class="s">&#34;Harare&#34;</span><span class="o">},</span>
    <span class="c1">// Asia
</span><span class="c1"></span>    <span class="o">{</span><span class="s">&#34;AFGHANISTAN&#34;</span><span class="o">,</span><span class="s">&#34;Kabul&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;BAHRAIN&#34;</span><span class="o">,</span><span class="s">&#34;Manama&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BANGLADESH&#34;</span><span class="o">,</span><span class="s">&#34;Dhaka&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;BHUTAN&#34;</span><span class="o">,</span><span class="s">&#34;Thimphu&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BRUNEI&#34;</span><span class="o">,</span><span class="s">&#34;Bandar Seri Begawan&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;CAMBODIA&#34;</span><span class="o">,</span><span class="s">&#34;Phnom Penh&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;CHINA&#34;</span><span class="o">,</span><span class="s">&#34;Beijing&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;CYPRUS&#34;</span><span class="o">,</span><span class="s">&#34;Nicosia&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;INDIA&#34;</span><span class="o">,</span><span class="s">&#34;New Delhi&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;INDONESIA&#34;</span><span class="o">,</span><span class="s">&#34;Jakarta&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;IRAN&#34;</span><span class="o">,</span><span class="s">&#34;Tehran&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;IRAQ&#34;</span><span class="o">,</span><span class="s">&#34;Baghdad&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;ISRAEL&#34;</span><span class="o">,</span><span class="s">&#34;Jerusalem&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;JAPAN&#34;</span><span class="o">,</span><span class="s">&#34;Tokyo&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;JORDAN&#34;</span><span class="o">,</span><span class="s">&#34;Amman&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;KUWAIT&#34;</span><span class="o">,</span><span class="s">&#34;Kuwait City&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;LAOS&#34;</span><span class="o">,</span><span class="s">&#34;Vientiane&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;LEBANON&#34;</span><span class="o">,</span><span class="s">&#34;Beirut&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MALAYSIA&#34;</span><span class="o">,</span><span class="s">&#34;Kuala Lumpur&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;THE MALDIVES&#34;</span><span class="o">,</span><span class="s">&#34;Male&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MONGOLIA&#34;</span><span class="o">,</span><span class="s">&#34;Ulan Bator&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MYANMAR (BURMA)&#34;</span><span class="o">,</span><span class="s">&#34;Rangoon&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;NEPAL&#34;</span><span class="o">,</span><span class="s">&#34;Katmandu&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;NORTH KOREA&#34;</span><span class="o">,</span><span class="s">&#34;P&#39;yongyang&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;OMAN&#34;</span><span class="o">,</span><span class="s">&#34;Muscat&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;PAKISTAN&#34;</span><span class="o">,</span><span class="s">&#34;Islamabad&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;PHILIPPINES&#34;</span><span class="o">,</span><span class="s">&#34;Manila&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;QATAR&#34;</span><span class="o">,</span><span class="s">&#34;Doha&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SAUDI ARABIA&#34;</span><span class="o">,</span><span class="s">&#34;Riyadh&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;SINGAPORE&#34;</span><span class="o">,</span><span class="s">&#34;Singapore&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SOUTH KOREA&#34;</span><span class="o">,</span><span class="s">&#34;Seoul&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;SRI LANKA&#34;</span><span class="o">,</span><span class="s">&#34;Colombo&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SYRIA&#34;</span><span class="o">,</span><span class="s">&#34;Damascus&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;TAIWAN (REPUBLIC OF CHINA)&#34;</span><span class="o">,</span><span class="s">&#34;Taipei&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;THAILAND&#34;</span><span class="o">,</span><span class="s">&#34;Bangkok&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;TURKEY&#34;</span><span class="o">,</span><span class="s">&#34;Ankara&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;UNITED ARAB EMIRATES&#34;</span><span class="o">,</span><span class="s">&#34;Abu Dhabi&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;VIETNAM&#34;</span><span class="o">,</span><span class="s">&#34;Hanoi&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;YEMEN&#34;</span><span class="o">,</span><span class="s">&#34;Sana&#39;a&#34;</span><span class="o">},</span>
    <span class="c1">// Australia and Oceania
</span><span class="c1"></span>    <span class="o">{</span><span class="s">&#34;AUSTRALIA&#34;</span><span class="o">,</span><span class="s">&#34;Canberra&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;FIJI&#34;</span><span class="o">,</span><span class="s">&#34;Suva&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;KIRIBATI&#34;</span><span class="o">,</span><span class="s">&#34;Bairiki&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MARSHALL ISLANDS&#34;</span><span class="o">,</span><span class="s">&#34;Dalap-Uliga-Darrit&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MICRONESIA&#34;</span><span class="o">,</span><span class="s">&#34;Palikir&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;NAURU&#34;</span><span class="o">,</span><span class="s">&#34;Yaren&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;NEW ZEALAND&#34;</span><span class="o">,</span><span class="s">&#34;Wellington&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;PALAU&#34;</span><span class="o">,</span><span class="s">&#34;Koror&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;PAPUA NEW GUINEA&#34;</span><span class="o">,</span><span class="s">&#34;Port Moresby&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SOLOMON ISLANDS&#34;</span><span class="o">,</span><span class="s">&#34;Honaira&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;TONGA&#34;</span><span class="o">,</span><span class="s">&#34;Nuku&#39;alofa&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;TUVALU&#34;</span><span class="o">,</span><span class="s">&#34;Fongafale&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;VANUATU&#34;</span><span class="o">,</span><span class="s">&#34;&lt; Port-Vila&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;WESTERN SAMOA&#34;</span><span class="o">,</span><span class="s">&#34;Apia&#34;</span><span class="o">},</span>
    <span class="c1">// Eastern Europe and former USSR
</span><span class="c1"></span>    <span class="o">{</span><span class="s">&#34;ARMENIA&#34;</span><span class="o">,</span><span class="s">&#34;Yerevan&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;AZERBAIJAN&#34;</span><span class="o">,</span><span class="s">&#34;Baku&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BELARUS (BYELORUSSIA)&#34;</span><span class="o">,</span><span class="s">&#34;Minsk&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BULGARIA&#34;</span><span class="o">,</span><span class="s">&#34;Sofia&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;GEORGIA&#34;</span><span class="o">,</span><span class="s">&#34;Tbilisi&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;KAZAKSTAN&#34;</span><span class="o">,</span><span class="s">&#34;Almaty&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;KYRGYZSTAN&#34;</span><span class="o">,</span><span class="s">&#34;Alma-Ata&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MOLDOVA&#34;</span><span class="o">,</span><span class="s">&#34;Chisinau&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;RUSSIA&#34;</span><span class="o">,</span><span class="s">&#34;Moscow&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;TAJIKISTAN&#34;</span><span class="o">,</span><span class="s">&#34;Dushanbe&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;TURKMENISTAN&#34;</span><span class="o">,</span><span class="s">&#34;Ashkabad&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;UKRAINE&#34;</span><span class="o">,</span><span class="s">&#34;Kyiv&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;UZBEKISTAN&#34;</span><span class="o">,</span><span class="s">&#34;Tashkent&#34;</span><span class="o">},</span>
    <span class="c1">// Europe
</span><span class="c1"></span>    <span class="o">{</span><span class="s">&#34;ALBANIA&#34;</span><span class="o">,</span><span class="s">&#34;Tirana&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ANDORRA&#34;</span><span class="o">,</span><span class="s">&#34;Andorra la Vella&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;AUSTRIA&#34;</span><span class="o">,</span><span class="s">&#34;Vienna&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;BELGIUM&#34;</span><span class="o">,</span><span class="s">&#34;Brussels&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BOSNIA&#34;</span><span class="o">,</span><span class="s">&#34;-&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;HERZEGOVINA&#34;</span><span class="o">,</span><span class="s">&#34;Sarajevo&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;CROATIA&#34;</span><span class="o">,</span><span class="s">&#34;Zagreb&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;CZECH REPUBLIC&#34;</span><span class="o">,</span><span class="s">&#34;Prague&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;DENMARK&#34;</span><span class="o">,</span><span class="s">&#34;Copenhagen&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ESTONIA&#34;</span><span class="o">,</span><span class="s">&#34;Tallinn&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;FINLAND&#34;</span><span class="o">,</span><span class="s">&#34;Helsinki&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;FRANCE&#34;</span><span class="o">,</span><span class="s">&#34;Paris&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;GERMANY&#34;</span><span class="o">,</span><span class="s">&#34;Berlin&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;GREECE&#34;</span><span class="o">,</span><span class="s">&#34;Athens&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;HUNGARY&#34;</span><span class="o">,</span><span class="s">&#34;Budapest&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ICELAND&#34;</span><span class="o">,</span><span class="s">&#34;Reykjavik&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;IRELAND&#34;</span><span class="o">,</span><span class="s">&#34;Dublin&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ITALY&#34;</span><span class="o">,</span><span class="s">&#34;Rome&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;LATVIA&#34;</span><span class="o">,</span><span class="s">&#34;Riga&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;LIECHTENSTEIN&#34;</span><span class="o">,</span><span class="s">&#34;Vaduz&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;LITHUANIA&#34;</span><span class="o">,</span><span class="s">&#34;Vilnius&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;LUXEMBOURG&#34;</span><span class="o">,</span><span class="s">&#34;Luxembourg&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MACEDONIA&#34;</span><span class="o">,</span><span class="s">&#34;Skopje&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;MALTA&#34;</span><span class="o">,</span><span class="s">&#34;Valletta&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MONACO&#34;</span><span class="o">,</span><span class="s">&#34;Monaco&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;MONTENEGRO&#34;</span><span class="o">,</span><span class="s">&#34;Podgorica&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;THE NETHERLANDS&#34;</span><span class="o">,</span><span class="s">&#34;Amsterdam&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;NORWAY&#34;</span><span class="o">,</span><span class="s">&#34;Oslo&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;POLAND&#34;</span><span class="o">,</span><span class="s">&#34;Warsaw&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;PORTUGAL&#34;</span><span class="o">,</span><span class="s">&#34;Lisbon&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;ROMANIA&#34;</span><span class="o">,</span><span class="s">&#34;Bucharest&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;SAN MARINO&#34;</span><span class="o">,</span><span class="s">&#34;San Marino&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SERBIA&#34;</span><span class="o">,</span><span class="s">&#34;Belgrade&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;SLOVAKIA&#34;</span><span class="o">,</span><span class="s">&#34;Bratislava&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SLOVENIA&#34;</span><span class="o">,</span><span class="s">&#34;Ljuijana&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;SPAIN&#34;</span><span class="o">,</span><span class="s">&#34;Madrid&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;SWEDEN&#34;</span><span class="o">,</span><span class="s">&#34;Stockholm&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;SWITZERLAND&#34;</span><span class="o">,</span><span class="s">&#34;Berne&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;UNITED KINGDOM&#34;</span><span class="o">,</span><span class="s">&#34;London&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;VATICAN CITY&#34;</span><span class="o">,</span><span class="s">&#34;---&#34;</span><span class="o">},</span>
    <span class="c1">// North and Central America
</span><span class="c1"></span>    <span class="o">{</span><span class="s">&#34;ANTIGUA AND BARBUDA&#34;</span><span class="o">,</span><span class="s">&#34;Saint John&#39;s&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BAHAMAS&#34;</span><span class="o">,</span><span class="s">&#34;Nassau&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BARBADOS&#34;</span><span class="o">,</span><span class="s">&#34;Bridgetown&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;BELIZE&#34;</span><span class="o">,</span><span class="s">&#34;Belmopan&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;CANADA&#34;</span><span class="o">,</span><span class="s">&#34;Ottawa&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;COSTA RICA&#34;</span><span class="o">,</span><span class="s">&#34;San Jose&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;CUBA&#34;</span><span class="o">,</span><span class="s">&#34;Havana&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;DOMINICA&#34;</span><span class="o">,</span><span class="s">&#34;Roseau&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;DOMINICAN REPUBLIC&#34;</span><span class="o">,</span><span class="s">&#34;Santo Domingo&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;EL SALVADOR&#34;</span><span class="o">,</span><span class="s">&#34;San Salvador&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;GRENADA&#34;</span><span class="o">,</span><span class="s">&#34;Saint George&#39;s&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;GUATEMALA&#34;</span><span class="o">,</span><span class="s">&#34;Guatemala City&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;HAITI&#34;</span><span class="o">,</span><span class="s">&#34;Port-au-Prince&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;HONDURAS&#34;</span><span class="o">,</span><span class="s">&#34;Tegucigalpa&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;JAMAICA&#34;</span><span class="o">,</span><span class="s">&#34;Kingston&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;MEXICO&#34;</span><span class="o">,</span><span class="s">&#34;Mexico City&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;NICARAGUA&#34;</span><span class="o">,</span><span class="s">&#34;Managua&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;PANAMA&#34;</span><span class="o">,</span><span class="s">&#34;Panama City&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ST. KITTS&#34;</span><span class="o">,</span><span class="s">&#34;-&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;NEVIS&#34;</span><span class="o">,</span><span class="s">&#34;Basseterre&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ST. LUCIA&#34;</span><span class="o">,</span><span class="s">&#34;Castries&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;ST. VINCENT AND THE GRENADINES&#34;</span><span class="o">,</span><span class="s">&#34;Kingstown&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;UNITED STATES OF AMERICA&#34;</span><span class="o">,</span><span class="s">&#34;Washington, D.C.&#34;</span><span class="o">},</span>
    <span class="c1">// South America
</span><span class="c1"></span>    <span class="o">{</span><span class="s">&#34;ARGENTINA&#34;</span><span class="o">,</span><span class="s">&#34;Buenos Aires&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BOLIVIA&#34;</span><span class="o">,</span><span class="s">&#34;Sucre (legal)/La Paz(administrative)&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;BRAZIL&#34;</span><span class="o">,</span><span class="s">&#34;Brasilia&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;CHILE&#34;</span><span class="o">,</span><span class="s">&#34;Santiago&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;COLOMBIA&#34;</span><span class="o">,</span><span class="s">&#34;Bogota&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;ECUADOR&#34;</span><span class="o">,</span><span class="s">&#34;Quito&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;GUYANA&#34;</span><span class="o">,</span><span class="s">&#34;Georgetown&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;PARAGUAY&#34;</span><span class="o">,</span><span class="s">&#34;Asuncion&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;PERU&#34;</span><span class="o">,</span><span class="s">&#34;Lima&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;SURINAME&#34;</span><span class="o">,</span><span class="s">&#34;Paramaribo&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;TRINIDAD AND TOBAGO&#34;</span><span class="o">,</span><span class="s">&#34;Port of Spain&#34;</span><span class="o">},</span>
    <span class="o">{</span><span class="s">&#34;URUGUAY&#34;</span><span class="o">,</span><span class="s">&#34;Montevideo&#34;</span><span class="o">},</span> <span class="o">{</span><span class="s">&#34;VENEZUELA&#34;</span><span class="o">,</span><span class="s">&#34;Caracas&#34;</span><span class="o">},</span>
  <span class="o">};</span>
  <span class="c1">// Use AbstractMap by implementing entrySet()
</span><span class="c1"></span>  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">FlyweightMap</span> <span class="kd">extends</span> <span class="n">AbstractMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Entry</span> <span class="kd">implements</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
      <span class="kt">int</span> <span class="n">index</span><span class="o">;</span>
      <span class="n">Entry</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">index</span> <span class="o">=</span> <span class="n">index</span><span class="o">;</span> <span class="o">}</span>
      <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">DATA</span><span class="o">[</span><span class="n">index</span><span class="o">][</span><span class="n">0</span><span class="o">].</span><span class="na">equals</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="kd">public</span> <span class="n">String</span> <span class="nf">getKey</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">DATA</span><span class="o">[</span><span class="n">index</span><span class="o">][</span><span class="n">0</span><span class="o">];</span> <span class="o">}</span>
      <span class="kd">public</span> <span class="n">String</span> <span class="nf">getValue</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">DATA</span><span class="o">[</span><span class="n">index</span><span class="o">][</span><span class="n">1</span><span class="o">];</span> <span class="o">}</span>
      <span class="kd">public</span> <span class="n">String</span> <span class="nf">setValue</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">UnsupportedOperationException</span><span class="o">();</span>
      <span class="o">}</span>
      <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">DATA</span><span class="o">[</span><span class="n">index</span><span class="o">][</span><span class="n">0</span><span class="o">].</span><span class="na">hashCode</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="c1">// Use AbstractSet by implementing size() &amp; iterator()
</span><span class="c1"></span>    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">EntrySet</span> <span class="kd">extends</span> <span class="n">AbstractSet</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="o">{</span>
      <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span><span class="o">;</span>
      <span class="n">EntrySet</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">size</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span>
          <span class="k">this</span><span class="o">.</span><span class="na">size</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="c1">// Can&#39;t be any bigger than the array:
</span><span class="c1"></span>        <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">size</span> <span class="o">&gt;</span> <span class="n">DATA</span><span class="o">.</span><span class="na">length</span><span class="o">)</span>
          <span class="k">this</span><span class="o">.</span><span class="na">size</span> <span class="o">=</span> <span class="n">DATA</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
        <span class="k">else</span>
          <span class="k">this</span><span class="o">.</span><span class="na">size</span> <span class="o">=</span> <span class="n">size</span><span class="o">;</span>
      <span class="o">}</span>
      <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">size</span><span class="o">;</span> <span class="o">}</span>
      <span class="kd">private</span> <span class="kd">class</span> <span class="nc">Iter</span> <span class="kd">implements</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="o">{</span>
        <span class="c1">// Only one Entry object per Iterator:
</span><span class="c1"></span>        <span class="kd">private</span> <span class="n">Entry</span> <span class="n">entry</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Entry</span><span class="o">(-</span><span class="n">1</span><span class="o">);</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">entry</span><span class="o">.</span><span class="na">index</span> <span class="o">&lt;</span> <span class="n">size</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
          <span class="n">entry</span><span class="o">.</span><span class="na">index</span><span class="o">++;</span>
          <span class="k">return</span> <span class="n">entry</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="n">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">}</span>
      <span class="kd">public</span>
      <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Iter</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EntrySet</span><span class="o">(</span><span class="n">DATA</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
    <span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="nf">entrySet</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">entries</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="c1">// Create a partial map of &#39;size&#39; countries:
</span><span class="c1"></span>  <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">select</span><span class="o">(</span><span class="kd">final</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">FlyweightMap</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="nf">entrySet</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">EntrySet</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
      <span class="o">}</span>
    <span class="o">};</span>
  <span class="o">}</span>
  <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlyweightMap</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">capitals</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">map</span><span class="o">;</span> <span class="c1">// The entire map
</span><span class="c1"></span>  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">capitals</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">select</span><span class="o">(</span><span class="n">size</span><span class="o">);</span> <span class="c1">// A partial map
</span><span class="c1"></span>  <span class="o">}</span>
  <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">map</span><span class="o">.</span><span class="na">keySet</span><span class="o">());</span>
  <span class="c1">// All the names:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">names</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">names</span><span class="o">;</span> <span class="o">}</span>
  <span class="c1">// A partial list:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">names</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">select</span><span class="o">(</span><span class="n">size</span><span class="o">).</span><span class="na">keySet</span><span class="o">());</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">print</span><span class="o">(</span><span class="n">capitals</span><span class="o">(</span><span class="n">10</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">names</span><span class="o">(</span><span class="n">10</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">capitals</span><span class="o">(</span><span class="n">3</span><span class="o">)));</span>
    <span class="n">print</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">capitals</span><span class="o">(</span><span class="n">3</span><span class="o">)));</span>
    <span class="n">print</span><span class="o">(</span><span class="k">new</span> <span class="n">TreeMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">capitals</span><span class="o">(</span><span class="n">3</span><span class="o">)));</span>
    <span class="n">print</span><span class="o">(</span><span class="k">new</span> <span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">capitals</span><span class="o">(</span><span class="n">3</span><span class="o">)));</span>
    <span class="n">print</span><span class="o">(</span><span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">names</span><span class="o">(</span><span class="n">6</span><span class="o">)));</span>
    <span class="n">print</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">names</span><span class="o">(</span><span class="n">6</span><span class="o">)));</span>
    <span class="n">print</span><span class="o">(</span><span class="k">new</span> <span class="n">TreeSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">names</span><span class="o">(</span><span class="n">6</span><span class="o">)));</span>
    <span class="n">print</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">names</span><span class="o">(</span><span class="n">6</span><span class="o">)));</span>
    <span class="n">print</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">names</span><span class="o">(</span><span class="n">6</span><span class="o">)));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">capitals</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;BRAZIL&#34;</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">{ALGERIA=Algiers, ANGOLA=Luanda, BENIN=Porto-Novo, BOTSWANA=Gaberone, BULGARIA=Sofia, BURKINA FASO=Ouagadougou, BURUNDI=Bujumbura, CAMEROON=Yaounde, CAPE VERDE=Praia, CENTRAL AFRICAN REPUBLIC=Bangui}
</span><span class="cm">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO, BURUNDI, CAMEROON, CAPE VERDE, CENTRAL AFRICAN REPUBLIC]
</span><span class="cm">{BENIN=Porto-Novo, ANGOLA=Luanda, ALGERIA=Algiers}
</span><span class="cm">{ALGERIA=Algiers, ANGOLA=Luanda, BENIN=Porto-Novo}
</span><span class="cm">{ALGERIA=Algiers, ANGOLA=Luanda, BENIN=Porto-Novo}
</span><span class="cm">{ALGERIA=Algiers, ANGOLA=Luanda, BENIN=Porto-Novo}
</span><span class="cm">[BULGARIA, BURKINA FASO, BOTSWANA, BENIN, ANGOLA, ALGERIA]
</span><span class="cm">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]
</span><span class="cm">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]
</span><span class="cm">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]
</span><span class="cm">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]
</span><span class="cm">Brasilia
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: net/mindview/util/CountingMapData.java
</span><span class="c1">// Unlimited-length Map containing sample data.
</span><span class="c1"></span><span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CountingMapData</span> <span class="kd">extends</span> <span class="n">AbstractMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span><span class="o">[]</span> <span class="n">chars</span> <span class="o">=</span> <span class="s">&#34;A B C D E F G H I J K L M N O P Q R S T U V W X Y Z&#34;</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34; &#34;</span><span class="o">);</span>
  <span class="kd">public</span> <span class="nf">CountingMapData</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">size</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span> <span class="k">this</span><span class="o">.</span><span class="na">size</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">size</span> <span class="o">=</span> <span class="n">size</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Entry</span> <span class="kd">implements</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">index</span><span class="o">;</span>
    <span class="n">Entry</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">index</span> <span class="o">=</span> <span class="n">index</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">index</span><span class="o">).</span><span class="na">equals</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getKey</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">index</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getValue</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">chars</span><span class="o">[</span><span class="n">index</span> <span class="o">%</span> <span class="n">chars</span><span class="o">.</span><span class="na">length</span><span class="o">]</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">index</span> <span class="o">/</span> <span class="n">chars</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">setValue</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">UnsupportedOperationException</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">index</span><span class="o">).</span><span class="na">hashCode</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="nf">entrySet</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// LinkedHashSet retains initialization order:
</span><span class="c1"></span>    <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;();</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="n">entries</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Entry</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
    <span class="k">return</span> <span class="n">entries</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="n">CountingMapData</span><span class="o">(</span><span class="n">60</span><span class="o">));</span><span class="c1">//调用toString方法，toString方法中调用entrySet()方法。
</span><span class="c1"></span>  <span class="o">}</span>
<span class="o">}</span>  <span class="cm">/* Output:
</span><span class="cm">{0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0, 9=J0, 10=K0, 11=L0, 12=M0, 13=N0, 14=O0, 15=P0, 16=Q0, 17=R0, 18=S0, 19=T0, 20=U0, 21=V0, 22=W0, 23=X0, 24=Y0, 25=Z0, 26=A1, 27=B1, 28=C1, 29=D1, 30=E1, 31=F1, 32=G1, 33=H1, 34=I1, 35=J1, 36=K1, 37=L1, 38=M1, 39=N1, 40=O1, 41=P1, 42=Q1, 43=R1, 44=S1, 45=T1, 46=U1, 47=V1, 48=W1, 49=X1, 50=Y1, 51=Z1, 52=A2, 53=B2, 54=C2, 55=D2, 56=E2, 57=F2, 58=G2, 59=H2}
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h2 id="3collection的功能方法">3.Collection的功能方法</h2>
<p><code>Collection</code>所有操作：</p>
<ul>
<li>boolean add(T)</li>
<li>boolean addAll(Collection&lt;? extends T&gt;)</li>
<li>void clear()</li>
<li>boolean contains(T)</li>
<li>boolean isEmpty()</li>
<li>Iterator iterator()</li>
<li>boolean remove(Object)</li>
<li>boolean removeAll(Collection&lt;?&gt;)</li>
<li>boolean retainAll(Collection&lt;?&gt;)：交集</li>
<li>int size()</li>
<li>Object[] toArray()：</li>
<li>T[] toArray(T[] a)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/CollectionMethods.java
</span><span class="c1">// Things you can do with all Collections.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CollectionMethods</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">c</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">6</span><span class="o">));</span>
    <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;ten&#34;</span><span class="o">);</span>
    <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;eleven&#34;</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="c1">// Make an array from the List:
</span><span class="c1"></span>    <span class="n">Object</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">toArray</span><span class="o">();</span>
    <span class="c1">// Make a String array from the List:
</span><span class="c1"></span>    <span class="n">String</span><span class="o">[]</span> <span class="n">str</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">0</span><span class="o">]);</span>
    <span class="c1">// Find max and min elements; this means
</span><span class="c1"></span>    <span class="c1">// different things depending on the way
</span><span class="c1"></span>    <span class="c1">// the Comparable interface is implemented:
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="s">&#34;Collections.max(c) = &#34;</span> <span class="o">+</span> <span class="n">Collections</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">c</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;Collections.min(c) = &#34;</span> <span class="o">+</span> <span class="n">Collections</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">c</span><span class="o">));</span>
    <span class="c1">// Add a Collection to another Collection
</span><span class="c1"></span>    <span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">c2</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">6</span><span class="o">));</span>
    <span class="n">c</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="n">c</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">DATA</span><span class="o">[</span><span class="n">0</span><span class="o">][</span><span class="n">0</span><span class="o">]);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="n">c</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">DATA</span><span class="o">[</span><span class="n">1</span><span class="o">][</span><span class="n">0</span><span class="o">]);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="c1">// Remove all components that are
</span><span class="c1"></span>    <span class="c1">// in the argument collection:
</span><span class="c1"></span>    <span class="n">c</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="n">c</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="c1">// Is an element in this Collection?
</span><span class="c1"></span>    <span class="n">String</span> <span class="n">val</span> <span class="o">=</span> <span class="n">Countries</span><span class="o">.</span><span class="na">DATA</span><span class="o">[</span><span class="n">3</span><span class="o">][</span><span class="n">0</span><span class="o">];</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;c.contains(&#34;</span> <span class="o">+</span> <span class="n">val</span>  <span class="o">+</span> <span class="s">&#34;) = &#34;</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">val</span><span class="o">));</span>
    <span class="c1">// Is a Collection in this Collection?
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="s">&#34;c.containsAll(c2) = &#34;</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">c2</span><span class="o">));</span>
    <span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c3</span> <span class="o">=</span>
      <span class="o">((</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;)</span><span class="n">c</span><span class="o">).</span><span class="na">subList</span><span class="o">(</span><span class="n">3</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
    <span class="c1">// Keep all the elements that are in both
</span><span class="c1"></span>    <span class="c1">// c2 and c3 (an intersection of sets):
</span><span class="c1"></span>    <span class="n">c2</span><span class="o">.</span><span class="na">retainAll</span><span class="o">(</span><span class="n">c3</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span>
    <span class="c1">// Throw away all the elements
</span><span class="c1"></span>    <span class="c1">// in c2 that also appear in c3:
</span><span class="c1"></span>    <span class="n">c2</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">c3</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;c2.isEmpty() = &#34;</span> <span class="o">+</span>  <span class="n">c2</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
    <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">c</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">6</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="n">c</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span> <span class="c1">// Remove all elements
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="s">&#34;after c.clear():&#34;</span> <span class="o">+</span> <span class="n">c</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO, ten, eleven]
</span><span class="cm">Collections.max(c) = ten
</span><span class="cm">Collections.min(c) = ALGERIA
</span><span class="cm">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO, ten, eleven, ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]
</span><span class="cm">[ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO, ten, eleven, ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]
</span><span class="cm">[BENIN, BOTSWANA, BULGARIA, BURKINA FASO, ten, eleven, ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]
</span><span class="cm">[ten, eleven]
</span><span class="cm">[ten, eleven, ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]
</span><span class="cm">c.contains(BOTSWANA) = true
</span><span class="cm">c.containsAll(c2) = true
</span><span class="cm">[ANGOLA, BENIN]
</span><span class="cm">c2.isEmpty() = true
</span><span class="cm">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]
</span><span class="cm">after c.clear():[]
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h2 id="4可选操作">4.可选操作</h2>
<p>最常见的未获支持的操作，都来源于背后由固定尺寸的数据结构支持的容器。当你用<code>Arrays.asList()</code>将数组转换为<code>List</code>时，就会得到这样的容器。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/Unsupported.java
</span><span class="c1">// Unsupported operations in Java containers.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Unsupported</span> <span class="o">{</span>
  <span class="kd">static</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;--- &#34;</span> <span class="o">+</span> <span class="n">msg</span> <span class="o">+</span> <span class="s">&#34; ---&#34;</span><span class="o">);</span>
    <span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">list</span><span class="o">;</span>
    <span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">subList</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">8</span><span class="o">);</span>
    <span class="c1">// Copy of the sublist:
</span><span class="c1"></span>    <span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">subList</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span> <span class="n">c</span><span class="o">.</span><span class="na">retainAll</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span> <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;retainAll(): &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span> <span class="n">c</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span> <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;removeAll(): &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span> <span class="n">c</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span> <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;clear(): &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span> <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;X&#34;</span><span class="o">);</span> <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;add(): &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span> <span class="n">c</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span> <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;addAll(): &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span> <span class="n">c</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="s">&#34;C&#34;</span><span class="o">);</span> <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;remove(): &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">// The List.set() method modifies the value but
</span><span class="c1"></span>    <span class="c1">// doesn&#39;t change the size of the data structure:
</span><span class="c1"></span>    <span class="k">try</span> <span class="o">{</span>
      <span class="n">list</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="s">&#34;X&#34;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;List.set(): &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span>
      <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&#34;A B C D E F G H I J K L&#34;</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34; &#34;</span><span class="o">));</span>
    <span class="n">test</span><span class="o">(</span><span class="s">&#34;Modifiable Copy&#34;</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">list</span><span class="o">));</span>
    <span class="n">test</span><span class="o">(</span><span class="s">&#34;Arrays.asList()&#34;</span><span class="o">,</span> <span class="n">list</span><span class="o">);</span>
    <span class="n">test</span><span class="o">(</span><span class="s">&#34;unmodifiableList()&#34;</span><span class="o">,</span>
      <span class="n">Collections</span><span class="o">.</span><span class="na">unmodifiableList</span><span class="o">(</span>
        <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">list</span><span class="o">)));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">--- Modifiable Copy ---
</span><span class="cm">--- Arrays.asList() ---
</span><span class="cm">retainAll(): java.lang.UnsupportedOperationException
</span><span class="cm">removeAll(): java.lang.UnsupportedOperationException
</span><span class="cm">clear(): java.lang.UnsupportedOperationException
</span><span class="cm">add(): java.lang.UnsupportedOperationException
</span><span class="cm">addAll(): java.lang.UnsupportedOperationException
</span><span class="cm">remove(): java.lang.UnsupportedOperationException
</span><span class="cm">--- unmodifiableList() ---
</span><span class="cm">retainAll(): java.lang.UnsupportedOperationException
</span><span class="cm">removeAll(): java.lang.UnsupportedOperationException
</span><span class="cm">clear(): java.lang.UnsupportedOperationException
</span><span class="cm">add(): java.lang.UnsupportedOperationException
</span><span class="cm">addAll(): java.lang.UnsupportedOperationException
</span><span class="cm">remove(): java.lang.UnsupportedOperationException
</span><span class="cm">List.set(): java.lang.UnsupportedOperationException
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><p>把<code>Arrays.asList()</code>的结果作为构造器的参数传递给任何<code>Collection</code>，这样可以生成允许使用所有的方法的普通容器</p>
<h2 id="5list的功能方法">5.List的功能方法</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/Lists.java
</span><span class="c1">// Things you can do with Lists.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Lists</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="n">b</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">s</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">it</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="n">ListIterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lit</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">basicTest</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">a</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="s">&#34;x&#34;</span><span class="o">);</span> <span class="c1">// Add at location 1
</span><span class="c1"></span>    <span class="n">a</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;x&#34;</span><span class="o">);</span> <span class="c1">// Add at end
</span><span class="c1"></span>    <span class="c1">// Add a collection:
</span><span class="c1"></span>    <span class="n">a</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="c1">// Add a collection starting at location 3:
</span><span class="c1"></span>    <span class="n">a</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">3</span><span class="o">,</span> <span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">&#34;1&#34;</span><span class="o">);</span> <span class="c1">// Is it in there?
</span><span class="c1"></span>    <span class="c1">// Is the entire collection in there?
</span><span class="c1"></span>    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="c1">// Lists allow random access, which is cheap
</span><span class="c1"></span>    <span class="c1">// for ArrayList, expensive for LinkedList:
</span><span class="c1"></span>    <span class="n">s</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">1</span><span class="o">);</span> <span class="c1">// Get (typed) object at location 1
</span><span class="c1"></span>    <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">&#34;1&#34;</span><span class="o">);</span> <span class="c1">// Tell index of object
</span><span class="c1"></span>    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span> <span class="c1">// Any elements inside?
</span><span class="c1"></span>    <span class="n">it</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> <span class="c1">// Ordinary Iterator
</span><span class="c1"></span>    <span class="n">lit</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">listIterator</span><span class="o">();</span> <span class="c1">// ListIterator
</span><span class="c1"></span>    <span class="n">lit</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">listIterator</span><span class="o">(</span><span class="n">3</span><span class="o">);</span> <span class="c1">// Start at loc 3
</span><span class="c1"></span>    <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">&#34;1&#34;</span><span class="o">);</span> <span class="c1">// Last match
</span><span class="c1"></span>    <span class="n">a</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">1</span><span class="o">);</span> <span class="c1">// Remove location 1
</span><span class="c1"></span>    <span class="n">a</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="s">&#34;3&#34;</span><span class="o">);</span> <span class="c1">// Remove this object
</span><span class="c1"></span>    <span class="n">a</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="s">&#34;y&#34;</span><span class="o">);</span> <span class="c1">// Set location 1 to &#34;y&#34;
</span><span class="c1"></span>    <span class="c1">// Keep everything that&#39;s in the argument
</span><span class="c1"></span>    <span class="c1">// (the intersection of the two sets):
</span><span class="c1"></span>    <span class="n">a</span><span class="o">.</span><span class="na">retainAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="c1">// Remove everything that&#39;s in the argument:
</span><span class="c1"></span>    <span class="n">a</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="c1">// How big is it?
</span><span class="c1"></span>    <span class="n">a</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span> <span class="c1">// Remove all elements
</span><span class="c1"></span>  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">iterMotion</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ListIterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">listIterator</span><span class="o">();</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">();</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">hasPrevious</span><span class="o">();</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">nextIndex</span><span class="o">();</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">previous</span><span class="o">();</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">previousIndex</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">iterManipulation</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ListIterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">listIterator</span><span class="o">();</span>
    <span class="n">it</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;47&#34;</span><span class="o">);</span>
    <span class="c1">// Must move to an element after add():
</span><span class="c1"></span>    <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
    <span class="c1">// Remove the element after the newly produced one:
</span><span class="c1"></span>    <span class="n">it</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
    <span class="c1">// Must move to an element after remove():
</span><span class="c1"></span>    <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
    <span class="c1">// Change the element after the deleted one:
</span><span class="c1"></span>    <span class="n">it</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;47&#34;</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testVisual</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">print</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;b = &#34;</span> <span class="o">+</span> <span class="n">b</span><span class="o">);</span>
    <span class="n">a</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
    <span class="n">a</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
    <span class="c1">// Insert, remove, and replace elements
</span><span class="c1"></span>    <span class="c1">// using a ListIterator:
</span><span class="c1"></span>    <span class="n">ListIterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">listIterator</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">size</span><span class="o">()/</span><span class="n">2</span><span class="o">);</span>
    <span class="n">x</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;one&#34;</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
    <span class="n">x</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
    <span class="n">print</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
    <span class="n">x</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;47&#34;</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
    <span class="c1">// Traverse the list backwards:
</span><span class="c1"></span>    <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">listIterator</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
    <span class="k">while</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">hasPrevious</span><span class="o">())</span>
      <span class="n">printnb</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">previous</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; &#34;</span><span class="o">);</span>
    <span class="n">print</span><span class="o">();</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;testVisual finished&#34;</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="c1">// There are some things that only LinkedLists can do:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testLinkedList</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">ll</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">ll</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">ll</span><span class="o">);</span>
    <span class="c1">// Treat it like a stack, pushing:
</span><span class="c1"></span>    <span class="n">ll</span><span class="o">.</span><span class="na">addFirst</span><span class="o">(</span><span class="s">&#34;one&#34;</span><span class="o">);</span>
    <span class="n">ll</span><span class="o">.</span><span class="na">addFirst</span><span class="o">(</span><span class="s">&#34;two&#34;</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">ll</span><span class="o">);</span>
    <span class="c1">// Like &#34;peeking&#34; at the top of a stack:
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="n">ll</span><span class="o">.</span><span class="na">getFirst</span><span class="o">());</span>
    <span class="c1">// Like popping a stack:
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="n">ll</span><span class="o">.</span><span class="na">removeFirst</span><span class="o">());</span>
    <span class="n">print</span><span class="o">(</span><span class="n">ll</span><span class="o">.</span><span class="na">removeFirst</span><span class="o">());</span>
    <span class="c1">// Treat it like a queue, pulling elements
</span><span class="c1"></span>    <span class="c1">// off the tail end:
</span><span class="c1"></span>    <span class="n">print</span><span class="o">(</span><span class="n">ll</span><span class="o">.</span><span class="na">removeLast</span><span class="o">());</span>
    <span class="n">print</span><span class="o">(</span><span class="n">ll</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Make and fill a new list each time:
</span><span class="c1"></span>    <span class="n">basicTest</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">)));</span>
    <span class="n">basicTest</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">)));</span>
    <span class="n">iterMotion</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">)));</span>
    <span class="n">iterMotion</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">)));</span>
    <span class="n">iterManipulation</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">)));</span>
    <span class="n">iterManipulation</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">)));</span>
    <span class="n">testVisual</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">Countries</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">25</span><span class="o">)));</span>
    <span class="n">testLinkedList</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* (Execute to see output) */</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h2 id="6set和存储顺序">6.Set和存储顺序</h2>
<ul>
<li>Set(interface)：存入<code>Set</code>的每个元素都必须是唯一的，因为<code>Set</code>不保存重复元素，加入<code>Set</code>的元素必须定义<code>equals()</code>方法以确保对象的唯一性。<code>Set</code>与<code>Collection</code>有完全一样的接口。<code>Set</code>接口不保证维护元素的次序。</li>
<li>HashSet：为快速查找而设计的<code>Set</code>，存入<code>HashSet</code>的元素必须定义<code>hasCode()</code>。</li>
<li>TreeSet：保持次序的Set，底层为树结构，使用它可以从<code>Set</code>中提取有序的序列，元素必须实现<code>Comparable</code>接口。</li>
<li>LinkedHashSet：具有<code>HashSet</code>的查询速度，且内部使用链表维护元素的顺序。于是在使用迭代器遍历<code>Set</code>时，结果会按元素插入的次序显示，元素也必须定义<code>hashCode()</code>方法。</li>
</ul>
<p>你必须为散列存储和树型存储都创建一个<code>equals()</code>方法。但是<code>hashCode()</code>只有在这个类将会被置于<code>HashSet</code>或者<code>LinkedHashSet</code>中时才是必须的。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/TypesForSets.java
</span><span class="c1">// Methods necessary to put your own type in a Set.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">SetType</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">SetType</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">o</span> <span class="k">instanceof</span> <span class="n">SetType</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="o">((</span><span class="n">SetType</span><span class="o">)</span><span class="n">o</span><span class="o">).</span><span class="na">i</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">);</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">HashType</span> <span class="kd">extends</span> <span class="n">SetType</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">HashType</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">n</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">i</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">TreeType</span> <span class="kd">extends</span> <span class="n">SetType</span> <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">TreeType</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">TreeType</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">n</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">TreeType</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">arg</span><span class="o">.</span><span class="na">i</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">?</span> <span class="o">-</span><span class="n">1</span> <span class="o">:</span> <span class="o">(</span><span class="n">arg</span><span class="o">.</span><span class="na">i</span> <span class="o">==</span> <span class="n">i</span> <span class="o">?</span> <span class="n">0</span> <span class="o">:</span> <span class="n">1</span><span class="o">));</span><span class="c1">//倒序
</span><span class="c1"></span>  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TypesForSets</span> <span class="o">{</span>
  <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">fill</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">set</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
          <span class="n">set</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">type</span><span class="o">.</span><span class="na">getConstructor</span><span class="o">(</span><span class="kt">int</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">newInstance</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">set</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">set</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">fill</span><span class="o">(</span><span class="n">set</span><span class="o">,</span> <span class="n">type</span><span class="o">);</span>
    <span class="n">fill</span><span class="o">(</span><span class="n">set</span><span class="o">,</span> <span class="n">type</span><span class="o">);</span> <span class="c1">// Try to add duplicates
</span><span class="c1"></span>    <span class="n">fill</span><span class="o">(</span><span class="n">set</span><span class="o">,</span> <span class="n">type</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">set</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">HashType</span><span class="o">&gt;(),</span> <span class="n">HashType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;</span><span class="n">HashType</span><span class="o">&gt;(),</span> <span class="n">HashType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">TreeSet</span><span class="o">&lt;</span><span class="n">TreeType</span><span class="o">&gt;(),</span> <span class="n">TreeType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="c1">// Things that don&#39;t work:
</span><span class="c1"></span>    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">SetType</span><span class="o">&gt;(),</span> <span class="n">SetType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">TreeType</span><span class="o">&gt;(),</span> <span class="n">TreeType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;</span><span class="n">SetType</span><span class="o">&gt;(),</span> <span class="n">SetType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;</span><span class="n">TreeType</span><span class="o">&gt;(),</span> <span class="n">TreeType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">TreeSet</span><span class="o">&lt;</span><span class="n">SetType</span><span class="o">&gt;(),</span> <span class="n">SetType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">TreeSet</span><span class="o">&lt;</span><span class="n">HashType</span><span class="o">&gt;(),</span> <span class="n">HashType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output: (Sample)
</span><span class="cm">[2, 4, 9, 8, 6, 1, 3, 7, 5, 0]
</span><span class="cm">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</span><span class="cm">[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
</span><span class="cm">[9, 9, 7, 5, 1, 2, 6, 3, 0, 7, 2, 4, 4, 7, 9, 1, 3, 6, 2, 4, 3, 0, 5, 0, 8, 8, 8, 6, 5, 1]//存储在HashSet的SetType
</span><span class="cm">[0, 5, 5, 6, 5, 0, 3, 1, 9, 8, 4, 2, 3, 9, 7, 3, 4, 4, 0, 7, 1, 9, 6, 2, 1, 8, 2, 8, 6, 7]//存储在HashSet的TreeType
</span><span class="cm">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</span><span class="cm">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</span><span class="cm">java.lang.ClassCastException: SetType cannot be cast to java.lang.Comparable
</span><span class="cm">java.lang.ClassCastException: HashType cannot be cast to java.lang.Comparable
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><p>对于没有重新定义<code>hashCode()</code>方法的<code>SetType</code>或<code>TreeType</code>，如果将它们放置到任何散列实现中都会产生重复值，这样就违反了<code>Set</code>的基本契约。如果尝试着在<code>TreeSet</code>中使用没有实现<code>Comparable</code>的类型，将会抛出一个异常。</p>
<h3 id="61-sortedset">6.1 SortedSet</h3>
<ul>
<li>Object first()：返回容器中的第一个元素</li>
<li>Object last()：返回容器中的最末一个元素</li>
<li>Sorted subSet(fromElement,toElement)：生成此<code>Set</code>的子集，范围从<code>fromElement</code>（包含）到<code>toElement</code>（不包含）。</li>
<li>Sorted headSet(toElement)：生成此<code>Set</code>的子集，由小于<code>toElement</code>的元素组成。</li>
<li>Sorted tailSet(fromElement)：生成此<code>Set</code>的子集，由大于或等于<code>fromElement</code>的元素组成。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/SortedSetDemo.java
</span><span class="c1">// What you can do with a TreeSet.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SortedSetDemo</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">SortedSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">sortedSet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TreeSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">Collections</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">sortedSet</span><span class="o">,</span>
      <span class="s">&#34;one two three four five six seven eight&#34;</span>
        <span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34; &#34;</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">sortedSet</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">low</span> <span class="o">=</span> <span class="n">sortedSet</span><span class="o">.</span><span class="na">first</span><span class="o">();</span>
    <span class="n">String</span> <span class="n">high</span> <span class="o">=</span> <span class="n">sortedSet</span><span class="o">.</span><span class="na">last</span><span class="o">();</span>
    <span class="n">print</span><span class="o">(</span><span class="n">low</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">high</span><span class="o">);</span>
    <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">sortedSet</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">6</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="k">if</span><span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">3</span><span class="o">)</span> <span class="n">low</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
      <span class="k">if</span><span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">6</span><span class="o">)</span> <span class="n">high</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
      <span class="k">else</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="n">print</span><span class="o">(</span><span class="n">low</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">high</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">sortedSet</span><span class="o">.</span><span class="na">subSet</span><span class="o">(</span><span class="n">low</span><span class="o">,</span> <span class="n">high</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">sortedSet</span><span class="o">.</span><span class="na">headSet</span><span class="o">(</span><span class="n">high</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">sortedSet</span><span class="o">.</span><span class="na">tailSet</span><span class="o">(</span><span class="n">low</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">[eight, five, four, one, seven, six, three, two]
</span><span class="cm">eight
</span><span class="cm">two
</span><span class="cm">one
</span><span class="cm">two
</span><span class="cm">[one, seven, six, three]
</span><span class="cm">[eight, five, four, one, seven, six, three]
</span><span class="cm">[one, seven, six, three, two]
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h2 id="7队列">7.队列</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/QueueBehavior.java
</span><span class="c1">// Compares the behavior of some of the queues
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.concurrent.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">QueueBehavior</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">10</span><span class="o">;</span>
  <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="n">Queue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">queue</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">gen</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
    <span class="k">while</span><span class="o">(</span><span class="n">queue</span><span class="o">.</span><span class="na">peek</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">queue</span><span class="o">.</span><span class="na">remove</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; &#34;</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Gen</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">s</span> <span class="o">=</span> <span class="o">(</span><span class="s">&#34;one two three four five six seven &#34;</span> <span class="o">+</span>
      <span class="s">&#34;eight nine ten&#34;</span><span class="o">).</span><span class="na">split</span><span class="o">(</span><span class="s">&#34; &#34;</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">s</span><span class="o">[</span><span class="n">i</span><span class="o">++];</span> <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(),</span> <span class="k">new</span> <span class="n">Gen</span><span class="o">());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">PriorityQueue</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(),</span> <span class="k">new</span> <span class="n">Gen</span><span class="o">());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayBlockingQueue</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">count</span><span class="o">),</span> <span class="k">new</span> <span class="n">Gen</span><span class="o">());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">ConcurrentLinkedQueue</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(),</span> <span class="k">new</span> <span class="n">Gen</span><span class="o">());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedBlockingQueue</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(),</span> <span class="k">new</span> <span class="n">Gen</span><span class="o">());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">PriorityBlockingQueue</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(),</span> <span class="k">new</span> <span class="n">Gen</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">one two three four five six seven eight nine ten
</span><span class="cm">eight five four nine one seven six ten three two
</span><span class="cm">one two three four five six seven eight nine ten
</span><span class="cm">one two three four five six seven eight nine ten
</span><span class="cm">one two three four five six seven eight nine ten
</span><span class="cm">eight five four nine one seven six ten three two
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><p>除了优先级队列，<code>Queue</code>将精确地按照元素被置于<code>Queue</code>中的顺序产生它们。</p>
<h3 id="71-优先级队列">7.1 优先级队列</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/ToDoList.java
</span><span class="c1">// A more complex use of PriorityQueue.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">ToDoList</span> <span class="kd">extends</span> <span class="n">PriorityQueue</span><span class="o">&lt;</span><span class="n">ToDoList</span><span class="o">.</span><span class="na">ToDoItem</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ToDoItem</span> <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">ToDoItem</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">char</span> <span class="n">primary</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">secondary</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">item</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">ToDoItem</span><span class="o">(</span><span class="n">String</span> <span class="n">td</span><span class="o">,</span> <span class="kt">char</span> <span class="n">pri</span><span class="o">,</span> <span class="kt">int</span> <span class="n">sec</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">primary</span> <span class="o">=</span> <span class="n">pri</span><span class="o">;</span>
      <span class="n">secondary</span> <span class="o">=</span> <span class="n">sec</span><span class="o">;</span>
      <span class="n">item</span> <span class="o">=</span> <span class="n">td</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">ToDoItem</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">if</span><span class="o">(</span><span class="n">primary</span> <span class="o">&gt;</span> <span class="n">arg</span><span class="o">.</span><span class="na">primary</span><span class="o">)</span>
        <span class="k">return</span> <span class="o">+</span><span class="n">1</span><span class="o">;</span>
      <span class="k">if</span><span class="o">(</span><span class="n">primary</span> <span class="o">==</span> <span class="n">arg</span><span class="o">.</span><span class="na">primary</span><span class="o">)</span>
        <span class="k">if</span><span class="o">(</span><span class="n">secondary</span> <span class="o">&gt;</span> <span class="n">arg</span><span class="o">.</span><span class="na">secondary</span><span class="o">)</span>
          <span class="k">return</span> <span class="o">+</span><span class="n">1</span><span class="o">;</span>
        <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">secondary</span> <span class="o">==</span> <span class="n">arg</span><span class="o">.</span><span class="na">secondary</span><span class="o">)</span>
          <span class="k">return</span> <span class="n">0</span><span class="o">;</span>
      <span class="k">return</span> <span class="o">-</span><span class="n">1</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">Character</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">primary</span><span class="o">)</span> <span class="o">+</span>
        <span class="n">secondary</span> <span class="o">+</span> <span class="s">&#34;: &#34;</span> <span class="o">+</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">String</span> <span class="n">td</span><span class="o">,</span> <span class="kt">char</span> <span class="n">pri</span><span class="o">,</span> <span class="kt">int</span> <span class="n">sec</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ToDoItem</span><span class="o">(</span><span class="n">td</span><span class="o">,</span> <span class="n">pri</span><span class="o">,</span> <span class="n">sec</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ToDoList</span> <span class="n">toDoList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ToDoList</span><span class="o">();</span>
    <span class="n">toDoList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;Empty trash&#34;</span><span class="o">,</span> <span class="sc">&#39;C&#39;</span><span class="o">,</span> <span class="n">4</span><span class="o">);</span>
    <span class="n">toDoList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;Feed dog&#34;</span><span class="o">,</span> <span class="sc">&#39;A&#39;</span><span class="o">,</span> <span class="n">2</span><span class="o">);</span>
    <span class="n">toDoList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;Feed bird&#34;</span><span class="o">,</span> <span class="sc">&#39;B&#39;</span><span class="o">,</span> <span class="n">7</span><span class="o">);</span>
    <span class="n">toDoList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;Mow lawn&#34;</span><span class="o">,</span> <span class="sc">&#39;C&#39;</span><span class="o">,</span> <span class="n">3</span><span class="o">);</span>
    <span class="n">toDoList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;Water lawn&#34;</span><span class="o">,</span> <span class="sc">&#39;A&#39;</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
    <span class="n">toDoList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;Feed cat&#34;</span><span class="o">,</span> <span class="sc">&#39;B&#39;</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
    <span class="k">while</span><span class="o">(!</span><span class="n">toDoList</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">toDoList</span><span class="o">.</span><span class="na">remove</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">A1: Water lawn
</span><span class="cm">A2: Feed dog
</span><span class="cm">B1: Feed cat
</span><span class="cm">B7: Feed bird
</span><span class="cm">C3: Mow lawn
</span><span class="cm">C4: Empty trash
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h3 id="72双向队列">7.2双向队列</h3>
<p>在<code>LinkedList</code>中包含支持双向队列的方法，但是在<code>Java</code>标准类库中没有任何显式的用于双向队列的接口（本书基于JavaSE5，JavaSE6增加了<code>Deque</code>的接口）。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: net/mindview/util/Deque.java
</span><span class="c1">// Creating a Deque from a LinkedList.
</span><span class="c1"></span><span class="kn">package</span> <span class="nn">net.mindview.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Deque</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">deque</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addFirst</span><span class="o">(</span><span class="n">T</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> <span class="n">deque</span><span class="o">.</span><span class="na">addFirst</span><span class="o">(</span><span class="n">e</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addLast</span><span class="o">(</span><span class="n">T</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> <span class="n">deque</span><span class="o">.</span><span class="na">addLast</span><span class="o">(</span><span class="n">e</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="n">T</span> <span class="nf">getFirst</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">deque</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="n">T</span> <span class="nf">getLast</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">deque</span><span class="o">.</span><span class="na">getLast</span><span class="o">();</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="n">T</span> <span class="nf">removeFirst</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">deque</span><span class="o">.</span><span class="na">removeFirst</span><span class="o">();</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="n">T</span> <span class="nf">removeLast</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">deque</span><span class="o">.</span><span class="na">removeLast</span><span class="o">();</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">deque</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">deque</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span> <span class="o">}</span>
  <span class="c1">// And other methods as necessary...
</span><span class="c1"></span><span class="o">}</span> <span class="c1">///:~
</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/DequeTest.java
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DequeTest</span> <span class="o">{</span>
  <span class="kd">static</span> <span class="kt">void</span> <span class="nf">fillTest</span><span class="o">(</span><span class="n">Deque</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">deque</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">20</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">27</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="n">deque</span><span class="o">.</span><span class="na">addFirst</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">50</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">55</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="n">deque</span><span class="o">.</span><span class="na">addLast</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Deque</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">di</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Deque</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
    <span class="n">fillTest</span><span class="o">(</span><span class="n">di</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">di</span><span class="o">);</span>
    <span class="k">while</span><span class="o">(</span><span class="n">di</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">!=</span> <span class="n">0</span><span class="o">)</span>
      <span class="n">printnb</span><span class="o">(</span><span class="n">di</span><span class="o">.</span><span class="na">removeFirst</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; &#34;</span><span class="o">);</span>
    <span class="n">print</span><span class="o">();</span>
    <span class="n">fillTest</span><span class="o">(</span><span class="n">di</span><span class="o">);</span>
    <span class="k">while</span><span class="o">(</span><span class="n">di</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">!=</span> <span class="n">0</span><span class="o">)</span>
      <span class="n">printnb</span><span class="o">(</span><span class="n">di</span><span class="o">.</span><span class="na">removeLast</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; &#34;</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">[26, 25, 24, 23, 22, 21, 20, 50, 51, 52, 53, 54]
</span><span class="cm">26 25 24 23 22 21 20 50 51 52 53 54
</span><span class="cm">54 53 52 51 50 20 21 22 23 24 25 26
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h2 id="8map">8.Map</h2>
<p><img src="https://i.imgur.com/iwoHbui.png" alt="Imgur"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/AssociativeArray.java
</span><span class="c1">// Associates keys with values.
</span><span class="c1"></span><span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AssociativeArray</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">Object</span><span class="o">[][]</span> <span class="n">pairs</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">AssociativeArray</span><span class="o">(</span><span class="kt">int</span> <span class="n">length</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pairs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">length</span><span class="o">][</span><span class="n">2</span><span class="o">];</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">put</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">pairs</span><span class="o">.</span><span class="na">length</span><span class="o">)</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">ArrayIndexOutOfBoundsException</span><span class="o">();</span>
    <span class="n">pairs</span><span class="o">[</span><span class="n">index</span><span class="o">++]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]{</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span> <span class="o">};</span>
  <span class="o">}</span>
  <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">&#34;unchecked&#34;</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">V</span> <span class="nf">get</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">index</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="k">if</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">pairs</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">0</span><span class="o">]))</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">V</span><span class="o">)</span><span class="n">pairs</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">1</span><span class="o">];</span>
    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span> <span class="c1">// Did not find key
</span><span class="c1"></span>  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">StringBuilder</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">index</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">pairs</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">());</span>
      <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34; : &#34;</span><span class="o">);</span>
      <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">pairs</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">1</span><span class="o">].</span><span class="na">toString</span><span class="o">());</span>
      <span class="k">if</span><span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">index</span> <span class="o">-</span> <span class="n">1</span><span class="o">)</span>
        <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;\n&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">AssociativeArray</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span>
      <span class="k">new</span> <span class="n">AssociativeArray</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">6</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;sky&#34;</span><span class="o">,</span> <span class="s">&#34;blue&#34;</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;grass&#34;</span><span class="o">,</span> <span class="s">&#34;green&#34;</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;ocean&#34;</span><span class="o">,</span> <span class="s">&#34;dancing&#34;</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;tree&#34;</span><span class="o">,</span> <span class="s">&#34;tall&#34;</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;earth&#34;</span><span class="o">,</span> <span class="s">&#34;brown&#34;</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;sun&#34;</span><span class="o">,</span> <span class="s">&#34;warm&#34;</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;extra&#34;</span><span class="o">,</span> <span class="s">&#34;object&#34;</span><span class="o">);</span> <span class="c1">// Past the end
</span><span class="c1"></span>    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">ArrayIndexOutOfBoundsException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">print</span><span class="o">(</span><span class="s">&#34;Too many objects!&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">print</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;ocean&#34;</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">Too many objects!
</span><span class="cm">sky : blue
</span><span class="cm">grass : green
</span><span class="cm">ocean : dancing
</span><span class="cm">tree : tall
</span><span class="cm">earth : brown
</span><span class="cm">sun : warm
</span><span class="cm">dancing
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h3 id="81-性能">8.1 性能</h3>
<ul>
<li>HashMap：<code>Map</code>基于散列表的实现（它取代了Hashtable），插入和查询键值对的开销是固定的。可以通过构造器设置<code>容量</code>和<code>负载因子</code>，以调整容器的性能。</li>
<li>LinkedHashMap：类似于<code>HashMap</code>，但是迭代遍历的顺序是插入次序，或者是**最近最少使用（LRU）**的次序。只比<code>HashMap</code>慢一点，而在迭代访问时反而更快，因为它使用链表维护内部次序。</li>
<li>TreeMap：基于红黑树的实现。查看“键”或“键值对”时，它们会被排序（次序由Comparable或Comparator决定）。 <code>TreeMap</code>的特点在于，所得到的结果是经过排序的。<code>TreeMap</code>是唯一的带有<code>subMap()</code>方法的<code>Map</code>，它可以返回一个子树。</li>
<li>WeakHashMap：<code>弱键（weak key）</code>映射，允许释放映射所指向的对象，这是为解决某类特殊问题而设计的。如果映射之外没有引用指向某个“键”，则次“键”可以被垃圾收集器回收。</li>
<li>ConcurrentHashMap：一种线程安全的<code>Map</code>，它不涉及同步加锁。</li>
<li>IdentityHashMap：使用==替代<code>equals()</code>对“键”进行比较的散列映射。专为解决特殊问题而设计的。</li>
</ul>
<p>任何键都必须具有一个<code>equals()</code>方法；如果键被用于散列Map，那么它必须还具有恰当的<code>hashCode()</code>方法；如果键被用于<code>TreeMap</code>，那么它必须实现<code>Comparable</code>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/Maps.java
</span><span class="c1">// Things you can do with Maps.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.concurrent.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Maps</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printKeys</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">printnb</span><span class="o">(</span><span class="s">&#34;Size = &#34;</span> <span class="o">+</span> <span class="n">map</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;, &#34;</span><span class="o">);</span>
    <span class="n">printnb</span><span class="o">(</span><span class="s">&#34;Keys: &#34;</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">map</span><span class="o">.</span><span class="na">keySet</span><span class="o">());</span> <span class="c1">// Produce a Set of the keys
</span><span class="c1"></span>  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">print</span><span class="o">(</span><span class="n">map</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">());</span>
    <span class="n">map</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="k">new</span> <span class="n">CountingMapData</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="c1">// Map has &#39;Set&#39; behavior for keys:
</span><span class="c1"></span>    <span class="n">map</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="k">new</span> <span class="n">CountingMapData</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="n">printKeys</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
    <span class="c1">// Producing a Collection of the values:
</span><span class="c1"></span>    <span class="n">printnb</span><span class="o">(</span><span class="s">&#34;Values: &#34;</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">map</span><span class="o">.</span><span class="na">values</span><span class="o">());</span>
    <span class="n">print</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;map.containsKey(11): &#34;</span> <span class="o">+</span> <span class="n">map</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">11</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;map.get(11): &#34;</span> <span class="o">+</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">11</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;map.containsValue(\&#34;F0\&#34;): &#34;</span>
      <span class="o">+</span> <span class="n">map</span><span class="o">.</span><span class="na">containsValue</span><span class="o">(</span><span class="s">&#34;F0&#34;</span><span class="o">));</span>
    <span class="n">Integer</span> <span class="n">key</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">keySet</span><span class="o">().</span><span class="na">iterator</span><span class="o">().</span><span class="na">next</span><span class="o">();</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;First key in map: &#34;</span> <span class="o">+</span> <span class="n">key</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="n">printKeys</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;map.isEmpty(): &#34;</span> <span class="o">+</span> <span class="n">map</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
    <span class="n">map</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="k">new</span> <span class="n">CountingMapData</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="c1">// Operations on the Set change the Map:
</span><span class="c1"></span>    <span class="n">map</span><span class="o">.</span><span class="na">keySet</span><span class="o">().</span><span class="na">removeAll</span><span class="o">(</span><span class="n">map</span><span class="o">.</span><span class="na">keySet</span><span class="o">());</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;map.isEmpty(): &#34;</span> <span class="o">+</span> <span class="n">map</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">TreeMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">IdentityHashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">ConcurrentHashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;());</span>
    <span class="n">test</span><span class="o">(</span><span class="k">new</span> <span class="n">WeakHashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;());</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">HashMap
</span><span class="cm">Size = 25, Keys: [15, 8, 23, 16, 7, 22, 9, 21, 6, 1, 14, 24, 4, 19, 11, 18, 3, 12, 17, 2, 13, 20, 10, 5, 0]
</span><span class="cm">Values: [P0, I0, X0, Q0, H0, W0, J0, V0, G0, B0, O0, Y0, E0, T0, L0, S0, D0, M0, R0, C0, N0, U0, K0, F0, A0]
</span><span class="cm">{15=P0, 8=I0, 23=X0, 16=Q0, 7=H0, 22=W0, 9=J0, 21=V0, 6=G0, 1=B0, 14=O0, 24=Y0, 4=E0, 19=T0, 11=L0, 18=S0, 3=D0, 12=M0, 17=R0, 2=C0, 13=N0, 20=U0, 10=K0, 5=F0, 0=A0}
</span><span class="cm">map.containsKey(11): true
</span><span class="cm">map.get(11): L0
</span><span class="cm">map.containsValue(&#34;F0&#34;): true
</span><span class="cm">First key in map: 15
</span><span class="cm">Size = 24, Keys: [8, 23, 16, 7, 22, 9, 21, 6, 1, 14, 24, 4, 19, 11, 18, 3, 12, 17, 2, 13, 20, 10, 5, 0]
</span><span class="cm">map.isEmpty(): true
</span><span class="cm">map.isEmpty(): true
</span><span class="cm">...
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h3 id="82-sortedmap">8.2 SortedMap</h3>
<p>使用<code>SortedMap</code>，可以确保键处于排序状态。</p>
<ul>
<li>Comparator comparator()：返回当前<code>Map</code>使用的<code>Comparator</code>；或者返回 <code>null</code>，表示以自然方式排序。</li>
<li>T firstKey()：返回Map中的第一个键。</li>
<li>T lastKey()：返回Map中最末一个键。</li>
<li>SortedMap subMap(fromKey,toKey)：生成此Map的子集，范围由<code>fromKey</code>到<code>toKey</code>的键确定。</li>
<li>SortedMap headMap(toKey)：由键小于<code>toKey</code>的所有键值对组成。</li>
<li>SortedMap tailMap(fromKey)：由键大于或等于<code>fromKey</code>的所有键值对组成。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/SortedMapDemo.java
</span><span class="c1">// What you can do with a TreeMap.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SortedMapDemo</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">TreeMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">sortedMap</span> <span class="o">=</span>
      <span class="k">new</span> <span class="n">TreeMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">CountingMapData</span><span class="o">(</span><span class="n">10</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">sortedMap</span><span class="o">);</span>
    <span class="n">Integer</span> <span class="n">low</span> <span class="o">=</span> <span class="n">sortedMap</span><span class="o">.</span><span class="na">firstKey</span><span class="o">();</span>
    <span class="n">Integer</span> <span class="n">high</span> <span class="o">=</span> <span class="n">sortedMap</span><span class="o">.</span><span class="na">lastKey</span><span class="o">();</span>
    <span class="n">print</span><span class="o">(</span><span class="n">low</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">high</span><span class="o">);</span>
    <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">sortedMap</span><span class="o">.</span><span class="na">keySet</span><span class="o">().</span><span class="na">iterator</span><span class="o">();</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">6</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="k">if</span><span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">3</span><span class="o">)</span> <span class="n">low</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
      <span class="k">if</span><span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">6</span><span class="o">)</span> <span class="n">high</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
      <span class="k">else</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="n">print</span><span class="o">(</span><span class="n">low</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">high</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">sortedMap</span><span class="o">.</span><span class="na">subMap</span><span class="o">(</span><span class="n">low</span><span class="o">,</span> <span class="n">high</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">sortedMap</span><span class="o">.</span><span class="na">headMap</span><span class="o">(</span><span class="n">high</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">sortedMap</span><span class="o">.</span><span class="na">tailMap</span><span class="o">(</span><span class="n">low</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">{0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0, 9=J0}
</span><span class="cm">0
</span><span class="cm">9
</span><span class="cm">3
</span><span class="cm">7
</span><span class="cm">{3=D0, 4=E0, 5=F0, 6=G0}
</span><span class="cm">{0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0}
</span><span class="cm">{3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0, 9=J0}
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h3 id="83-linkedhashmap">8.3 LinkedHashMap</h3>
<p><code>LinkedHashMap</code>散列化所有的元素，但是在遍历键值对时，却又以元素的插入顺序返回键值对。此外，可以在构造器中设定<code>LinkedHashMap</code>，使之采用基于访问的<code>最近最少使用（LRU）</code>算法，于是没有被访问过的元素就会出现在队列的前面。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/LinkedHashMapDemo.java
</span><span class="c1">// What you can do with a LinkedHashMap.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedHashMapDemo</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">linkedMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">CountingMapData</span><span class="o">(</span><span class="n">9</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">linkedMap</span><span class="o">);</span>
    <span class="c1">// Least-recently-used order:
</span><span class="c1"></span>    <span class="n">linkedMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">16</span><span class="o">,</span> <span class="n">0</span><span class="o">.</span><span class="na">75f</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span><span class="c1">//
</span><span class="c1"></span>    <span class="n">linkedMap</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="k">new</span> <span class="n">CountingMapData</span><span class="o">(</span><span class="n">9</span><span class="o">));</span>
    <span class="n">print</span><span class="o">(</span><span class="n">linkedMap</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">6</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="c1">// Cause accesses:
</span><span class="c1"></span>      <span class="n">linkedMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">linkedMap</span><span class="o">);</span>
    <span class="n">linkedMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="n">linkedMap</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">{0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0}
</span><span class="cm">{0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0}
</span><span class="cm">{6=G0, 7=H0, 8=I0, 0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0}
</span><span class="cm">{6=G0, 7=H0, 8=I0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 0=A0}
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h2 id="9散列和散列码">9.散列和散列码</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/Groundhog.java
</span><span class="c1">// Looks plausible, but doesn&#39;t work as a HashMap key.
</span><span class="c1"></span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Groundhog</span> <span class="o">{</span>
  <span class="kd">protected</span> <span class="kt">int</span> <span class="n">number</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">Groundhog</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> <span class="n">number</span> <span class="o">=</span> <span class="n">n</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&#34;Groundhog #&#34;</span> <span class="o">+</span> <span class="n">number</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~
</span><span class="c1"></span>

<span class="c1">//: containers/Prediction.java
</span><span class="c1">// Predicting the weather with groundhogs.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Prediction</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">47</span><span class="o">);</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">shadow</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">.</span><span class="na">5</span><span class="o">;</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">shadow</span><span class="o">)</span>
      <span class="k">return</span> <span class="s">&#34;Six more weeks of Winter!&#34;</span><span class="o">;</span>
    <span class="k">else</span>
      <span class="k">return</span> <span class="s">&#34;Early Spring!&#34;</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~
</span><span class="c1"></span>
<span class="c1">//: containers/SpringDetector.java
</span><span class="c1">// What will the weather be?
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.lang.reflect.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringDetector</span> <span class="o">{</span>
  <span class="c1">// Uses a Groundhog or class derived from Groundhog:
</span><span class="c1"></span>  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Groundhog</span><span class="o">&gt;</span>
  <span class="kt">void</span> <span class="nf">detectSpring</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">Constructor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">ghog</span> <span class="o">=</span> <span class="n">type</span><span class="o">.</span><span class="na">getConstructor</span><span class="o">(</span><span class="kt">int</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">Groundhog</span><span class="o">,</span><span class="n">Prediction</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span>
      <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">Groundhog</span><span class="o">,</span><span class="n">Prediction</span><span class="o">&gt;();</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ghog</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">i</span><span class="o">),</span> <span class="k">new</span> <span class="n">Prediction</span><span class="o">());</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;map = &#34;</span> <span class="o">+</span> <span class="n">map</span><span class="o">);</span>
    <span class="n">Groundhog</span> <span class="n">gh</span> <span class="o">=</span> <span class="n">ghog</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
    <span class="n">print</span><span class="o">(</span><span class="s">&#34;Looking up prediction for &#34;</span> <span class="o">+</span> <span class="n">gh</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(</span><span class="n">map</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">gh</span><span class="o">))</span>
      <span class="n">print</span><span class="o">(</span><span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">gh</span><span class="o">));</span>
    <span class="k">else</span>
      <span class="n">print</span><span class="o">(</span><span class="s">&#34;Key not found: &#34;</span> <span class="o">+</span> <span class="n">gh</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">detectSpring</span><span class="o">(</span><span class="n">Groundhog</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">map = {Groundhog #3=Early Spring!, Groundhog #7=Early Spring!, Groundhog #5=Early Spring!, Groundhog #9=Six more weeks of Winter!, Groundhog #8=Six more weeks of Winter!, Groundhog #0=Six more weeks of Winter!, Groundhog #6=Early Spring!, Groundhog #4=Six more weeks of Winter!, Groundhog #1=Six more weeks of Winter!, Groundhog #2=Early Spring!}
</span><span class="cm">Looking up prediction for Groundhog #3
</span><span class="cm">Key not found: Groundhog #3
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><p>正确的<code>equals()</code>方法必须满足下列5个条件： 1. 自反性。对任意x，x.equals(x)一定返回<code>true</code>。 2. 对称性。对任意x和y，如果<code>y.equals(x)</code>返回<code>true</code>，则<code>x.equals(y)</code>也返回<code>true</code>。 3. 传递性。对任意x、y、z，如果有<code>x.equals(y)</code>返回<code>true</code>，则<code>x.equals(z)</code>一定返回<code>true</code>。 4. 一致性。对任意x和y，如果对象中用于等价比较的信息没有改变，那么无论调用<code>x.equals(y)</code>多少次，返回的结果应该保持一致，要么一直是<code>true</code>，要么一直是<code>false</code>。 5. 对任何不是<code>null</code>的x，<code>x.equals(null)</code>一定返回<code>false</code>。</p>
<p>同时重载<code>hashCode()</code>和<code>equals()</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/Groundhog2.java
</span><span class="c1">// A class that&#39;s used as a key in a HashMap
</span><span class="c1">// must override hashCode() and equals().
</span><span class="c1"></span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Groundhog2</span> <span class="kd">extends</span> <span class="n">Groundhog</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Groundhog2</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">n</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">number</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">o</span> <span class="k">instanceof</span> <span class="n">Groundhog2</span> <span class="o">&amp;&amp;</span>
      <span class="o">(</span><span class="n">number</span> <span class="o">==</span> <span class="o">((</span><span class="n">Groundhog2</span><span class="o">)</span><span class="n">o</span><span class="o">).</span><span class="na">number</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~
</span><span class="c1"></span>
<span class="c1">//: containers/SpringDetector2.java
</span><span class="c1">// A working key.
</span><span class="c1"></span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringDetector2</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">SpringDetector</span><span class="o">.</span><span class="na">detectSpring</span><span class="o">(</span><span class="n">Groundhog2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">map = {Groundhog #2=Early Spring!, Groundhog #4=Six more weeks of Winter!, Groundhog #9=Six more weeks of Winter!, Groundhog #8=Six more weeks of Winter!, Groundhog #6=Early Spring!, Groundhog #1=Six more weeks of Winter!, Groundhog #3=Early Spring!, Groundhog #7=Early Spring!, Groundhog #5=Early Spring!, Groundhog #0=Six more weeks of Winter!}
</span><span class="cm">Looking up prediction for Groundhog #3
</span><span class="cm">Early Spring!
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h3 id="91-理解hashcode">9.1 理解hashCode()</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/SlowMap.java
</span><span class="c1">// A Map implemented with ArrayLists.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SlowMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;();</span>
  <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;();</span>
  <span class="kd">public</span> <span class="n">V</span> <span class="nf">put</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">V</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="n">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span> <span class="c1">// The old value or null
</span><span class="c1"></span>    <span class="k">if</span><span class="o">(!</span><span class="n">keys</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">keys</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
      <span class="n">values</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span>
      <span class="n">values</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">keys</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">key</span><span class="o">),</span> <span class="n">value</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">oldValue</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">V</span> <span class="nf">get</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// key is type Object, not K
</span><span class="c1"></span>    <span class="k">if</span><span class="o">(!</span><span class="n">keys</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">key</span><span class="o">))</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">keys</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">key</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="nf">entrySet</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="n">set</span><span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;();</span>
    <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span> <span class="n">ki</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
    <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">vi</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
    <span class="k">while</span><span class="o">(</span><span class="n">ki</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span>
      <span class="n">set</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;(</span><span class="n">ki</span><span class="o">.</span><span class="na">next</span><span class="o">(),</span> <span class="n">vi</span><span class="o">.</span><span class="na">next</span><span class="o">()));</span>
    <span class="k">return</span> <span class="n">set</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">SlowMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">m</span><span class="o">=</span> <span class="k">new</span> <span class="n">SlowMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">m</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">capitals</span><span class="o">(</span><span class="n">15</span><span class="o">));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">m</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;BULGARIA&#34;</span><span class="o">));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">entrySet</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">{CAMEROON=Yaounde, CHAD=N&#39;djamena, CONGO=Brazzaville, CAPE VERDE=Praia, ALGERIA=Algiers, COMOROS=Moroni, CENTRAL AFRICAN REPUBLIC=Bangui, BOTSWANA=Gaberone, BURUNDI=Bujumbura, BENIN=Porto-Novo, BULGARIA=Sofia, EGYPT=Cairo, ANGOLA=Luanda, BURKINA FASO=Ouagadougou, DJIBOUTI=Dijibouti}
</span><span class="cm">Sofia
</span><span class="cm">[CAMEROON=Yaounde, CHAD=N&#39;djamena, CONGO=Brazzaville, CAPE VERDE=Praia, ALGERIA=Algiers, COMOROS=Moroni, CENTRAL AFRICAN REPUBLIC=Bangui, BOTSWANA=Gaberone, BURUNDI=Bujumbura, BENIN=Porto-Novo, BULGARIA=Sofia, EGYPT=Cairo, ANGOLA=Luanda, BURKINA FASO=Ouagadougou, DJIBOUTI=Dijibouti]
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/MapEntry.java
</span><span class="c1">// A simple Map.Entry for sample Map implementations.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">K</span> <span class="n">key</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">V</span> <span class="n">value</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">MapEntry</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">K</span> <span class="nf">getKey</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">key</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="n">V</span> <span class="nf">getValue</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="n">V</span> <span class="nf">setValue</span><span class="o">(</span><span class="n">V</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">V</span> <span class="n">result</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">v</span><span class="o">;</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">key</span><span class="o">==</span><span class="kc">null</span> <span class="o">?</span> <span class="n">0</span> <span class="o">:</span> <span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">())</span> <span class="o">^</span>
      <span class="o">(</span><span class="n">value</span><span class="o">==</span><span class="kc">null</span> <span class="o">?</span> <span class="n">0</span> <span class="o">:</span> <span class="n">value</span><span class="o">.</span><span class="na">hashCode</span><span class="o">());</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(!(</span><span class="n">o</span> <span class="k">instanceof</span> <span class="n">MapEntry</span><span class="o">))</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="n">MapEntry</span> <span class="n">me</span> <span class="o">=</span> <span class="o">(</span><span class="n">MapEntry</span><span class="o">)</span><span class="n">o</span><span class="o">;</span>
    <span class="k">return</span>
      <span class="o">(</span><span class="n">key</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span>
       <span class="n">me</span><span class="o">.</span><span class="na">getKey</span><span class="o">()</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">me</span><span class="o">.</span><span class="na">getKey</span><span class="o">()))</span> <span class="o">&amp;&amp;</span>
      <span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span>
       <span class="n">me</span><span class="o">.</span><span class="na">getValue</span><span class="o">()==</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">value</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">me</span><span class="o">.</span><span class="na">getValue</span><span class="o">()));</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">key</span> <span class="o">+</span> <span class="s">&#34;=&#34;</span> <span class="o">+</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span> <span class="c1">///:~
</span></code></pre></td></tr></table>
</div>
</div><h3 id="92-为速度而散列">9.2 为速度而散列</h3>
<p>散列将键保存在某处，以便能够很快找到。存储一组元素最快的数据结构是数组，所以使用它来表示键的信息。数组并不保存键本来。而是通过键对象生成一个数字，将其作为数组的下标。这个数字就是散列码，由定义在<code>Object</code>中的，且可能由你的类覆盖的<code>hashCode()</code>方法生成。</p>
<p>为解决数组容量被固定的问题，不同的键可以产生相同的下标。也就是说，可能会有<code>冲突</code>。因此，数组多大就不重要了，任何键总能在数组中找到它的位置。</p>
<p>于是查询一个值的过程首先就是计算散列码，然后使用散列码查询数组。如果能够保证没有冲突，那可就有一个<code>完美的散列函数</code>，但是这种情况只是特例。通常，冲突由<code>外部链接处理</code>：数组并不直接保存值，而是保存值的<code>list</code>。然后对<code>list</code>中的值使用<code>equals()</code>方法进行线性的查询。这部分的查询自然比较慢，但是，如果散列函数好的话，数组的每个位置就只有较少的值。因此，不是查询整个<code>list</code>，而是快速地跳到数组的某个位置，只对很少的元素进行比较。这便是<code>HashMap</code>会如此快的原因。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/SimpleHashMap.java
</span><span class="c1">// A demonstration hashed Map.
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.mindview.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleHashMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="c1">// Choose a prime number for the hash table
</span><span class="c1"></span>  <span class="c1">// size, to achieve a uniform distribution:
</span><span class="c1"></span>  <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">SIZE</span> <span class="o">=</span> <span class="n">997</span><span class="o">;</span>
  <span class="c1">// You can&#39;t have a physical array of generics,
</span><span class="c1"></span>  <span class="c1">// but you can upcast to one:
</span><span class="c1"></span>  <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">&#34;unchecked&#34;</span><span class="o">)</span>
  <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;[]</span> <span class="n">buckets</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">[</span><span class="n">SIZE</span><span class="o">];</span>
  <span class="kd">public</span> <span class="n">V</span> <span class="nf">put</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">V</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">())</span> <span class="o">%</span> <span class="n">SIZE</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">buckets</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
      <span class="n">buckets</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;();</span>
    <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="n">bucket</span> <span class="o">=</span> <span class="n">buckets</span><span class="o">[</span><span class="n">index</span><span class="o">];</span>
    <span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">pair</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="kt">boolean</span> <span class="n">found</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="n">ListIterator</span><span class="o">&lt;</span><span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="na">listIterator</span><span class="o">();</span>
    <span class="k">while</span><span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">iPair</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
      <span class="k">if</span><span class="o">(</span><span class="n">iPair</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">oldValue</span> <span class="o">=</span> <span class="n">iPair</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
        <span class="n">it</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">pair</span><span class="o">);</span> <span class="c1">// Replace old with new
</span><span class="c1"></span>        <span class="n">found</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">break</span><span class="o">;</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">if</span><span class="o">(!</span><span class="n">found</span><span class="o">)</span>
      <span class="n">buckets</span><span class="o">[</span><span class="n">index</span><span class="o">].</span><span class="na">add</span><span class="o">(</span><span class="n">pair</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">oldValue</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">V</span> <span class="nf">get</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">())</span> <span class="o">%</span> <span class="n">SIZE</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">buckets</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">for</span><span class="o">(</span><span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">iPair</span> <span class="o">:</span> <span class="n">buckets</span><span class="o">[</span><span class="n">index</span><span class="o">])</span>
      <span class="k">if</span><span class="o">(</span><span class="n">iPair</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">key</span><span class="o">))</span>
        <span class="k">return</span> <span class="n">iPair</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="nf">entrySet</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="n">set</span><span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;();</span>
    <span class="k">for</span><span class="o">(</span><span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;&gt;</span> <span class="n">bucket</span> <span class="o">:</span> <span class="n">buckets</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">if</span><span class="o">(</span><span class="n">bucket</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">continue</span><span class="o">;</span>
      <span class="k">for</span><span class="o">(</span><span class="n">MapEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">mpair</span> <span class="o">:</span> <span class="n">bucket</span><span class="o">)</span>
        <span class="n">set</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">mpair</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">set</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">SimpleHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">m</span> <span class="o">=</span>
      <span class="k">new</span> <span class="n">SimpleHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">m</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="n">Countries</span><span class="o">.</span><span class="na">capitals</span><span class="o">(</span><span class="n">25</span><span class="o">));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">m</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;ERITREA&#34;</span><span class="o">));</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">entrySet</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output:
</span><span class="cm">{CAMEROON=Yaounde, CONGO=Brazzaville, CHAD=N&#39;djamena, COTE D&#39;IVOIR (IVORY COAST)=Yamoussoukro, CENTRAL AFRICAN REPUBLIC=Bangui, GUINEA=Conakry, BOTSWANA=Gaberone, BISSAU=Bissau, EGYPT=Cairo, ANGOLA=Luanda, BURKINA FASO=Ouagadougou, ERITREA=Asmara, THE GAMBIA=Banjul, KENYA=Nairobi, GABON=Libreville, CAPE VERDE=Praia, ALGERIA=Algiers, COMOROS=Moroni, EQUATORIAL GUINEA=Malabo, BURUNDI=Bujumbura, BENIN=Porto-Novo, BULGARIA=Sofia, GHANA=Accra, DJIBOUTI=Dijibouti, ETHIOPIA=Addis Ababa}
</span><span class="cm">Asmara
</span><span class="cm">[CAMEROON=Yaounde, CONGO=Brazzaville, CHAD=N&#39;djamena, COTE D&#39;IVOIR (IVORY COAST)=Yamoussoukro, CENTRAL AFRICAN REPUBLIC=Bangui, GUINEA=Conakry, BOTSWANA=Gaberone, BISSAU=Bissau, EGYPT=Cairo, ANGOLA=Luanda, BURKINA FASO=Ouagadougou, ERITREA=Asmara, THE GAMBIA=Banjul, KENYA=Nairobi, GABON=Libreville, CAPE VERDE=Praia, ALGERIA=Algiers, COMOROS=Moroni, EQUATORIAL GUINEA=Malabo, BURUNDI=Bujumbura, BENIN=Porto-Novo, BULGARIA=Sofia, GHANA=Accra, DJIBOUTI=Dijibouti, ETHIOPIA=Addis Ababa]
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><p>由于散列表中“槽位”通常称为<code>桶位（bucket）</code>，因此我们将表示实际散列表的数组命名为<code>bucket</code>，为使散列分布均匀，桶的数量通常使用质数。注意，为了能够自动处理冲突，使用一个<code>LinkedList</code>的数组；每一个新的元素只是直接添加到list末尾的某个特定桶位中。</p>
<h3 id="93-覆盖hashcode">9.3 覆盖hashCode()</h3>
<p>首先，你无法控制<code>bucket</code>数组的下标值的产生。这个值依赖于具体的<code>HashMap</code>对象的容量，而容量的改变与容器的充满程度和负载因子有关。<code>hashCode()</code>生成的结果，经过处理后成为桶位的下标。</p>
<p>设计<code>hashCode()</code>时最重要的因素就是：无论何时，对同一个对象调用<code>hashCode()</code>都应该生成同样的值。如果将一个对象用<code>put()</code>添加进<code>HashMap</code>时产生一个<code>hashCode()</code>值，而用<code>get()</code>取出时却产生了另一个<code>hashCode</code>值，那么聚无法重新取得该对象了。所以，如果你的<code>hashCode()</code>方法依赖于对象中易变的数据，用户就要当心了，因为此数据变化时，<code>hashCode()</code>就会生成一个不同的散列码，相当于产生了一个不同的键。</p>
<p>此外，也不应该使<code>hashCode()</code>依赖于具有唯一性的对象信息，尤其是使用<code>this</code>的值，这只能产生很糟糕的<code>hashCode()</code>。因为这样无法生成一个新的键，使之与<code>put()</code>中原始的键值对中的键相同。</p>
<p>Effective Java 为怎样写出一份像样<code>hashCode()</code>给出了基本的指导： 1.给int变量result赋予某个非零值常量，例如17 2.为对象内每个有意义的域f（即每个可以做equals()操作的域）计算出一个int散列码c:</p>
<table>
<thead>
<tr>
<th style="text-align:left">域类型</th>
<th style="text-align:left">计算</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">boolean</td>
<td style="text-align:left">c=(f?0:1)</td>
</tr>
<tr>
<td style="text-align:left">byte、char、short或int</td>
<td style="text-align:left">c=(int)f</td>
</tr>
<tr>
<td style="text-align:left">long</td>
<td style="text-align:left">c=(int)(f^f&gt;&gt;&gt;32)</td>
</tr>
<tr>
<td style="text-align:left">float</td>
<td style="text-align:left">c=Float.floatToIntBits(f)</td>
</tr>
<tr>
<td style="text-align:left">double</td>
<td style="text-align:left">long l= Double.doubleToLongBits();c=(int)(l^(l&gt;&gt;&gt;32))</td>
</tr>
<tr>
<td style="text-align:left">Object,其equals()调用这个域的equals()</td>
<td style="text-align:left">c=f.hashCode()</td>
</tr>
<tr>
<td style="text-align:left">数组</td>
<td style="text-align:left">对每个元素应用上述规则</td>
</tr>
</tbody>
</table>
<p>3.合并计算得到的散列码</p>
<p>result = 37*result+c;</p>
<p>4.返回result. 5.检查hashCode()最后生成的结果，确保相同的对象有相同的散列码。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//: containers/CountedString.java
</span><span class="c1">// Creating a good hashCode().
</span><span class="c1"></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import static</span> <span class="nn">net.mindview.util.Print.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CountedString</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">created</span> <span class="o">=</span>
    <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">s</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">CountedString</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">str</span><span class="o">;</span>
    <span class="n">created</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
    <span class="c1">// id is the total number of instances
</span><span class="c1"></span>    <span class="c1">// of this string in use by CountedString:
</span><span class="c1"></span>    <span class="k">for</span><span class="o">(</span><span class="n">String</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">created</span><span class="o">)</span>
      <span class="k">if</span><span class="o">(</span><span class="n">s2</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">s</span><span class="o">))</span>
        <span class="n">id</span><span class="o">++;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&#34;String: &#34;</span> <span class="o">+</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&#34; id: &#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span>
      <span class="s">&#34; hashCode(): &#34;</span> <span class="o">+</span> <span class="n">hashCode</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// The very simple approach:
</span><span class="c1"></span>    <span class="c1">// return s.hashCode() * id;
</span><span class="c1"></span>    <span class="c1">// Using Joshua Bloch&#39;s recipe:
</span><span class="c1"></span>    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">17</span><span class="o">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">37</span> <span class="o">*</span> <span class="n">result</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="na">hashCode</span><span class="o">();</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">37</span> <span class="o">*</span> <span class="n">result</span> <span class="o">+</span> <span class="n">id</span><span class="o">;</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">o</span> <span class="k">instanceof</span> <span class="n">CountedString</span> <span class="o">&amp;&amp;</span>
      <span class="n">s</span><span class="o">.</span><span class="na">equals</span><span class="o">(((</span><span class="n">CountedString</span><span class="o">)</span><span class="n">o</span><span class="o">).</span><span class="na">s</span><span class="o">)</span> <span class="o">&amp;&amp;</span>
      <span class="n">id</span> <span class="o">==</span> <span class="o">((</span><span class="n">CountedString</span><span class="o">)</span><span class="n">o</span><span class="o">).</span><span class="na">id</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">CountedString</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span>
      <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">CountedString</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;();</span>
    <span class="n">CountedString</span><span class="o">[]</span> <span class="n">cs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CountedString</span><span class="o">[</span><span class="n">5</span><span class="o">];</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cs</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">cs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CountedString</span><span class="o">(</span><span class="s">&#34;hi&#34;</span><span class="o">);</span>
      <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">cs</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">i</span><span class="o">);</span> <span class="c1">// Autobox int -&gt; Integer
</span><span class="c1"></span>    <span class="o">}</span>
    <span class="n">print</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="n">CountedString</span> <span class="n">cstring</span> <span class="o">:</span> <span class="n">cs</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">print</span><span class="o">(</span><span class="s">&#34;Looking up &#34;</span> <span class="o">+</span> <span class="n">cstring</span><span class="o">);</span>
      <span class="n">print</span><span class="o">(</span><span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cstring</span><span class="o">));</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="cm">/* Output: (Sample)
</span><span class="cm">{String: hi id: 4 hashCode(): 146450=3, String: hi id: 1 hashCode(): 146447=0, String: hi id: 3 hashCode(): 146449=2, String: hi id: 5 hashCode(): 146451=4, String: hi id: 2 hashCode(): 146448=1}
</span><span class="cm">Looking up String: hi id: 1 hashCode(): 146447
</span><span class="cm">0
</span><span class="cm">Looking up String: hi id: 2 hashCode(): 146448
</span><span class="cm">1
</span><span class="cm">Looking up String: hi id: 3 hashCode(): 146449
</span><span class="cm">2
</span><span class="cm">Looking up String: hi id: 4 hashCode(): 146450
</span><span class="cm">3
</span><span class="cm">Looking up String: hi id: 5 hashCode(): 146451
</span><span class="cm">4
</span><span class="cm">*/</span><span class="c1">//:~
</span></code></pre></td></tr></table>
</div>
</div><h2 id="10选择接口的不同实现">10.选择接口的不同实现</h2>
<h3 id="101-性能测试框架">10.1 性能测试框架</h3>
<h3 id="102-对list的选择">10.2 对List的选择</h3>
<h3 id="103-微基准测试的危险">10.3 微基准测试的危险</h3>
<h3 id="104-对set的选择">10.4 对Set的选择</h3>
<h3 id="105-对map的选择">10.5 对Map的选择</h3>
<h2 id="11实用方法">11.实用方法</h2>
<h3 id="111-list的排序和查询">11.1 List的排序和查询</h3>
<h3 id="112-设定collection或map为不可修改">11.2 设定Collection或Map为不可修改</h3>
<h3 id="113-collection或map的同步控制">11.3 Collection或Map的同步控制</h3>
<h2 id="12持有引用">12.持有引用</h2>
<h3 id="121-weakhashmap">12.1 WeakHashMap</h3>
<h2 id="13java1011的容器">13.Java1.0/1.1的容器</h2>
<h3 id="132-hashtable">13.2 Hashtable</h3>
<h3 id="133-stack">13.3 Stack</h3>
<h3 id="134-bitset">13.4 BitSet</h3>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">malinkang</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2013-07-02
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/thinking-in-java/">Thinking in Java</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/thinking-in-java-i-o/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">《Java编程思想》第18章I/O系统</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/thinking-in-java-arrays/">
            <span class="next-text nav-default">《Java编程思想》第16章数组</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'malinkang-cn';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://twitter.com/malinkang" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://github.com/malinkang" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/malinkang" class="iconfont icon-weibo" title="weibo"></a>
  <a href="https://malinkang.cn/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2021
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">malinkang</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.d7b7ada643c9c1a983026e177f141f7363b4640d619caf01d8831a6718cd44ea.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>
</html>
