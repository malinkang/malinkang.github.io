<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="《Java编程思想》第11章持有对象" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="第11章 持有对象" /><meta property="og:description" content="第11章 持有对象" /><link rel="canonical" href="https://malinkang.cn/posts/thinking-in-java-holding-your-objects/" /><meta property="og:url" content="https://malinkang.cn/posts/thinking-in-java-holding-your-objects/" /><meta property="og:site_name" content="malinkang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2013-05-21T21:39:36+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="《Java编程思想》第11章持有对象" /><meta name="twitter:site" content="@malinkang" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"第11章 持有对象","headline":"《Java编程思想》第11章持有对象","dateModified":"2013-05-21T21:39:36+08:00","url":"https://malinkang.cn/posts/thinking-in-java-holding-your-objects/","datePublished":"2013-05-21T21:39:36+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://malinkang.cn/posts/thinking-in-java-holding-your-objects/"},"@context":"https://schema.org"}</script><title>《Java编程思想》第11章持有对象 | malinkang</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="malinkang"><meta name="application-name" content="malinkang"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/images/avatar.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">malinkang</a></div><div class="site-subtitle font-italic">人生最可悲的事情，莫过于胸怀大志，却又虚度光阴。</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/malinkang" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/malinkang" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['linkang.ma','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>《Java编程思想》第11章持有对象</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>《Java编程思想》第11章持有对象</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> malinkang </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, May 21, 2013, 9:39 PM +0800" prep="on" > May 21, 2013 <i class="unloaded">2013-05-21T21:39:36+08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6727 words">37 min</span></div></div><div class="post-content"><h1 id="第11章-持有对象">第11章 持有对象</h1><h2 id="1泛型和类型安全的容器">1.泛型和类型安全的容器</h2><p><code class="language-plaintext highlighter-rouge">Apple</code>和<code class="language-plaintext highlighter-rouge">Orange</code>都放置在了容器中，然后将它们取出。正常情况下，<code class="language-plaintext highlighter-rouge">Java</code>编译器会报告警告信息，因为这个示例没有使用泛型。在这里，我们使用<code class="language-plaintext highlighter-rouge">Java SE5</code>所特有的注解来抑制了警告信息。注解以“@”符号开头，可以接受参数，这里的<code class="language-plaintext highlighter-rouge">@SuppressWarnings</code>注解及其参数标识只有有关“不受检查的异常”的警告信息应该被压制。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Apple</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">counter</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">id</span> <span class="o">=</span> <span class="n">counter</span><span class="o">++;</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">id</span><span class="o">(){</span> <span class="k">return</span> <span class="n">id</span><span class="o">;}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Orange</span><span class="o">{}</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApplesAndOrangesWithoutGenerics</span> <span class="o">{</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ArrayList</span> <span class="n">apples</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">apples</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Apple</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">apples</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Orange</span><span class="o">());</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">apples</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="o">((</span><span class="nc">Apple</span><span class="o">)</span><span class="n">apples</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">)).</span><span class="na">id</span><span class="o">();</span>
            <span class="c1">//Orange is detected only at run time</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
java.lang.ClassCastException: Orange cannot be cast to Apple
 */</span>
</pre></table></code></div></div><p>要想定义用来保存<code class="language-plaintext highlighter-rouge">Apple</code>对象的<code class="language-plaintext highlighter-rouge">ArrayList</code>，你可以声明<code class="language-plaintext highlighter-rouge">ArrayList&lt;Apple&gt;</code>，而不仅仅只是<code class="language-plaintext highlighter-rouge">ArrayList</code>。其中尖括号括起来的是<code class="language-plaintext highlighter-rouge">类型参数</code>，它指定了这个容器实例可以保存的类型。通过使用泛型，就可以在编译期防止将错误类型的对象放置到容器中。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApplesAndOrangesWithGenerics</span> <span class="o">{</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Apple</span><span class="o">&gt;</span> <span class="n">apples</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">apples</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Apple</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="c1">//编译错误</span>
        <span class="c1">//apples.add(new Orange());</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">apples</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">apples</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">id</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Apple</span> <span class="n">c</span> <span class="o">:</span> <span class="n">apples</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">id</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
输出
0
1
2
0
1
2
 */</span>
</pre></table></code></div></div><p>当你指定了某个类型作为泛型参数时，你并不仅限于只能将该确切类型的对象放置到容器中，向上转型也可以像作用域其他类型一样作用于泛型。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">GrannySmith</span> <span class="kd">extends</span> <span class="nc">Apple</span><span class="o">{}</span>
<span class="kd">class</span> <span class="nc">Gala</span> <span class="kd">extends</span> <span class="nc">Apple</span><span class="o">{}</span>
<span class="kd">class</span> <span class="nc">Fuji</span> <span class="kd">extends</span> <span class="nc">Apple</span><span class="o">{}</span>
<span class="kd">class</span> <span class="nc">Braeburn</span> <span class="kd">extends</span> <span class="nc">Apple</span><span class="o">{}</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenericsAndUpcasting</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Apple</span><span class="o">&gt;</span> <span class="n">apples</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Apple</span><span class="o">&gt;();</span>
        <span class="n">apples</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">GrannySmith</span><span class="o">());</span>
        <span class="n">apples</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Gala</span><span class="o">());</span>
        <span class="n">apples</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Fuji</span><span class="o">());</span>
        <span class="n">apples</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Braeburn</span><span class="o">());</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Apple</span> <span class="n">c</span> <span class="o">:</span><span class="n">apples</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
输出
GrannySmith@60e53b93
Gala@5e2de80c
Fuji@1d44bcfa
Braeburn@266474c2
 */</span>
</pre></table></code></div></div><h2 id="2基本概念">2.基本概念</h2><p><code class="language-plaintext highlighter-rouge">Java</code>容器类类库用途是“保存对象”，并将其划分为两个不同的概念。</p><ul><li>Collection：一个独立元素的序列，这些元素都服从一条或多条规则。<code class="language-plaintext highlighter-rouge">List</code>必须按照插入的顺序保存元素。而<code class="language-plaintext highlighter-rouge">Set</code>不能有重复元素。<code class="language-plaintext highlighter-rouge">Queue</code>按照排队规则来确定对象产生的顺序。<li>Map：一组成对的”键值对“对象，允许你使用键来查找值。</ul><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleCollection</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">Integer</span> <span class="nl">i:</span><span class="n">c</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">i</span><span class="o">+</span><span class="s">", "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 
 */</span>
</pre></table></code></div></div><h2 id="3添加一组元素">3.添加一组元素</h2><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddingGoups</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">collection</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">));</span>
        <span class="nc">Integer</span><span class="o">[]</span> <span class="n">moreInts</span> <span class="o">=</span> <span class="o">{</span><span class="mi">6</span><span class="o">,</span><span class="mi">7</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">10</span><span class="o">};</span>
        <span class="n">collection</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">moreInts</span><span class="o">));</span>
        <span class="nc">Collections</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">collection</span><span class="o">,</span><span class="mi">11</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">13</span><span class="o">,</span><span class="mi">14</span><span class="o">,</span><span class="mi">15</span><span class="o">);</span>
        <span class="nc">Collections</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">collection</span><span class="o">,</span><span class="n">moreInts</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">16</span><span class="o">,</span><span class="mi">17</span><span class="o">,</span><span class="mi">18</span><span class="o">,</span><span class="mi">19</span><span class="o">,</span><span class="mi">20</span><span class="o">);</span>
        <span class="n">list</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">99</span><span class="o">);</span>
        <span class="c1">//list.add(21); 运行时异常 </span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>可以直接使用<code class="language-plaintext highlighter-rouge">Arrays.asList()</code>的输出，将其当做<code class="language-plaintext highlighter-rouge">List</code>，但是在这种情况下，其底层表示的是数组，因此不能调整尺寸，如果视图用<code class="language-plaintext highlighter-rouge">add()</code>或<code class="language-plaintext highlighter-rouge">delete()</code>方法在这种列表中添加或删除元素就有可能会引发去改变数组尺寸的尝试，因此你将在运行时获得<code class="language-plaintext highlighter-rouge">Unsupported Operation（不支持的操作）</code>错误。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Snow</span><span class="o">{}</span>
<span class="kd">class</span> <span class="nc">Powder</span> <span class="kd">extends</span> <span class="nc">Snow</span><span class="o">{}</span>
<span class="kd">class</span> <span class="nc">Light</span> <span class="kd">extends</span> <span class="nc">Powder</span><span class="o">{}</span>
<span class="kd">class</span> <span class="nc">Heavy</span> <span class="kd">extends</span> <span class="nc">Powder</span><span class="o">{}</span>
<span class="kd">class</span> <span class="nc">Crusty</span> <span class="kd">extends</span> <span class="nc">Snow</span><span class="o">{}</span>
<span class="kd">class</span> <span class="nc">Slush</span> <span class="kd">extends</span> <span class="nc">Snow</span><span class="o">{}</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AsListInference</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Snow</span><span class="o">&gt;</span> <span class="n">snow1</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="k">new</span> <span class="nc">Crusty</span><span class="o">(),</span><span class="k">new</span> <span class="nc">Slush</span><span class="o">(),</span><span class="k">new</span> <span class="nc">Powder</span><span class="o">());</span>
        <span class="c1">//编译错误</span>
        <span class="c1">//List&lt;Snow&gt; snow2 = Arrays.asList(new Light(),new Heavy());</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Snow</span><span class="o">&gt;</span> <span class="n">snow3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Snow</span><span class="o">&gt;();</span>
        <span class="nc">Collections</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">snow3</span><span class="o">,</span><span class="k">new</span> <span class="nc">Light</span><span class="o">(),</span><span class="k">new</span> <span class="nc">Heavy</span><span class="o">());</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Snow</span><span class="o">&gt;</span> <span class="n">snow4</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.&lt;</span><span class="nc">Snow</span><span class="o">&gt;</span><span class="n">asList</span><span class="o">(</span><span class="k">new</span> <span class="nc">Light</span><span class="o">(),</span><span class="k">new</span> <span class="nc">Heavy</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>当试图创建<code class="language-plaintext highlighter-rouge">snow2</code>时，<code class="language-plaintext highlighter-rouge">Arrays.asList()</code>中只有<code class="language-plaintext highlighter-rouge">Powder</code>类型，因此它会创建<code class="language-plaintext highlighter-rouge">List&lt;Powder&gt;</code>而不是<code class="language-plaintext highlighter-rouge">List&lt;Snow&gt;</code>。<code class="language-plaintext highlighter-rouge">Collection.addAll()</code>工作的很好，因为它从第一个参数中了解到了目标类型是什么。</p><p>正如你从创建<code class="language-plaintext highlighter-rouge">snow4</code>的操作中所看到的，可以在<code class="language-plaintext highlighter-rouge">Arrays.asList()</code>中间插入一条“线索”，以告诉编译器对于由<code class="language-plaintext highlighter-rouge">Arrays.asList()</code>产生的<code class="language-plaintext highlighter-rouge">List</code>类型，实际的目标类型应该是什么。这称为<code class="language-plaintext highlighter-rouge">显式类型参考说明</code>。</p><h2 id="4容器的打印">4.容器的打印</h2><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PrintingContainers</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="nc">Collection</span> <span class="nf">fill</span><span class="o">(</span><span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">collection</span><span class="o">){</span>
        <span class="n">collection</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"rat"</span><span class="o">);</span>
        <span class="n">collection</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"cat"</span><span class="o">);</span>
        <span class="n">collection</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"dog"</span><span class="o">);</span>
        <span class="n">collection</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"dog"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">collection</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="nc">Map</span> <span class="nf">fill</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">){</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"rat"</span><span class="o">,</span><span class="s">"Fuzzy"</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"cat"</span><span class="o">,</span><span class="s">"Rags"</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"dog"</span><span class="o">,</span><span class="s">"Bosco"</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"dog"</span><span class="o">,</span><span class="s">"Spot"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">map</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fill</span><span class="o">(</span><span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fill</span><span class="o">(</span><span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fill</span><span class="o">(</span><span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fill</span><span class="o">(</span><span class="k">new</span> <span class="nc">TreeSet</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fill</span><span class="o">(</span><span class="k">new</span> <span class="nc">LinkedHashSet</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fill</span><span class="o">(</span><span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fill</span><span class="o">(</span><span class="k">new</span> <span class="nc">TreeMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;()));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fill</span><span class="o">(</span><span class="k">new</span> <span class="nc">LinkedHashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;()));</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
[rat, cat, dog, dog]
[rat, cat, dog, dog]
[rat, cat, dog]
[cat, dog, rat]
[rat, cat, dog]
{rat=Fuzzy, cat=Rags, dog=Spot}
{cat=Rags, dog=Spot, rat=Fuzzy}
{rat=Fuzzy, cat=Rags, dog=Spot}
 */</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">ArrayList</code>和<code class="language-plaintext highlighter-rouge">LinkedList</code>都是List类型，从输出可以看出，它们都按照被插入的顺序保存元素。两者的不同之处不仅在于执行某些类型的操作时的性能，而且<code class="language-plaintext highlighter-rouge">LinkedList</code>包含的操作也多于<code class="language-plaintext highlighter-rouge">ArrayList</code>。</p><p><code class="language-plaintext highlighter-rouge">TreeSet</code>按照比较结果的升序保存对象；<code class="language-plaintext highlighter-rouge">LinkedHashSet</code>按照被添加的顺序保存对象。</p><p><code class="language-plaintext highlighter-rouge">TreeMap</code>按照比较结果的升序保存键，而<code class="language-plaintext highlighter-rouge">LinkedHashMap</code>则按照插入顺序保存键。</p><h2 id="5list">5.List</h2><p>有两种类型的List：</p><ul><li>基本的<code class="language-plaintext highlighter-rouge">ArrayList</code>，它长于随机访问元素，但是在<code class="language-plaintext highlighter-rouge">List</code>的中间插入和移除元素时比较慢。<li><code class="language-plaintext highlighter-rouge">LinkedList</code>，它通过代价较低的在<code class="language-plaintext highlighter-rouge">List</code>中间进行的插入和删除操作，提供了优化的顺序访问。<code class="language-plaintext highlighter-rouge">LinkedList</code>在随机访问方面相对比较慢，但是它的特性集较<code class="language-plaintext highlighter-rouge">ArrayList</code>更大。</ul><p><code class="language-plaintext highlighter-rouge">pets</code>:</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Individual</span> <span class="kd">implements</span> <span class="nc">Comparable</span><span class="o">&lt;</span><span class="nc">Individual</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">id</span> <span class="o">=</span> <span class="n">counter</span><span class="o">++;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">Individual</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span> <span class="o">}</span>
  <span class="c1">// 'name' is optional:</span>
  <span class="kd">public</span> <span class="nf">Individual</span><span class="o">()</span> <span class="o">{}</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()</span> <span class="o">+</span>
      <span class="o">(</span><span class="n">name</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="s">""</span> <span class="o">:</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">name</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">long</span> <span class="nf">id</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">id</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nc">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">o</span> <span class="k">instanceof</span> <span class="nc">Individual</span> <span class="o">&amp;&amp;</span>
      <span class="n">id</span> <span class="o">==</span> <span class="o">((</span><span class="nc">Individual</span><span class="o">)</span><span class="n">o</span><span class="o">).</span><span class="na">id</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">17</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">name</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">*</span> <span class="n">result</span> <span class="o">+</span> <span class="n">name</span><span class="o">.</span><span class="na">hashCode</span><span class="o">();</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">*</span> <span class="n">result</span> <span class="o">+</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="n">id</span><span class="o">;</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="nc">Individual</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Compare by class name first:</span>
    <span class="nc">String</span> <span class="n">first</span> <span class="o">=</span> <span class="n">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">();</span>
    <span class="nc">String</span> <span class="n">argFirst</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">();</span>
    <span class="kt">int</span> <span class="n">firstCompare</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">argFirst</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(</span><span class="n">firstCompare</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span>
    <span class="k">return</span> <span class="n">firstCompare</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">name</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">arg</span><span class="o">.</span><span class="na">name</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="kt">int</span> <span class="n">secondCompare</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">arg</span><span class="o">.</span><span class="na">name</span><span class="o">);</span>
      <span class="k">if</span><span class="o">(</span><span class="n">secondCompare</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span>
        <span class="k">return</span> <span class="n">secondCompare</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">arg</span><span class="o">.</span><span class="na">id</span> <span class="o">&lt;</span> <span class="n">id</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="o">(</span><span class="n">arg</span><span class="o">.</span><span class="na">id</span> <span class="o">==</span> <span class="n">id</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pet</span> <span class="kd">extends</span> <span class="nc">Individual</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Pet</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Pet</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//🐱</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="nc">Pet</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//🐶</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="nc">Pet</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Dog</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Dog</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//鼠类</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Rodent</span> <span class="kd">extends</span> <span class="nc">Pet</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Rodent</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Rodent</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//马恩岛🐱</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Manx</span> <span class="kd">extends</span> <span class="nc">Cat</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Manx</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Manx</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//埃及🐱</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EgyptianMau</span> <span class="kd">extends</span> <span class="nc">Cat</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">EgyptianMau</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">EgyptianMau</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//威尔士🐱</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Cymric</span> <span class="kd">extends</span> <span class="nc">Manx</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Cymric</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Cymric</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//混血🐶</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Mutt</span> <span class="kd">extends</span> <span class="nc">Dog</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Mutt</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Mutt</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//哈巴🐶</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pug</span> <span class="kd">extends</span> <span class="nc">Dog</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Pug</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Pug</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//大🐭</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Rat</span> <span class="kd">extends</span> <span class="nc">Rodent</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Rat</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Rat</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span> 
<span class="c1">//仓鼠</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Hamster</span> <span class="kd">extends</span> <span class="nc">Rodent</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Hamster</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Hamster</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//小🐭</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Mouse</span> <span class="kd">extends</span> <span class="nc">Rodent</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">Mouse</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nf">Mouse</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">PetCreator</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="nc">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
  <span class="c1">// The List of the different types of Pet to create:</span>
  <span class="kd">public</span> <span class="kd">abstract</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Pet</span><span class="o">&gt;&gt;</span> <span class="nf">types</span><span class="o">();</span>
  <span class="kd">public</span> <span class="nc">Pet</span> <span class="nf">randomPet</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// Create one random Pet</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">types</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">return</span> <span class="nf">types</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">n</span><span class="o">).</span><span class="na">newInstance</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">InstantiationException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>    
  <span class="kd">public</span> <span class="nc">Pet</span><span class="o">[]</span> <span class="nf">createArray</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Pet</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Pet</span><span class="o">[</span><span class="n">size</span><span class="o">];</span>
    <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
      <span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">randomPet</span><span class="o">();</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="nf">arrayList</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;();</span>
    <span class="nc">Collections</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">result</span><span class="o">,</span> <span class="n">createArray</span><span class="o">(</span><span class="n">size</span><span class="o">));</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ForNameCreator</span> <span class="kd">extends</span> <span class="nc">PetCreator</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Pet</span><span class="o">&gt;&gt;</span> <span class="n">types</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Pet</span><span class="o">&gt;&gt;();</span>
  <span class="c1">// Types that you want to be randomly created:</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">typeNames</span> <span class="o">=</span> <span class="o">{</span>
    <span class="s">"pets.Mutt"</span><span class="o">,</span>
    <span class="s">"pets.Pug"</span><span class="o">,</span>
    <span class="s">"pets.EgyptianMau"</span><span class="o">,</span>
    <span class="s">"pets.Manx"</span><span class="o">,</span>
    <span class="s">"pets.Cymric"</span><span class="o">,</span>
    <span class="s">"pets.Rat"</span><span class="o">,</span>
    <span class="s">"pets.Mouse"</span><span class="o">,</span>
    <span class="s">"pets.Hamster"</span>
  <span class="o">};</span>    
  <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">loader</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span> <span class="o">:</span> <span class="n">typeNames</span><span class="o">)</span>
        <span class="n">types</span><span class="o">.</span><span class="na">add</span><span class="o">(</span>
          <span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Pet</span><span class="o">&gt;)</span><span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">name</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="nc">ClassNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">static</span> <span class="o">{</span> <span class="n">loader</span><span class="o">();</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Pet</span><span class="o">&gt;&gt;</span> <span class="nf">types</span><span class="o">()</span> <span class="o">{</span><span class="k">return</span> <span class="n">types</span><span class="o">;}</span>
<span class="o">}</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LiteralPetCreator</span> <span class="kd">extends</span> <span class="nc">PetCreator</span> <span class="o">{</span>
  <span class="c1">// No try block needed.</span>
  <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Pet</span><span class="o">&gt;&gt;</span> <span class="n">allTypes</span> <span class="o">=</span>
    <span class="nc">Collections</span><span class="o">.</span><span class="na">unmodifiableList</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span>
      <span class="nc">Pet</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Dog</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Cat</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>  <span class="nc">Rodent</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
      <span class="nc">Mutt</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Pug</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">EgyptianMau</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Manx</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
      <span class="nc">Cymric</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Rat</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Mouse</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">Hamster</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
  <span class="c1">// Types for random creation:</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Pet</span><span class="o">&gt;&gt;</span> <span class="n">types</span> <span class="o">=</span>
    <span class="n">allTypes</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="n">allTypes</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="nc">Mutt</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
      <span class="n">allTypes</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Pet</span><span class="o">&gt;&gt;</span> <span class="nf">types</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">types</span><span class="o">;</span>
  <span class="o">}</span>    
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">types</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span> 


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pets</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">PetCreator</span> <span class="n">creator</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nf">LiteralPetCreator</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Pet</span> <span class="nf">randomPet</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">creator</span><span class="o">.</span><span class="na">randomPet</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Pet</span><span class="o">[]</span> <span class="nf">createArray</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">creator</span><span class="o">.</span><span class="na">createArray</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="nf">arrayList</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">creator</span><span class="o">.</span><span class="na">arrayList</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ListFeatures</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">pets</span> <span class="o">=</span> <span class="nc">Pets</span><span class="o">.</span><span class="na">arrayList</span><span class="o">(</span><span class="mi">7</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"1: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="nc">Hamster</span> <span class="n">h</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Hamster</span><span class="o">();</span>
        <span class="n">pets</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">h</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"2: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"3: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">h</span><span class="o">));</span><span class="c1">//判断某个对象是否在列表中</span>
        <span class="n">pets</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">h</span><span class="o">);</span> <span class="c1">//移除</span>
        <span class="nc">Pet</span> <span class="n">p</span> <span class="o">=</span> <span class="n">pets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"4: "</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">p</span><span class="o">));</span> <span class="c1">//获取索引</span>
        <span class="c1">//当确定一个元素是否属于某个List,发现某个元素的索引,</span>
        <span class="c1">// 以及从某个List中移除一个元素时,都会用到equals()方法</span>
        <span class="nc">Pet</span> <span class="n">cymric</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cymric</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"5: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">cymric</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"6: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">cymric</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"7: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">p</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"8: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="n">pets</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Mouse</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"9: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">pets</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"subList: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"10: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">sub</span><span class="o">));</span>
        <span class="c1">//对子列表打乱和排序都不影响containsAll()方法</span>
        <span class="nc">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">sub</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"sorted subList:"</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"11: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">sub</span><span class="o">));</span>
        <span class="nc">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">sub</span><span class="o">,</span> <span class="n">random</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"shuffled subList:"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"12: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">sub</span><span class="o">));</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;(</span><span class="n">pets</span><span class="o">);</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">pets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="n">pets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">4</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"sub: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="c1">//retainAll()方法是一种有效的"交集"操作,保留了所有同时在copy与sub中的元素</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">retainAll</span><span class="o">(</span><span class="n">sub</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"13: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;(</span><span class="n">pets</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"14: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">sub</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"15: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Mouse</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"16: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">sub</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"17: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"18: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
        <span class="n">pets</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"19: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"20: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
        <span class="n">pets</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="nc">Pets</span><span class="o">.</span><span class="na">arrayList</span><span class="o">(</span><span class="mi">4</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"21: "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="nc">Object</span><span class="o">[]</span> <span class="n">o</span> <span class="o">=</span> <span class="n">pets</span><span class="o">.</span><span class="na">toArray</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"22: "</span> <span class="o">+</span> <span class="n">o</span><span class="o">[</span><span class="mi">3</span><span class="o">]);</span>
        <span class="nc">Pet</span><span class="o">[]</span> <span class="n">pa</span> <span class="o">=</span> <span class="n">pets</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="k">new</span> <span class="nc">Pet</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span> <span class="c1">//将集合转换为数组</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"23: "</span> <span class="o">+</span> <span class="n">pa</span><span class="o">[</span><span class="mi">3</span><span class="o">].</span><span class="na">id</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="6迭代器">6.迭代器</h2><p>如果原本是对着<code class="language-plaintext highlighter-rouge">List</code>编码的，但是后来发现如果能够把相同的代码应用于<code class="language-plaintext highlighter-rouge">Set</code>，将会显得非常方便，此时应该怎么做？或者打算从头开始编写通用的代码，它们只是使用容器，不知道或者说不关心容器的类型，那么如何才能不重写代码就可以应用于不同类型的容器？</p><p><code class="language-plaintext highlighter-rouge">迭代器</code>的概念可以用于达成此目的。迭代器是一个对象，它的工作是遍历并选择序列中的对象，而客户端程序员不必知道或关心该序列底层的结构。</p><p><code class="language-plaintext highlighter-rouge">Java</code>的<code class="language-plaintext highlighter-rouge">Iterator</code>只能单向移动，这个<code class="language-plaintext highlighter-rouge">Iterator</code>只能用来：</p><ul><li>使用方法<code class="language-plaintext highlighter-rouge">iterator()</code>要求容器返回一个<code class="language-plaintext highlighter-rouge">Iterator</code>。<code class="language-plaintext highlighter-rouge">Iterator</code>将准备好返回序列的第一个元素。<li>使用<code class="language-plaintext highlighter-rouge">next()</code>获得序列中的下一个元素。<li>使用<code class="language-plaintext highlighter-rouge">hasNext()</code>检查序列中是否还有元素。<li>使用<code class="language-plaintext highlighter-rouge">remove()</code>将迭代器新近返回的元素删除。</ul><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleIteration</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">pets</span> <span class="o">=</span> <span class="nc">Pets</span><span class="o">.</span><span class="na">arrayList</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>
        <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">pets</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">Pet</span> <span class="n">p</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">id</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Pet</span> <span class="n">p</span> <span class="o">:</span> <span class="n">pets</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">id</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
        <span class="n">it</span> <span class="o">=</span> <span class="n">pets</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="n">it</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pets</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
<span class="cm">/*
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster
[Pug, Manx, Cymric, Rat, EgyptianMau, Hamster]

 */</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CrossContainerIteration</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">it</span><span class="o">){</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()){</span>
            <span class="nc">Pet</span> <span class="n">p</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">id</span><span class="o">()</span> <span class="o">+</span><span class="s">":"</span><span class="o">+</span><span class="n">p</span> <span class="o">+</span><span class="s">""</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">pets</span> <span class="o">=</span> <span class="nc">Pets</span><span class="o">.</span><span class="na">arrayList</span><span class="o">(</span><span class="mi">8</span><span class="o">);</span>
        <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">petsLL</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;(</span><span class="n">pets</span><span class="o">);</span>
        <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">petsHS</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;(</span><span class="n">pets</span><span class="o">);</span>
        <span class="nc">TreeSet</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">petsTS</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TreeSet</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;(</span><span class="n">pets</span><span class="o">);</span>
        <span class="n">display</span><span class="o">(</span><span class="n">pets</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span>
        <span class="n">display</span><span class="o">(</span><span class="n">petsLL</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span>
        <span class="n">display</span><span class="o">(</span><span class="n">petsHS</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span>
        <span class="n">display</span><span class="o">(</span><span class="n">petsTS</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
0:Rat1:Manx2:Cymric3:Mutt4:Pug5:Cymric6:Pug7:Manx
0:Rat1:Manx2:Cymric3:Mutt4:Pug5:Cymric6:Pug7:Manx
0:Rat1:Manx2:Cymric3:Mutt4:Pug5:Cymric6:Pug7:Manx
5:Cymric2:Cymric7:Manx1:Manx3:Mutt6:Pug4:Pug0:Rat
 */</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">display()</code>方法不包含任何有关它所遍历的序列的类型信息，而这也展示了<code class="language-plaintext highlighter-rouge">Iterator</code>的真正威力：能够将遍历蓄力的操作与序列底层的结构分离。正由于此，我们有时会说：迭代器统一了对容器的访问方式。</p><h3 id="61-listiterator">6.1 ListIterator</h3><p><code class="language-plaintext highlighter-rouge">ListIterator</code>是一个更加强大的<code class="language-plaintext highlighter-rouge">Iterator</code>的子类型，它只能用于各种<code class="language-plaintext highlighter-rouge">List</code>类的访问。尽管<code class="language-plaintext highlighter-rouge">Iterator</code>只能向前移动，但是<code class="language-plaintext highlighter-rouge">ListIterator</code>可以双向移动。它还可以产生相对于迭代器在列表中指向的当前位置的前一个和后一个元素的索引，并且可以使用<code class="language-plaintext highlighter-rouge">set()</code>方法替换它访问过的最后一个元素。你可以通过调用<code class="language-plaintext highlighter-rouge">listIterator()</code>方法产生一个指向<code class="language-plaintext highlighter-rouge">List</code>开始处的<code class="language-plaintext highlighter-rouge">ListIterator</code>，并且还可以通过调用<code class="language-plaintext highlighter-rouge">listIterator(n)</code>方法创建一个一开始就指向列表索引为<code class="language-plaintext highlighter-rouge">n</code>的元素处的<code class="language-plaintext highlighter-rouge">ListIterator</code>。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ListIteration</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">pets</span> <span class="o">=</span> <span class="nc">Pets</span><span class="o">.</span><span class="na">arrayList</span><span class="o">(</span><span class="mi">8</span><span class="o">);</span>
        <span class="nc">ListIterator</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">pets</span><span class="o">.</span><span class="na">listIterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">()</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">it</span><span class="o">.</span><span class="na">nextIndex</span><span class="o">()</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">it</span><span class="o">.</span><span class="na">previousIndex</span><span class="o">()</span> <span class="o">+</span> <span class="s">"; "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasPrevious</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">previous</span><span class="o">().</span><span class="na">id</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pets</span><span class="o">);</span>
        <span class="n">it</span> <span class="o">=</span> <span class="n">pets</span><span class="o">.</span><span class="na">listIterator</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="n">it</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="nc">Pets</span><span class="o">.</span><span class="na">randomPet</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pets</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
<span class="cm">/*
Rat, 1, 0; Manx, 2, 1; Cymric, 3, 2; Mutt, 4, 3; Pug, 5, 4; Cymric, 6, 5; Pug, 7, 6; Manx, 8, 7; 
7 6 5 4 3 2 1 0 
[Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug, Manx]
[Rat, Manx, Cymric, Cymric, Rat, EgyptianMau, Hamster, EgyptianMau]
 */</span>
</pre></table></code></div></div><h2 id="7linkedlist">7.LinkedList</h2><p><code class="language-plaintext highlighter-rouge">LinkedList</code>添加了可以使其用作栈、队列或双端队列的方法。</p><p>这些方法中有些彼此之间只是名字有些差异，或者只存在些许差异，以使得这些名字在特定用法的上下文环境中更加适用。例如，<code class="language-plaintext highlighter-rouge">getFirst()</code>和<code class="language-plaintext highlighter-rouge">element()</code>完全一样，它们都返回列表的头，而并不移除它，如果<code class="language-plaintext highlighter-rouge">List</code>为空，则抛出<code class="language-plaintext highlighter-rouge">NoSuchElementException</code>。<code class="language-plaintext highlighter-rouge">peek()</code>方法与这两个方式只是稍有差异，它在列表为空时返回<code class="language-plaintext highlighter-rouge">null</code>。</p><p><code class="language-plaintext highlighter-rouge">removeFirst()</code>和<code class="language-plaintext highlighter-rouge">remove()</code>也是完全一样的，它们移除并返回列表的头，而在列表为空时抛出<code class="language-plaintext highlighter-rouge">NoSuchElementException</code>。<code class="language-plaintext highlighter-rouge">poll()</code>稍有差异，它在列表为空时返回<code class="language-plaintext highlighter-rouge">null</code>。</p><p><code class="language-plaintext highlighter-rouge">offer()</code>与<code class="language-plaintext highlighter-rouge">add()</code>和<code class="language-plaintext highlighter-rouge">addLast()</code>相同，它们都将某个元素插入到列表的尾部。</p><p><code class="language-plaintext highlighter-rouge">removeLast()</code>移除并返回列表的最后一个元素。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedListFeatures</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">pets</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;(</span><span class="nc">Pets</span><span class="o">.</span><span class="na">arrayList</span><span class="o">(</span><span class="mi">5</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pets</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"pets.getFirst(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">getFirst</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"pets.element(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">element</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"pets.peek(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">peek</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"pets.remove(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">remove</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"pets.removeFirst(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">removeFirst</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"pets.poll(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">poll</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pets</span><span class="o">);</span>
        <span class="n">pets</span><span class="o">.</span><span class="na">addFirst</span><span class="o">(</span><span class="k">new</span> <span class="nc">Rat</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"After addFirst(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="n">pets</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="nc">Pets</span><span class="o">.</span><span class="na">randomPet</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"After offer(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="n">pets</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Pets</span><span class="o">.</span><span class="na">randomPet</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"After add(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="n">pets</span><span class="o">.</span><span class="na">addLast</span><span class="o">(</span><span class="nc">Pets</span><span class="o">.</span><span class="na">randomPet</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"After addLast(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"pets.removeLast(): "</span> <span class="o">+</span> <span class="n">pets</span><span class="o">.</span><span class="na">removeLast</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
[Rat, Manx, Cymric, Mutt, Pug]
pets.getFirst(): Rat
pets.element(): Rat
pets.peek(): Rat
pets.remove(): Rat
pets.removeFirst(): Manx
pets.poll(): Cymric
[Mutt, Pug]
After addFirst(): [Rat, Mutt, Pug]
After offer(): [Rat, Mutt, Pug, Cymric]
After add(): [Rat, Mutt, Pug, Cymric, Pug]
After addLast(): [Rat, Mutt, Pug, Cymric, Pug, Manx]
pets.removeLast(): Manx
 */</span>
</pre></table></code></div></div><h2 id="8stack">8.Stack</h2><p>”栈“通常是指“后进先出”（LIFO）的容器。有时候也被称为<code class="language-plaintext highlighter-rouge">叠加栈</code>，因为最后“压入”栈的元素，第一个”弹出“栈。</p><p><code class="language-plaintext highlighter-rouge">LinkedList</code>具有能够直接实现栈的所有功能的方法，因此可以直接将<code class="language-plaintext highlighter-rouge">LinkedList</code>作为栈使用。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="no">T</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">storage</span><span class="o">.</span><span class="na">addFirst</span><span class="o">(</span><span class="n">v</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="no">T</span> <span class="nf">peek</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">storage</span><span class="o">.</span><span class="na">getFirst</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="no">T</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">storage</span><span class="o">.</span><span class="na">removeFirst</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">empty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">storage</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">storage</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StackTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="s">"My dog has fleas"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">stack</span><span class="o">.</span><span class="na">empty</span><span class="o">()){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">()+</span><span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
fleas has dog My
 */</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">java.util</code>包中的<code class="language-plaintext highlighter-rouge">Stack</code>使用。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StackTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Stack</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Stack</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="s">"My dog has fleas"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">stack</span><span class="o">.</span><span class="na">empty</span><span class="o">()){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">()+</span><span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
fleas has dog My
 */</span>
</pre></table></code></div></div><h2 id="9set">9.Set</h2><p><code class="language-plaintext highlighter-rouge">Set</code>具有与<code class="language-plaintext highlighter-rouge">Collection</code>完全一样的接口，因此没有任何额外的功能，不像前面有两个不同的<code class="language-plaintext highlighter-rouge">List</code>。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SetOfInteger</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">intset</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">intset</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">30</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">intset</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
 */</span>
</pre></table></code></div></div><h2 id="10map">10.Map</h2><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Statistics</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>
            <span class="nc">Integer</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">r</span><span class="o">);</span>
            <span class="n">m</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">r</span><span class="o">,</span><span class="n">freq</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="n">freq</span><span class="o">+</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">m</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
{0=481, 1=502, 2=489, 3=508, 4=481, 5=503, 6=519, 7=471, 8=468, 9=549, 10=513,
 11=531, 12=521, 13=506, 14=477, 15=497, 16=533, 17=509, 18=478, 19=464}

 */</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PetMap</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">petMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Pet</span><span class="o">&gt;();</span>
        <span class="n">petMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"My Cat"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Cat</span><span class="o">(</span><span class="s">"Molly"</span><span class="o">));</span>
        <span class="n">petMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"My Dog"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Dog</span><span class="o">(</span><span class="s">"Ginger"</span><span class="o">));</span>
        <span class="n">petMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"My Hamster"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Hamster</span><span class="o">(</span><span class="s">"Bosco"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">petMap</span><span class="o">);</span>
        <span class="nc">Pet</span> <span class="n">dog</span> <span class="o">=</span> <span class="n">petMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"My Dog"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dog</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">petMap</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="s">"My Dog"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">petMap</span><span class="o">.</span><span class="na">containsValue</span><span class="o">(</span><span class="n">dog</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
{My Dog=Dog Ginger, My Cat=Cat Molly, My Hamster=Hamster Bosco}
Dog Ginger
true
true
 */</span>
</pre></table></code></div></div><h2 id="queue">Queue</h2><p>队列是一种典型的<code class="language-plaintext highlighter-rouge">先进先出（FIFO）</code>的容器。</p><p><code class="language-plaintext highlighter-rouge">LinkedList</code>提供了方法以支持队列的行为，并且它实现了<code class="language-plaintext highlighter-rouge">Queue</code>接口，因此<code class="language-plaintext highlighter-rouge">LinkedList</code>可以用作<code class="language-plaintext highlighter-rouge">Queue</code>的一种实现。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">QueueDemo</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printQ</span><span class="o">(</span><span class="nc">Queue</span> <span class="n">queue</span><span class="o">){</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">queue</span><span class="o">.</span><span class="na">peek</span><span class="o">()!=</span><span class="kc">null</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">queue</span><span class="o">.</span><span class="na">remove</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Queue</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;();</span>
        <span class="nc">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">printQ</span><span class="o">(</span><span class="n">queue</span><span class="o">);</span>
        <span class="nc">Queue</span><span class="o">&lt;</span><span class="nc">Character</span><span class="o">&gt;</span> <span class="n">qc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;</span><span class="nc">Character</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">c</span> <span class="o">:</span> <span class="s">"Brontosaurus"</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">qc</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">printQ</span><span class="o">(</span><span class="n">qc</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
8 1 1 1 5 14 3 1 0 1
B r o n t o s a u r u s
 */</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">offer()</code>方法是<code class="language-plaintext highlighter-rouge">Queue</code>相关的方法之一，它在允许的情况下，将一个元素插入到队尾，或者返回<code class="language-plaintext highlighter-rouge">false</code>。<code class="language-plaintext highlighter-rouge">peek()</code>和<code class="language-plaintext highlighter-rouge">element()</code>都将在不移除的情况下返回队头，但是<code class="language-plaintext highlighter-rouge">peek()</code>方法在队列为空时返回<code class="language-plaintext highlighter-rouge">null</code>，而<code class="language-plaintext highlighter-rouge">element()</code>会抛出<code class="language-plaintext highlighter-rouge">NoSuchElementException</code>异常。<code class="language-plaintext highlighter-rouge">poll()</code>和<code class="language-plaintext highlighter-rouge">remove()</code>方法将移除并返回队头，但是<code class="language-plaintext highlighter-rouge">poll()</code>在队列为空时返回<code class="language-plaintext highlighter-rouge">null</code>，而<code class="language-plaintext highlighter-rouge">remove()</code>会抛出<code class="language-plaintext highlighter-rouge">NoSuchElementException</code>异常。</p><h3 id="111-priorityqueue">11.1 PriorityQueue</h3><p><code class="language-plaintext highlighter-rouge">优先级队列</code>声明下一个弹出元素是最需要的元素。</p><p>当在<code class="language-plaintext highlighter-rouge">PriorityQueue</code>上调用<code class="language-plaintext highlighter-rouge">offer()</code>方法来插入一个对象时，这个对象会在队列中被排序。默认的排序将使用对象在队列中的<code class="language-plaintext highlighter-rouge">自然顺序</code>，但是你可以通过提供自己的<code class="language-plaintext highlighter-rouge">Comparator</code>来修改这个顺序。<code class="language-plaintext highlighter-rouge">PriorityQueue</code>可以确保你调用<code class="language-plaintext highlighter-rouge">peek()</code>、<code class="language-plaintext highlighter-rouge">poll()</code>和<code class="language-plaintext highlighter-rouge">remove()</code>方法时，获取的元素将是队列中优先级最高的元素。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PriorityQueueDemo</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">priorityQueue</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;();</span>
        <span class="nc">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">priorityQueue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">10</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="nc">QueueDemo</span><span class="o">.</span><span class="na">printQ</span><span class="o">(</span><span class="n">priorityQueue</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">ints</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">25</span><span class="o">,</span> <span class="mi">22</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">23</span><span class="o">,</span> <span class="mi">25</span><span class="o">);</span>
        <span class="n">priorityQueue</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;(</span><span class="n">ints</span><span class="o">);</span>
        <span class="nc">QueueDemo</span><span class="o">.</span><span class="na">printQ</span><span class="o">(</span><span class="n">priorityQueue</span><span class="o">);</span>
        <span class="c1">//反序</span>
        <span class="n">priorityQueue</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;(</span><span class="n">ints</span><span class="o">.</span><span class="na">size</span><span class="o">(),</span> <span class="nc">Collections</span><span class="o">.&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span><span class="n">reverseOrder</span><span class="o">());</span>
        <span class="n">priorityQueue</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">ints</span><span class="o">);</span>
        <span class="nc">QueueDemo</span><span class="o">.</span><span class="na">printQ</span><span class="o">(</span><span class="n">priorityQueue</span><span class="o">);</span>
        <span class="c1">//空格也可以算作值，并且比字母的优先级高</span>
        <span class="nc">String</span> <span class="n">fact</span> <span class="o">=</span> <span class="s">"EDUCATION SHOULD ESCHEW OBFUSCATION"</span><span class="o">;</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">strings</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">fact</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">""</span><span class="o">));</span>
        <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">stringPQ</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;(</span><span class="n">strings</span><span class="o">);</span>
        <span class="nc">QueueDemo</span><span class="o">.</span><span class="na">printQ</span><span class="o">(</span><span class="n">stringPQ</span><span class="o">);</span>
        <span class="n">stringPQ</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;(</span>
                <span class="n">strings</span><span class="o">.</span><span class="na">size</span><span class="o">(),</span> <span class="nc">Collections</span><span class="o">.&lt;</span><span class="nc">String</span><span class="o">&gt;</span><span class="n">reverseOrder</span><span class="o">());</span>
        <span class="n">stringPQ</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">strings</span><span class="o">);</span>
        <span class="nc">QueueDemo</span><span class="o">.</span><span class="na">printQ</span><span class="o">(</span><span class="n">stringPQ</span><span class="o">);</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Character</span><span class="o">&gt;</span> <span class="n">charSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Character</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">c</span> <span class="o">:</span> <span class="n">fact</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">charSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Character</span><span class="o">&gt;</span> <span class="n">characterPQ</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PriorityQueue</span><span class="o">&lt;</span><span class="nc">Character</span><span class="o">&gt;(</span><span class="n">charSet</span><span class="o">);</span>
        <span class="nc">QueueDemo</span><span class="o">.</span><span class="na">printQ</span><span class="o">(</span><span class="n">characterPQ</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
2 3 3 4 4 5 5 7 7 9 
1 1 2 3 3 9 9 14 14 18 18 20 21 22 23 25 25 
25 25 23 22 21 20 18 18 14 14 9 9 3 3 2 1 1 
      A A B C C C D D E E E F H H I I L N N O O O O S S S T T U U U W 
W U U U T T S S S O O O O N N L I I H H F E E E D D C C C B A A       
  A B C D E F H I L N O S T U W 
 */</span>
</pre></table></code></div></div><h2 id="12collection和iterator">12.Collection和Iterator</h2><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">InterfaceVsIterator</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">it</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">Pet</span> <span class="n">p</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">id</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">pets</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Pet</span> <span class="n">pet</span> <span class="o">:</span> <span class="n">pets</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">pet</span><span class="o">.</span><span class="na">id</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">pet</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">petList</span> <span class="o">=</span> <span class="nc">Pets</span><span class="o">.</span><span class="na">arrayList</span><span class="o">(</span><span class="mi">8</span><span class="o">);</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">petSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;(</span><span class="n">petList</span><span class="o">);</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Pet</span><span class="o">&gt;</span> <span class="n">petMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedHashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Pet</span><span class="o">&gt;();</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">names</span> <span class="o">=</span> <span class="o">(</span><span class="s">"Ralph, Eric, Robin, Lacey, "</span> <span class="o">+</span>
                <span class="s">"Britney, Sam, Spot, Fluffy"</span><span class="o">).</span><span class="na">split</span><span class="o">(</span><span class="s">", "</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">names</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">petMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">names</span><span class="o">[</span><span class="n">i</span><span class="o">],</span><span class="n">petList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">display</span><span class="o">(</span><span class="n">petList</span><span class="o">);</span>
        <span class="n">display</span><span class="o">(</span><span class="n">petSet</span><span class="o">);</span>
        <span class="n">display</span><span class="o">(</span><span class="n">petList</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">petMap</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">petMap</span><span class="o">.</span><span class="na">keySet</span><span class="o">());</span>
        <span class="n">display</span><span class="o">(</span><span class="n">petMap</span><span class="o">.</span><span class="na">values</span><span class="o">());</span>
        <span class="n">display</span><span class="o">(</span><span class="n">petMap</span><span class="o">.</span><span class="na">values</span><span class="o">().</span><span class="na">iterator</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 
{Ralph=Rat, Eric=Manx, Robin=Cymric, Lacey=Mutt, Britney=Pug, Sam=Cymric, Spot=Pug, Fluffy=Manx}
[Ralph, Eric, Robin, Lacey, Britney, Sam, Spot, Fluffy]
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 
 */</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CollectionSequence</span> <span class="kd">extends</span> <span class="nc">AbstractCollection</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Pet</span><span class="o">[]</span> <span class="n">pets</span> <span class="o">=</span> <span class="nc">Pets</span><span class="o">.</span><span class="na">createArray</span><span class="o">(</span><span class="mi">8</span><span class="o">);</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">pets</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="kd">public</span> <span class="nc">Pet</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">pets</span><span class="o">[</span><span class="n">index</span><span class="o">++];</span>
            <span class="o">}</span>

            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">CollectionSequence</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CollectionSequence</span><span class="o">();</span>
        <span class="nc">InterfaceVsIterator</span><span class="o">.</span><span class="na">display</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="nc">InterfaceVsIterator</span><span class="o">.</span><span class="na">display</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">PetSequence</span><span class="o">{</span>
    <span class="kd">protected</span> <span class="nc">Pet</span><span class="o">[]</span> <span class="n">pets</span> <span class="o">=</span> <span class="nc">Pets</span><span class="o">.</span><span class="na">createArray</span><span class="o">(</span><span class="mi">8</span><span class="o">);</span>
<span class="o">}</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NonCollectionSequence</span> <span class="kd">extends</span> <span class="nc">PetSequence</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">Pet</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span><span class="mi">0</span><span class="o">;</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">pets</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="kd">public</span> <span class="nc">Pet</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">pets</span><span class="o">[</span><span class="n">index</span><span class="o">++];</span>
            <span class="o">}</span>

            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">NonCollectionSequence</span> <span class="n">nc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NonCollectionSequence</span><span class="o">();</span>
        <span class="nc">InterfaceVsIterator</span><span class="o">.</span><span class="na">display</span><span class="o">(</span><span class="n">nc</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 

 */</span>
</pre></table></code></div></div><h2 id="13foreach与迭代器">13.Foreach与迭代器</h2><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ForEachCollections</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">cs</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedHashSet</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="nc">Collections</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">cs</span><span class="o">,</span> <span class="s">"Take the long way home"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">));</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">cs</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"'"</span> <span class="o">+</span> <span class="n">s</span> <span class="o">+</span> <span class="s">"' "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
'Take' 'the' 'long' 'way' 'home'
 */</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Java SE5</code>引入了新的被称为<code class="language-plaintext highlighter-rouge">Iterable</code>的接口，该接口包含一个能够产生<code class="language-plaintext highlighter-rouge">Iterator</code>的<code class="language-plaintext highlighter-rouge">iterator()</code>方法，并且<code class="language-plaintext highlighter-rouge">Iterable</code>接口被foreach用来在序列中移动。因此如果你创建了任何实现<code class="language-plaintext highlighter-rouge">Iterable</code>的类，都可以将它用于<code class="language-plaintext highlighter-rouge">foreach</code>语句中：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">IterableClass</span> <span class="kd">implements</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">protected</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">words</span> <span class="o">=</span> <span class="o">(</span><span class="s">"And that is how "</span> <span class="o">+</span>
            <span class="s">"we know the Earth to be banana-shaped."</span><span class="o">).</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">);</span>
    <span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">index</span><span class="o">&lt;</span><span class="n">words</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="kd">public</span> <span class="nc">String</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">words</span><span class="o">[</span><span class="n">index</span><span class="o">++];</span>
            <span class="o">}</span>

            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="k">new</span> <span class="nc">IterableClass</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
'Take' 'the' 'long' 'way' 'home' 
 */</span>
</pre></table></code></div></div><p>显示所有的操作系统环境变量：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EnvironmentVariables</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="nc">System</span><span class="o">.</span><span class="na">getenv</span><span class="o">().</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">()+</span><span class="s">":"</span><span class="o">+</span><span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">foreach</code>语句可以用于数组或其他任何<code class="language-plaintext highlighter-rouge">Iterable</code>，但是这并不意味着数组肯定也是一个<code class="language-plaintext highlighter-rouge">Iterable</code>。</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ArrayIsNotIterable</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">ib</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="no">T</span> <span class="n">t</span> <span class="o">:</span> <span class="n">ib</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">t</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">test</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">));</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="o">{</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">,</span> <span class="s">"C"</span><span class="o">};</span>
        <span class="c1">//</span>
       <span class="c1">// test(strings);</span>

        <span class="n">test</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">strings</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
1 2 3 A B C 
 */</span>
</pre></table></code></div></div><h3 id="131-适配器方法惯用法">13.1 适配器方法惯用法</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReversibleArrayList</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">ReversibleArrayList</span><span class="o">(</span><span class="nc">Collection</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">reversed</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;()</span> <span class="o">{</span>
                    <span class="kt">int</span> <span class="n">current</span> <span class="o">=</span> <span class="n">size</span><span class="o">()</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>

                    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="n">current</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
                    <span class="o">}</span>

                    <span class="kd">public</span> <span class="no">T</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="nf">get</span><span class="o">(</span><span class="n">current</span><span class="o">--);</span>
                    <span class="o">}</span>

                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">};</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AdapterMethodiom</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ReversibleArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">ral</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReversibleArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;(</span>
                <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"To be or not to be"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">)));</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">ral</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">ral</span><span class="o">.</span><span class="na">reversed</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
To be or not to be
be to not or be To
 */</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MultiIterableClass</span> <span class="kd">extends</span> <span class="nc">IterableClass</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">reversed</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
                    <span class="kt">int</span> <span class="n">current</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>

                    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="n">current</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
                    <span class="o">}</span>

                    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">return</span> <span class="n">words</span><span class="o">[</span><span class="n">current</span><span class="o">--];</span>
                    <span class="o">}</span>

                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span>
                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">};</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">randomized</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
                <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">shuffled</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">words</span><span class="o">));</span>
                <span class="nc">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">shuffled</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">));</span>
                <span class="k">return</span> <span class="n">shuffled</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">MultiIterableClass</span> <span class="n">mic</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MultiIterableClass</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">mic</span><span class="o">.</span><span class="na">reversed</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">mic</span><span class="o">.</span><span class="na">randomized</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">mic</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
banana-shaped. be to Earth the know we how is that And 
is banana-shaped. Earth that how the be And we know to 
And that is how we know the Earth to be banana-shaped. 
 */</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModifyingArraysAsList</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
        <span class="nc">Integer</span><span class="o">[]</span> <span class="n">ia</span> <span class="o">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">10</span><span class="o">};</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">ia</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Before shuffling: "</span> <span class="o">+</span> <span class="n">list1</span><span class="o">);</span>
        <span class="nc">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">list1</span><span class="o">,</span> <span class="n">rand</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"After shuffling: "</span> <span class="o">+</span> <span class="n">list1</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"array: "</span> <span class="o">+</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">ia</span><span class="o">));</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list2</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">ia</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Before shuffling: "</span> <span class="o">+</span> <span class="n">list2</span><span class="o">);</span>
        <span class="nc">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">list2</span><span class="o">,</span> <span class="n">rand</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"After shuffling: "</span> <span class="o">+</span> <span class="n">list2</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"array: "</span> <span class="o">+</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">ia</span><span class="o">));</span>

    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/*
Before shuffling: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
After shuffling: [4, 6, 3, 1, 8, 7, 2, 5, 10, 9]
array: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
Before shuffling: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
After shuffling: [9, 1, 6, 3, 7, 2, 5, 10, 4, 8]
array: [9, 1, 6, 3, 7, 2, 5, 10, 4, 8]
 */</span>
</pre></table></code></div></div><p>在第一种情况中，<code class="language-plaintext highlighter-rouge">Arrays.asList()</code>的输出被传递给了<code class="language-plaintext highlighter-rouge">ArrayList()</code>的构造器，这将创建一个引用<code class="language-plaintext highlighter-rouge">ia</code>的元素的<code class="language-plaintext highlighter-rouge">ArrayList</code>，因此打乱这些引用不会修改该数组。但是，如果直接使用<code class="language-plaintext highlighter-rouge">Arrays.asList(ia)</code>的结果，这种打乱就会修改<code class="language-plaintext highlighter-rouge">ia</code>的顺序。</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/thinking-in-java/" class="post-tag no-text-decoration" >Thinking in Java</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" class="post-tag no-text-decoration" >读书笔记</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=《Java编程思想》第11章持有对象 - malinkang&url=https://malinkang.cn/posts/thinking-in-java-holding-your-objects/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=《Java编程思想》第11章持有对象 - malinkang&u=https://malinkang.cn/posts/thinking-in-java-holding-your-objects/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=《Java编程思想》第11章持有对象 - malinkang&url=https://malinkang.cn/posts/thinking-in-java-holding-your-objects/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/dagger-guide/">Dagger使用指南</a><li><a href="/posts/understanding-the-jvm-runtime-data-areas/">《深入理解JVM》第2章Java内存区域与内存溢出异常</a><li><a href="/posts/understanding-the-jvm-garbage-collection/">《深入理解JVM》第3章垃圾收集器</a><li><a href="/posts/understanding-the-jvm-class-file-structure/">《深入理解JVM》第6章类文件结构</a><li><a href="/posts/understanding-the-jvm-class-loader/">《深入理解JVM》第7章虚拟机类加载机制</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/thinking-in-java/">Thinking in Java</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">Java并发编程实战</a> <a class="post-tag" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3jvm/">深入理解JVM</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/databinding/">databinding</a> <a class="post-tag" href="/tags/recyclerview/">RecyclerView</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/algorithms-4th-edition-chapter3/"><div class="card-body"> <span class="timeago small" > Mar 1, 2016 <i class="unloaded">2016-03-01T14:33:57+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《算法》读书笔记 第3章 查找</h3><div class="text-muted small"><p> 3.1 符号表 3.1.1 API 3.1.2 有序符号表 3.1.3 用例举例 3.1.4 无序链表中的顺序查找 3.1.5 有序数组中的二分查找 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42...</p></div></div></a></div><div class="card"> <a href="/posts/Epoxy-Models/"><div class="card-body"> <span class="timeago small" > Jan 5, 2020 <i class="unloaded">2020-01-05T23:52:23+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Epoxy Models</h3><div class="text-muted small"><p> 概览（Overview） Epoxy uses EpoxyModel objects to decide which views to display and how to bind data to them. This is similar to the popular ViewModel pattern. Models also allow you to control othe...</p></div></div></a></div><div class="card"> <a href="/posts/thinking-in-java-everything-is-an-object/"><div class="card-body"> <span class="timeago small" > Mar 20, 2013 <i class="unloaded">2013-03-20T00:26:34+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>《Java编程思想》第2章一切都是对象</h3><div class="text-muted small"><p> 2.2 必须由你创建所有对象 2.2.1 存储到什么地方 2.2.2 特例：基本类型 在程序设计中经常用到一系列类型，它们需要特殊对待。可以把它们想象成“基本”类型。之所以特殊对待，是因为new将对象存储在“堆”里，故用new创建一个对象，特别是小的、简单的变量，往往不是很有效。因此，对于这些类型，Java采取与C和C++相同的方法。也就是说，不用new来创建变量，而是创建一个并非是引...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/thinking-in-java-inner-classes/" class="btn btn-outline-primary" prompt="Older"><p>《Java编程思想》第10章内部类</p></a> <a href="/posts/thinking-in-java-error-handling-with-exceptions/" class="btn btn-outline-primary" prompt="Newer"><p>《Java编程思想》第12章通过异常处理错误</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//malinkang-cn.disqus.com/embed.js', disqusConfig: function() { this.page.title = '《Java编程思想》第11章持有对象'; this.page.url = 'https://malinkang.cn/posts/thinking-in-java-holding-your-objects/'; this.page.identifier = '/posts/thinking-in-java-holding-your-objects/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/malinkang">malinkang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/thinking-in-java/">Thinking in Java</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/">Java并发编程实战</a> <a class="post-tag" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3jvm/">深入理解JVM</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/databinding/">databinding</a> <a class="post-tag" href="/tags/recyclerview/">RecyclerView</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://malinkang.cn{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
