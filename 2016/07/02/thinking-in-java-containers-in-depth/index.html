<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>《Java编程思想》第17章容器深入研究 | 马林康的博客</title><meta name="keywords" content="读书笔记,Thinking in Java"><meta name="author" content="马林康"><meta name="copyright" content="马林康"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="1.完整的容器分类法 2.填充容器与Arrays版本一样，此fill()方法也是只复制同一个对象引用来填充整个容器的，并且只对List对象有用，但是所产生的列表可以传递给构造器或addAll()方法： 123456789101112131415161718192021222324&#x2F;&#x2F;: containers&#x2F;FillingLists.java&#x2F;&#x2F; The Collections.fill() &amp;a">
<meta property="og:type" content="article">
<meta property="og:title" content="《Java编程思想》第17章容器深入研究">
<meta property="og:url" content="https://malinkang.cn/2016/07/02/thinking-in-java-containers-in-depth/index.html">
<meta property="og:site_name" content="马林康的博客">
<meta property="og:description" content="1.完整的容器分类法 2.填充容器与Arrays版本一样，此fill()方法也是只复制同一个对象引用来填充整个容器的，并且只对List对象有用，但是所产生的列表可以传递给构造器或addAll()方法： 123456789101112131415161718192021222324&#x2F;&#x2F;: containers&#x2F;FillingLists.java&#x2F;&#x2F; The Collections.fill() &amp;a">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字37.png">
<meta property="article:published_time" content="2016-07-02T05:39:36.000Z">
<meta property="article:modified_time" content="2021-01-03T03:48:44.000Z">
<meta property="article:author" content="马林康">
<meta property="article:tag" content="读书笔记">
<meta property="article:tag" content="Thinking in Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字37.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://malinkang.cn/2016/07/02/thinking-in-java-containers-in-depth/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-01-03 11:48:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">51</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 笔记</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" target="_blank" rel="noopener" href="https://leetcode.malinkang.cn/"><i class="fa-fw fas fa-link"></i><span> LeetCode解题</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字37.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">马林康的博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 笔记</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" target="_blank" rel="noopener" href="https://leetcode.malinkang.cn/"><i class="fa-fw fas fa-link"></i><span> LeetCode解题</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">《Java编程思想》第17章容器深入研究</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2016-07-02T05:39:36.000Z" title="发表于 2016-07-02 13:39:36">2016-07-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-01-03T03:48:44.000Z" title="更新于 2021-01-03 11:48:44">2021-01-03</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-完整的容器分类法"><a href="#1-完整的容器分类法" class="headerlink" title="1.完整的容器分类法"></a>1.完整的容器分类法</h2><p><img src="https://i.imgur.com/OqAEdC5.png" alt="Imgur"></p>
<h2 id="2-填充容器"><a href="#2-填充容器" class="headerlink" title="2.填充容器"></a>2.填充容器</h2><p>与<code>Arrays</code>版本一样，此<code>fill()</code>方法也是只复制同一个对象引用来填充整个容器的，并且只对<code>List</code>对象有用，但是所产生的列表可以传递给构造器或<code>addAll()</code>方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/FillingLists.java</span></span><br><span class="line"><span class="comment">// The Collections.fill() &amp; Collections.nCopies() methods.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StringAddress</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String s;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">StringAddress</span><span class="params">(String s)</span> </span>&#123; <span class="keyword">this</span>.s = s; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.toString() + <span class="string">&quot; &quot;</span> + s;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FillingLists</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    List&lt;StringAddress&gt; list= <span class="keyword">new</span> ArrayList&lt;StringAddress&gt;(</span><br><span class="line">      Collections.nCopies(<span class="number">4</span>, <span class="keyword">new</span> StringAddress(<span class="string">&quot;Hello&quot;</span>)));</span><br><span class="line">    System.out.println(list);</span><br><span class="line">    Collections.fill(list, <span class="keyword">new</span> StringAddress(<span class="string">&quot;World!&quot;</span>));</span><br><span class="line">    System.out.println(list);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output: (Sample)</span></span><br><span class="line"><span class="comment">[StringAddress@82ba41 Hello, StringAddress@82ba41 Hello, StringAddress@82ba41 Hello, StringAddress@82ba41 Hello]</span></span><br><span class="line"><span class="comment">[StringAddress@923e30 World!, StringAddress@923e30 World!, StringAddress@923e30 World!, StringAddress@923e30 World!]</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<p>这个示例展示了两种用对单个对象的引用来填充<code>Collection</code>的方式，第一种是使用<code>Collection.nCopies()</code>创建传递给构造器的<code>List</code>，这里填充的是<code>ArrayList</code>。第二种使用的<code>fill()</code>方法的用处更有限，因为它只能替换已经在<code>List</code>中存在的元素，而不能添加新的元素。</p>
<h3 id="2-1-一种Generator解决方案"><a href="#2-1-一种Generator解决方案" class="headerlink" title="2.1 一种Generator解决方案"></a>2.1 一种Generator解决方案</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: net/mindview/util/CollectionData.java</span></span><br><span class="line"><span class="comment">// A Collection filled with data using a generator object.</span></span><br><span class="line"><span class="keyword">package</span> net.mindview.util;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionData</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">ArrayList</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CollectionData</span><span class="params">(Generator&lt;T&gt; gen, <span class="keyword">int</span> quantity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; quantity; i++)</span><br><span class="line">      add(gen.next());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// A generic convenience method:</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">CollectionData&lt;T&gt; <span class="title">list</span><span class="params">(Generator&lt;T&gt; gen, <span class="keyword">int</span> quantity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CollectionData&lt;T&gt;(gen, quantity);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/CollectionDataTest.java</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Government</span> <span class="keyword">implements</span> <span class="title">Generator</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">  String[] foundation = (<span class="string">&quot;strange women lying in ponds &quot;</span> +</span><br><span class="line">    <span class="string">&quot;distributing swords is no basis for a system of &quot;</span> +</span><br><span class="line">    <span class="string">&quot;government&quot;</span>).split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> index;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">next</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> foundation[index++]; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionDataTest</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Set&lt;String&gt; set = <span class="keyword">new</span> LinkedHashSet&lt;String&gt;(</span><br><span class="line">      <span class="keyword">new</span> CollectionData&lt;String&gt;(<span class="keyword">new</span> Government(), <span class="number">15</span>));</span><br><span class="line">    <span class="comment">// Using the convenience method:</span></span><br><span class="line">    set.addAll(CollectionData.list(<span class="keyword">new</span> Government(), <span class="number">15</span>));</span><br><span class="line">    System.out.println(set);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">[strange, women, lying, in, ponds, distributing, swords, is, no, basis, for, a, system, of, government]</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<p>这些元素的顺序与它们的插入顺序相同，因为<code>LinkedHashSet</code>维护的是保持了插入顺序的链接列表。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/CollectionDataTest.java</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Government</span> <span class="keyword">implements</span> <span class="title">Generator</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">  String[] foundation = (<span class="string">&quot;strange women lying in ponds &quot;</span> +</span><br><span class="line">    <span class="string">&quot;distributing swords is no basis for a system of &quot;</span> +</span><br><span class="line">    <span class="string">&quot;government&quot;</span>).split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> index;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">next</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> foundation[index++]; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionDataTest</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Set&lt;String&gt; set = <span class="keyword">new</span> LinkedHashSet&lt;String&gt;(</span><br><span class="line">      <span class="keyword">new</span> CollectionData&lt;String&gt;(<span class="keyword">new</span> Government(), <span class="number">15</span>));</span><br><span class="line">    <span class="comment">// Using the convenience method:</span></span><br><span class="line">    set.addAll(CollectionData.list(<span class="keyword">new</span> Government(), <span class="number">15</span>));</span><br><span class="line">    System.out.println(set);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">[strange, women, lying, in, ponds, distributing, swords, is, no, basis, for, a, system, of, government]</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/CollectionDataGeneration.java</span></span><br><span class="line"><span class="comment">// Using the Generators defined in the Arrays chapter.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionDataGeneration</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="keyword">new</span> ArrayList&lt;String&gt;(</span><br><span class="line">      CollectionData.list( <span class="comment">// Convenience method</span></span><br><span class="line">        <span class="keyword">new</span> RandomGenerator.String(<span class="number">9</span>), <span class="number">10</span>)));</span><br><span class="line">    System.out.println(<span class="keyword">new</span> HashSet&lt;Integer&gt;(</span><br><span class="line">      <span class="keyword">new</span> CollectionData&lt;Integer&gt;(</span><br><span class="line">        <span class="keyword">new</span> RandomGenerator.Integer(), <span class="number">10</span>)));</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">[YNzbrnyGc, FOWZnTcQr, GseGZMmJM, RoEsuEcUO, neOEdLsmw, HLGEahKcx, rEqUCBbkI, naMesbtWH, kjUrUkZPg, wsqPzDyCy]</span></span><br><span class="line"><span class="comment">[573, 4779, 871, 4367, 6090, 7882, 2017, 8037, 3455, 299]</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-Map生成器"><a href="#2-2-Map生成器" class="headerlink" title="2.2 Map生成器"></a>2.2 Map生成器</h3><p>定义第一个<code>Pair</code>类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: net/mindview/util/Pair.java</span></span><br><span class="line"><span class="keyword">package</span> net.mindview.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pair</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">final</span> K key;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">final</span> V value;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Pair</span><span class="params">(K k, V v)</span> </span>&#123;</span><br><span class="line">    key = k;</span><br><span class="line">    value = v;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: net/mindview/util/MapData.java</span></span><br><span class="line"><span class="comment">// A Map filled with data using a generator object.</span></span><br><span class="line"><span class="keyword">package</span> net.mindview.util;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapData</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">LinkedHashMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// A single Pair Generator:</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MapData</span><span class="params">(Generator&lt;Pair&lt;K,V&gt;&gt; gen, <span class="keyword">int</span> quantity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; quantity; i++) &#123;</span><br><span class="line">      Pair&lt;K,V&gt; p = gen.next();</span><br><span class="line">      put(p.key, p.value);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Two separate Generators:</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MapData</span><span class="params">(Generator&lt;K&gt; genK, Generator&lt;V&gt; genV,<span class="keyword">int</span> quantity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; quantity; i++) &#123;</span><br><span class="line">      put(genK.next(), genV.next());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// A key Generator and a single value:</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MapData</span><span class="params">(Generator&lt;K&gt; genK, V value, <span class="keyword">int</span> quantity)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; quantity; i++) &#123;</span><br><span class="line">      put(genK.next(), value);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// An Iterable and a value Generator:</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MapData</span><span class="params">(Iterable&lt;K&gt; genK, Generator&lt;V&gt; genV)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(K key : genK) &#123;</span><br><span class="line">      put(key, genV.next());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// An Iterable and a single value:</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MapData</span><span class="params">(Iterable&lt;K&gt; genK, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(K key : genK) &#123;</span><br><span class="line">      put(key, value);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Generic convenience methods:</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;K,V&gt; <span class="function">MapData&lt;K,V&gt; <span class="title">map</span><span class="params">(Generator&lt;Pair&lt;K,V&gt;&gt; gen, <span class="keyword">int</span> quantity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MapData&lt;K,V&gt;(gen, quantity);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;K,V&gt; <span class="function">MapData&lt;K,V&gt; <span class="title">map</span><span class="params">(Generator&lt;K&gt; genK, Generator&lt;V&gt; genV, <span class="keyword">int</span> quantity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MapData&lt;K,V&gt;(genK, genV, quantity);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;K,V&gt; <span class="function">MapData&lt;K,V&gt; <span class="title">map</span><span class="params">(Generator&lt;K&gt; genK, V value, <span class="keyword">int</span> quantity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MapData&lt;K,V&gt;(genK, value, quantity);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;K,V&gt; <span class="function">MapData&lt;K,V&gt; <span class="title">map</span><span class="params">(Iterable&lt;K&gt; genK, Generator&lt;V&gt; genV)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MapData&lt;K,V&gt;(genK, genV);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;K,V&gt; <span class="function">MapData&lt;K,V&gt; <span class="title">map</span><span class="params">(Iterable&lt;K&gt; genK, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MapData&lt;K,V&gt;(genK, value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/MapDataTest.java</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Letters</span> <span class="keyword">implements</span> <span class="title">Generator</span>&lt;<span class="title">Pair</span>&lt;<span class="title">Integer</span>,<span class="title">String</span>&gt;&gt;,</span></span><br><span class="line"><span class="class">  <span class="title">Iterable</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">9</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> number = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">char</span> letter = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pair&lt;Integer,String&gt; <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Pair&lt;Integer,String&gt;(</span><br><span class="line">      number++, <span class="string">&quot;&quot;</span> + letter++);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Iterator&lt;Integer&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Iterator&lt;Integer&gt;() &#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> Integer <span class="title">next</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> number++; &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> number &lt; size; &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapDataTest</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Pair Generator:</span></span><br><span class="line">    print(MapData.map(<span class="keyword">new</span> Letters(), <span class="number">11</span>));</span><br><span class="line">    <span class="comment">// Two separate generators:</span></span><br><span class="line">    print(MapData.map(<span class="keyword">new</span> CountingGenerator.Character(),</span><br><span class="line">      <span class="keyword">new</span> RandomGenerator.String(<span class="number">3</span>), <span class="number">8</span>));</span><br><span class="line">    <span class="comment">// A key Generator and a single value:</span></span><br><span class="line">    print(MapData.map(<span class="keyword">new</span> CountingGenerator.Character(),</span><br><span class="line">      <span class="string">&quot;Value&quot;</span>, <span class="number">6</span>));</span><br><span class="line">    <span class="comment">// An Iterable and a value Generator:</span></span><br><span class="line">    print(MapData.map(<span class="keyword">new</span> Letters(),</span><br><span class="line">      <span class="keyword">new</span> RandomGenerator.String(<span class="number">3</span>)));</span><br><span class="line">    <span class="comment">// An Iterable and a single value:</span></span><br><span class="line">    print(MapData.map(<span class="keyword">new</span> Letters(), <span class="string">&quot;Pop&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">&#123;1=A, 2=B, 3=C, 4=D, 5=E, 6=F, 7=G, 8=H, 9=I, 10=J, 11=K&#125;</span></span><br><span class="line"><span class="comment">&#123;a=YNz, b=brn, c=yGc, d=FOW, e=ZnT, f=cQr, g=Gse, h=GZM&#125;</span></span><br><span class="line"><span class="comment">&#123;a=Value, b=Value, c=Value, d=Value, e=Value, f=Value&#125;</span></span><br><span class="line"><span class="comment">&#123;1=mJM, 2=RoE, 3=suE, 4=cUO, 5=neO, 6=EdL, 7=smw, 8=HLG&#125;</span></span><br><span class="line"><span class="comment">&#123;1=Pop, 2=Pop, 3=Pop, 4=Pop, 5=Pop, 6=Pop, 7=Pop, 8=Pop&#125;</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-使用Abstract类"><a href="#2-3-使用Abstract类" class="headerlink" title="2.3 使用Abstract类"></a>2.3 使用Abstract类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: net/mindview/util/Countries.java</span></span><br><span class="line"><span class="comment">// &quot;Flyweight&quot; Maps and Lists of sample data.</span></span><br><span class="line"><span class="keyword">package</span> net.mindview.util;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Countries</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String[][] DATA = &#123;</span><br><span class="line">    <span class="comment">// Africa</span></span><br><span class="line">    &#123;<span class="string">&quot;ALGERIA&quot;</span>,<span class="string">&quot;Algiers&quot;</span>&#125;, &#123;<span class="string">&quot;ANGOLA&quot;</span>,<span class="string">&quot;Luanda&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BENIN&quot;</span>,<span class="string">&quot;Porto-Novo&quot;</span>&#125;, &#123;<span class="string">&quot;BOTSWANA&quot;</span>,<span class="string">&quot;Gaberone&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BURKINA FASO&quot;</span>,<span class="string">&quot;Ouagadougou&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BURUNDI&quot;</span>,<span class="string">&quot;Bujumbura&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;CAMEROON&quot;</span>,<span class="string">&quot;Yaounde&quot;</span>&#125;, &#123;<span class="string">&quot;CAPE VERDE&quot;</span>,<span class="string">&quot;Praia&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;CENTRAL AFRICAN REPUBLIC&quot;</span>,<span class="string">&quot;Bangui&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;CHAD&quot;</span>,<span class="string">&quot;N&#x27;djamena&quot;</span>&#125;,  &#123;<span class="string">&quot;COMOROS&quot;</span>,<span class="string">&quot;Moroni&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;CONGO&quot;</span>,<span class="string">&quot;Brazzaville&quot;</span>&#125;, &#123;<span class="string">&quot;DJIBOUTI&quot;</span>,<span class="string">&quot;Dijibouti&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;EGYPT&quot;</span>,<span class="string">&quot;Cairo&quot;</span>&#125;, &#123;<span class="string">&quot;EQUATORIAL GUINEA&quot;</span>,<span class="string">&quot;Malabo&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;ERITREA&quot;</span>,<span class="string">&quot;Asmara&quot;</span>&#125;, &#123;<span class="string">&quot;ETHIOPIA&quot;</span>,<span class="string">&quot;Addis Ababa&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;GABON&quot;</span>,<span class="string">&quot;Libreville&quot;</span>&#125;, &#123;<span class="string">&quot;THE GAMBIA&quot;</span>,<span class="string">&quot;Banjul&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;GHANA&quot;</span>,<span class="string">&quot;Accra&quot;</span>&#125;, &#123;<span class="string">&quot;GUINEA&quot;</span>,<span class="string">&quot;Conakry&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BISSAU&quot;</span>,<span class="string">&quot;Bissau&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;COTE D&#x27;IVOIR (IVORY COAST)&quot;</span>,<span class="string">&quot;Yamoussoukro&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;KENYA&quot;</span>,<span class="string">&quot;Nairobi&quot;</span>&#125;, &#123;<span class="string">&quot;LESOTHO&quot;</span>,<span class="string">&quot;Maseru&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;LIBERIA&quot;</span>,<span class="string">&quot;Monrovia&quot;</span>&#125;, &#123;<span class="string">&quot;LIBYA&quot;</span>,<span class="string">&quot;Tripoli&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MADAGASCAR&quot;</span>,<span class="string">&quot;Antananarivo&quot;</span>&#125;, &#123;<span class="string">&quot;MALAWI&quot;</span>,<span class="string">&quot;Lilongwe&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MALI&quot;</span>,<span class="string">&quot;Bamako&quot;</span>&#125;, &#123;<span class="string">&quot;MAURITANIA&quot;</span>,<span class="string">&quot;Nouakchott&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MAURITIUS&quot;</span>,<span class="string">&quot;Port Louis&quot;</span>&#125;, &#123;<span class="string">&quot;MOROCCO&quot;</span>,<span class="string">&quot;Rabat&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MOZAMBIQUE&quot;</span>,<span class="string">&quot;Maputo&quot;</span>&#125;, &#123;<span class="string">&quot;NAMIBIA&quot;</span>,<span class="string">&quot;Windhoek&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;NIGER&quot;</span>,<span class="string">&quot;Niamey&quot;</span>&#125;, &#123;<span class="string">&quot;NIGERIA&quot;</span>,<span class="string">&quot;Abuja&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;RWANDA&quot;</span>,<span class="string">&quot;Kigali&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SAO TOME E PRINCIPE&quot;</span>,<span class="string">&quot;Sao Tome&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SENEGAL&quot;</span>,<span class="string">&quot;Dakar&quot;</span>&#125;, &#123;<span class="string">&quot;SEYCHELLES&quot;</span>,<span class="string">&quot;Victoria&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SIERRA LEONE&quot;</span>,<span class="string">&quot;Freetown&quot;</span>&#125;, &#123;<span class="string">&quot;SOMALIA&quot;</span>,<span class="string">&quot;Mogadishu&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SOUTH AFRICA&quot;</span>,<span class="string">&quot;Pretoria/Cape Town&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SUDAN&quot;</span>,<span class="string">&quot;Khartoum&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SWAZILAND&quot;</span>,<span class="string">&quot;Mbabane&quot;</span>&#125;, &#123;<span class="string">&quot;TANZANIA&quot;</span>,<span class="string">&quot;Dodoma&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;TOGO&quot;</span>,<span class="string">&quot;Lome&quot;</span>&#125;, &#123;<span class="string">&quot;TUNISIA&quot;</span>,<span class="string">&quot;Tunis&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;UGANDA&quot;</span>,<span class="string">&quot;Kampala&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;DEMOCRATIC REPUBLIC OF THE CONGO (ZAIRE)&quot;</span>,</span><br><span class="line">     <span class="string">&quot;Kinshasa&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;ZAMBIA&quot;</span>,<span class="string">&quot;Lusaka&quot;</span>&#125;, &#123;<span class="string">&quot;ZIMBABWE&quot;</span>,<span class="string">&quot;Harare&quot;</span>&#125;,</span><br><span class="line">    <span class="comment">// Asia</span></span><br><span class="line">    &#123;<span class="string">&quot;AFGHANISTAN&quot;</span>,<span class="string">&quot;Kabul&quot;</span>&#125;, &#123;<span class="string">&quot;BAHRAIN&quot;</span>,<span class="string">&quot;Manama&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BANGLADESH&quot;</span>,<span class="string">&quot;Dhaka&quot;</span>&#125;, &#123;<span class="string">&quot;BHUTAN&quot;</span>,<span class="string">&quot;Thimphu&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BRUNEI&quot;</span>,<span class="string">&quot;Bandar Seri Begawan&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;CAMBODIA&quot;</span>,<span class="string">&quot;Phnom Penh&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;CHINA&quot;</span>,<span class="string">&quot;Beijing&quot;</span>&#125;, &#123;<span class="string">&quot;CYPRUS&quot;</span>,<span class="string">&quot;Nicosia&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;INDIA&quot;</span>,<span class="string">&quot;New Delhi&quot;</span>&#125;, &#123;<span class="string">&quot;INDONESIA&quot;</span>,<span class="string">&quot;Jakarta&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;IRAN&quot;</span>,<span class="string">&quot;Tehran&quot;</span>&#125;, &#123;<span class="string">&quot;IRAQ&quot;</span>,<span class="string">&quot;Baghdad&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;ISRAEL&quot;</span>,<span class="string">&quot;Jerusalem&quot;</span>&#125;, &#123;<span class="string">&quot;JAPAN&quot;</span>,<span class="string">&quot;Tokyo&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;JORDAN&quot;</span>,<span class="string">&quot;Amman&quot;</span>&#125;, &#123;<span class="string">&quot;KUWAIT&quot;</span>,<span class="string">&quot;Kuwait City&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;LAOS&quot;</span>,<span class="string">&quot;Vientiane&quot;</span>&#125;, &#123;<span class="string">&quot;LEBANON&quot;</span>,<span class="string">&quot;Beirut&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MALAYSIA&quot;</span>,<span class="string">&quot;Kuala Lumpur&quot;</span>&#125;, &#123;<span class="string">&quot;THE MALDIVES&quot;</span>,<span class="string">&quot;Male&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MONGOLIA&quot;</span>,<span class="string">&quot;Ulan Bator&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MYANMAR (BURMA)&quot;</span>,<span class="string">&quot;Rangoon&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;NEPAL&quot;</span>,<span class="string">&quot;Katmandu&quot;</span>&#125;, &#123;<span class="string">&quot;NORTH KOREA&quot;</span>,<span class="string">&quot;P&#x27;yongyang&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;OMAN&quot;</span>,<span class="string">&quot;Muscat&quot;</span>&#125;, &#123;<span class="string">&quot;PAKISTAN&quot;</span>,<span class="string">&quot;Islamabad&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;PHILIPPINES&quot;</span>,<span class="string">&quot;Manila&quot;</span>&#125;, &#123;<span class="string">&quot;QATAR&quot;</span>,<span class="string">&quot;Doha&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SAUDI ARABIA&quot;</span>,<span class="string">&quot;Riyadh&quot;</span>&#125;, &#123;<span class="string">&quot;SINGAPORE&quot;</span>,<span class="string">&quot;Singapore&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SOUTH KOREA&quot;</span>,<span class="string">&quot;Seoul&quot;</span>&#125;, &#123;<span class="string">&quot;SRI LANKA&quot;</span>,<span class="string">&quot;Colombo&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SYRIA&quot;</span>,<span class="string">&quot;Damascus&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;TAIWAN (REPUBLIC OF CHINA)&quot;</span>,<span class="string">&quot;Taipei&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;THAILAND&quot;</span>,<span class="string">&quot;Bangkok&quot;</span>&#125;, &#123;<span class="string">&quot;TURKEY&quot;</span>,<span class="string">&quot;Ankara&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;UNITED ARAB EMIRATES&quot;</span>,<span class="string">&quot;Abu Dhabi&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;VIETNAM&quot;</span>,<span class="string">&quot;Hanoi&quot;</span>&#125;, &#123;<span class="string">&quot;YEMEN&quot;</span>,<span class="string">&quot;Sana&#x27;a&quot;</span>&#125;,</span><br><span class="line">    <span class="comment">// Australia and Oceania</span></span><br><span class="line">    &#123;<span class="string">&quot;AUSTRALIA&quot;</span>,<span class="string">&quot;Canberra&quot;</span>&#125;, &#123;<span class="string">&quot;FIJI&quot;</span>,<span class="string">&quot;Suva&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;KIRIBATI&quot;</span>,<span class="string">&quot;Bairiki&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MARSHALL ISLANDS&quot;</span>,<span class="string">&quot;Dalap-Uliga-Darrit&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MICRONESIA&quot;</span>,<span class="string">&quot;Palikir&quot;</span>&#125;, &#123;<span class="string">&quot;NAURU&quot;</span>,<span class="string">&quot;Yaren&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;NEW ZEALAND&quot;</span>,<span class="string">&quot;Wellington&quot;</span>&#125;, &#123;<span class="string">&quot;PALAU&quot;</span>,<span class="string">&quot;Koror&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;PAPUA NEW GUINEA&quot;</span>,<span class="string">&quot;Port Moresby&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SOLOMON ISLANDS&quot;</span>,<span class="string">&quot;Honaira&quot;</span>&#125;, &#123;<span class="string">&quot;TONGA&quot;</span>,<span class="string">&quot;Nuku&#x27;alofa&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;TUVALU&quot;</span>,<span class="string">&quot;Fongafale&quot;</span>&#125;, &#123;<span class="string">&quot;VANUATU&quot;</span>,<span class="string">&quot;&lt; Port-Vila&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;WESTERN SAMOA&quot;</span>,<span class="string">&quot;Apia&quot;</span>&#125;,</span><br><span class="line">    <span class="comment">// Eastern Europe and former USSR</span></span><br><span class="line">    &#123;<span class="string">&quot;ARMENIA&quot;</span>,<span class="string">&quot;Yerevan&quot;</span>&#125;, &#123;<span class="string">&quot;AZERBAIJAN&quot;</span>,<span class="string">&quot;Baku&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BELARUS (BYELORUSSIA)&quot;</span>,<span class="string">&quot;Minsk&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BULGARIA&quot;</span>,<span class="string">&quot;Sofia&quot;</span>&#125;, &#123;<span class="string">&quot;GEORGIA&quot;</span>,<span class="string">&quot;Tbilisi&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;KAZAKSTAN&quot;</span>,<span class="string">&quot;Almaty&quot;</span>&#125;, &#123;<span class="string">&quot;KYRGYZSTAN&quot;</span>,<span class="string">&quot;Alma-Ata&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MOLDOVA&quot;</span>,<span class="string">&quot;Chisinau&quot;</span>&#125;, &#123;<span class="string">&quot;RUSSIA&quot;</span>,<span class="string">&quot;Moscow&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;TAJIKISTAN&quot;</span>,<span class="string">&quot;Dushanbe&quot;</span>&#125;, &#123;<span class="string">&quot;TURKMENISTAN&quot;</span>,<span class="string">&quot;Ashkabad&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;UKRAINE&quot;</span>,<span class="string">&quot;Kyiv&quot;</span>&#125;, &#123;<span class="string">&quot;UZBEKISTAN&quot;</span>,<span class="string">&quot;Tashkent&quot;</span>&#125;,</span><br><span class="line">    <span class="comment">// Europe</span></span><br><span class="line">    &#123;<span class="string">&quot;ALBANIA&quot;</span>,<span class="string">&quot;Tirana&quot;</span>&#125;, &#123;<span class="string">&quot;ANDORRA&quot;</span>,<span class="string">&quot;Andorra la Vella&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;AUSTRIA&quot;</span>,<span class="string">&quot;Vienna&quot;</span>&#125;, &#123;<span class="string">&quot;BELGIUM&quot;</span>,<span class="string">&quot;Brussels&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BOSNIA&quot;</span>,<span class="string">&quot;-&quot;</span>&#125;, &#123;<span class="string">&quot;HERZEGOVINA&quot;</span>,<span class="string">&quot;Sarajevo&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;CROATIA&quot;</span>,<span class="string">&quot;Zagreb&quot;</span>&#125;, &#123;<span class="string">&quot;CZECH REPUBLIC&quot;</span>,<span class="string">&quot;Prague&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;DENMARK&quot;</span>,<span class="string">&quot;Copenhagen&quot;</span>&#125;, &#123;<span class="string">&quot;ESTONIA&quot;</span>,<span class="string">&quot;Tallinn&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;FINLAND&quot;</span>,<span class="string">&quot;Helsinki&quot;</span>&#125;, &#123;<span class="string">&quot;FRANCE&quot;</span>,<span class="string">&quot;Paris&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;GERMANY&quot;</span>,<span class="string">&quot;Berlin&quot;</span>&#125;, &#123;<span class="string">&quot;GREECE&quot;</span>,<span class="string">&quot;Athens&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;HUNGARY&quot;</span>,<span class="string">&quot;Budapest&quot;</span>&#125;, &#123;<span class="string">&quot;ICELAND&quot;</span>,<span class="string">&quot;Reykjavik&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;IRELAND&quot;</span>,<span class="string">&quot;Dublin&quot;</span>&#125;, &#123;<span class="string">&quot;ITALY&quot;</span>,<span class="string">&quot;Rome&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;LATVIA&quot;</span>,<span class="string">&quot;Riga&quot;</span>&#125;, &#123;<span class="string">&quot;LIECHTENSTEIN&quot;</span>,<span class="string">&quot;Vaduz&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;LITHUANIA&quot;</span>,<span class="string">&quot;Vilnius&quot;</span>&#125;, &#123;<span class="string">&quot;LUXEMBOURG&quot;</span>,<span class="string">&quot;Luxembourg&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MACEDONIA&quot;</span>,<span class="string">&quot;Skopje&quot;</span>&#125;, &#123;<span class="string">&quot;MALTA&quot;</span>,<span class="string">&quot;Valletta&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MONACO&quot;</span>,<span class="string">&quot;Monaco&quot;</span>&#125;, &#123;<span class="string">&quot;MONTENEGRO&quot;</span>,<span class="string">&quot;Podgorica&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;THE NETHERLANDS&quot;</span>,<span class="string">&quot;Amsterdam&quot;</span>&#125;, &#123;<span class="string">&quot;NORWAY&quot;</span>,<span class="string">&quot;Oslo&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;POLAND&quot;</span>,<span class="string">&quot;Warsaw&quot;</span>&#125;, &#123;<span class="string">&quot;PORTUGAL&quot;</span>,<span class="string">&quot;Lisbon&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;ROMANIA&quot;</span>,<span class="string">&quot;Bucharest&quot;</span>&#125;, &#123;<span class="string">&quot;SAN MARINO&quot;</span>,<span class="string">&quot;San Marino&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SERBIA&quot;</span>,<span class="string">&quot;Belgrade&quot;</span>&#125;, &#123;<span class="string">&quot;SLOVAKIA&quot;</span>,<span class="string">&quot;Bratislava&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SLOVENIA&quot;</span>,<span class="string">&quot;Ljuijana&quot;</span>&#125;, &#123;<span class="string">&quot;SPAIN&quot;</span>,<span class="string">&quot;Madrid&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;SWEDEN&quot;</span>,<span class="string">&quot;Stockholm&quot;</span>&#125;, &#123;<span class="string">&quot;SWITZERLAND&quot;</span>,<span class="string">&quot;Berne&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;UNITED KINGDOM&quot;</span>,<span class="string">&quot;London&quot;</span>&#125;, &#123;<span class="string">&quot;VATICAN CITY&quot;</span>,<span class="string">&quot;---&quot;</span>&#125;,</span><br><span class="line">    <span class="comment">// North and Central America</span></span><br><span class="line">    &#123;<span class="string">&quot;ANTIGUA AND BARBUDA&quot;</span>,<span class="string">&quot;Saint John&#x27;s&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BAHAMAS&quot;</span>,<span class="string">&quot;Nassau&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BARBADOS&quot;</span>,<span class="string">&quot;Bridgetown&quot;</span>&#125;, &#123;<span class="string">&quot;BELIZE&quot;</span>,<span class="string">&quot;Belmopan&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;CANADA&quot;</span>,<span class="string">&quot;Ottawa&quot;</span>&#125;, &#123;<span class="string">&quot;COSTA RICA&quot;</span>,<span class="string">&quot;San Jose&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;CUBA&quot;</span>,<span class="string">&quot;Havana&quot;</span>&#125;, &#123;<span class="string">&quot;DOMINICA&quot;</span>,<span class="string">&quot;Roseau&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;DOMINICAN REPUBLIC&quot;</span>,<span class="string">&quot;Santo Domingo&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;EL SALVADOR&quot;</span>,<span class="string">&quot;San Salvador&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;GRENADA&quot;</span>,<span class="string">&quot;Saint George&#x27;s&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;GUATEMALA&quot;</span>,<span class="string">&quot;Guatemala City&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;HAITI&quot;</span>,<span class="string">&quot;Port-au-Prince&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;HONDURAS&quot;</span>,<span class="string">&quot;Tegucigalpa&quot;</span>&#125;, &#123;<span class="string">&quot;JAMAICA&quot;</span>,<span class="string">&quot;Kingston&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;MEXICO&quot;</span>,<span class="string">&quot;Mexico City&quot;</span>&#125;, &#123;<span class="string">&quot;NICARAGUA&quot;</span>,<span class="string">&quot;Managua&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;PANAMA&quot;</span>,<span class="string">&quot;Panama City&quot;</span>&#125;, &#123;<span class="string">&quot;ST. KITTS&quot;</span>,<span class="string">&quot;-&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;NEVIS&quot;</span>,<span class="string">&quot;Basseterre&quot;</span>&#125;, &#123;<span class="string">&quot;ST. LUCIA&quot;</span>,<span class="string">&quot;Castries&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;ST. VINCENT AND THE GRENADINES&quot;</span>,<span class="string">&quot;Kingstown&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;UNITED STATES OF AMERICA&quot;</span>,<span class="string">&quot;Washington, D.C.&quot;</span>&#125;,</span><br><span class="line">    <span class="comment">// South America</span></span><br><span class="line">    &#123;<span class="string">&quot;ARGENTINA&quot;</span>,<span class="string">&quot;Buenos Aires&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BOLIVIA&quot;</span>,<span class="string">&quot;Sucre (legal)/La Paz(administrative)&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;BRAZIL&quot;</span>,<span class="string">&quot;Brasilia&quot;</span>&#125;, &#123;<span class="string">&quot;CHILE&quot;</span>,<span class="string">&quot;Santiago&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;COLOMBIA&quot;</span>,<span class="string">&quot;Bogota&quot;</span>&#125;, &#123;<span class="string">&quot;ECUADOR&quot;</span>,<span class="string">&quot;Quito&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;GUYANA&quot;</span>,<span class="string">&quot;Georgetown&quot;</span>&#125;, &#123;<span class="string">&quot;PARAGUAY&quot;</span>,<span class="string">&quot;Asuncion&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;PERU&quot;</span>,<span class="string">&quot;Lima&quot;</span>&#125;, &#123;<span class="string">&quot;SURINAME&quot;</span>,<span class="string">&quot;Paramaribo&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;TRINIDAD AND TOBAGO&quot;</span>,<span class="string">&quot;Port of Spain&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;URUGUAY&quot;</span>,<span class="string">&quot;Montevideo&quot;</span>&#125;, &#123;<span class="string">&quot;VENEZUELA&quot;</span>,<span class="string">&quot;Caracas&quot;</span>&#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// Use AbstractMap by implementing entrySet()</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyweightMap</span> <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span> <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">      <span class="keyword">int</span> index;</span><br><span class="line">      Entry(<span class="keyword">int</span> index) &#123; <span class="keyword">this</span>.index = index; &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DATA[index][<span class="number">0</span>].equals(o);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> String <span class="title">getKey</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> DATA[index][<span class="number">0</span>]; &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> DATA[index][<span class="number">1</span>]; &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> String <span class="title">setValue</span><span class="params">(String value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DATA[index][<span class="number">0</span>].hashCode();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Use AbstractSet by implementing size() &amp; iterator()</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">EntrySet</span> <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;&gt; </span>&#123;</span><br><span class="line">      <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">      EntrySet(<span class="keyword">int</span> size) &#123;</span><br><span class="line">        <span class="keyword">if</span>(size &lt; <span class="number">0</span>)</span><br><span class="line">          <span class="keyword">this</span>.size = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// Can&#x27;t be any bigger than the array:</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(size &gt; DATA.length)</span><br><span class="line">          <span class="keyword">this</span>.size = DATA.length;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          <span class="keyword">this</span>.size = size;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> size; &#125;</span><br><span class="line">      <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Iter</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;&gt; </span>&#123;</span><br><span class="line">        <span class="comment">// Only one Entry object per Iterator:</span></span><br><span class="line">        <span class="keyword">private</span> Entry entry = <span class="keyword">new</span> Entry(-<span class="number">1</span>);</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> entry.index &lt; size - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> Map.<span class="function">Entry&lt;String,String&gt; <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          entry.index++;</span><br><span class="line">          <span class="keyword">return</span> entry;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">public</span></span><br><span class="line">      Iterator&lt;Map.Entry&lt;String,String&gt;&gt; iterator() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Iter();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Set&lt;Map.Entry&lt;String,String&gt;&gt; entries = <span class="keyword">new</span> EntrySet(DATA.length);</span><br><span class="line">    <span class="keyword">public</span> Set&lt;Map.Entry&lt;String,String&gt;&gt; entrySet() &#123;</span><br><span class="line">      <span class="keyword">return</span> entries;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Create a partial map of &#x27;size&#x27; countries:</span></span><br><span class="line">  <span class="function"><span class="keyword">static</span> Map&lt;String,String&gt; <span class="title">select</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> FlyweightMap() &#123;</span><br><span class="line">      <span class="keyword">public</span> Set&lt;Map.Entry&lt;String,String&gt;&gt; entrySet() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> EntrySet(size);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> Map&lt;String,String&gt; map = <span class="keyword">new</span> FlyweightMap();</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; <span class="title">capitals</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> map; <span class="comment">// The entire map</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; <span class="title">capitals</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> select(size); <span class="comment">// A partial map</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> List&lt;String&gt; names = <span class="keyword">new</span> ArrayList&lt;String&gt;(map.keySet());</span><br><span class="line">  <span class="comment">// All the names:</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">names</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> names; &#125;</span><br><span class="line">  <span class="comment">// A partial list:</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">names</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;String&gt;(select(size).keySet());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    print(capitals(<span class="number">10</span>));</span><br><span class="line">    print(names(<span class="number">10</span>));</span><br><span class="line">    print(<span class="keyword">new</span> HashMap&lt;String,String&gt;(capitals(<span class="number">3</span>)));</span><br><span class="line">    print(<span class="keyword">new</span> LinkedHashMap&lt;String,String&gt;(capitals(<span class="number">3</span>)));</span><br><span class="line">    print(<span class="keyword">new</span> TreeMap&lt;String,String&gt;(capitals(<span class="number">3</span>)));</span><br><span class="line">    print(<span class="keyword">new</span> Hashtable&lt;String,String&gt;(capitals(<span class="number">3</span>)));</span><br><span class="line">    print(<span class="keyword">new</span> HashSet&lt;String&gt;(names(<span class="number">6</span>)));</span><br><span class="line">    print(<span class="keyword">new</span> LinkedHashSet&lt;String&gt;(names(<span class="number">6</span>)));</span><br><span class="line">    print(<span class="keyword">new</span> TreeSet&lt;String&gt;(names(<span class="number">6</span>)));</span><br><span class="line">    print(<span class="keyword">new</span> ArrayList&lt;String&gt;(names(<span class="number">6</span>)));</span><br><span class="line">    print(<span class="keyword">new</span> LinkedList&lt;String&gt;(names(<span class="number">6</span>)));</span><br><span class="line">    print(capitals().get(<span class="string">&quot;BRAZIL&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">&#123;ALGERIA=Algiers, ANGOLA=Luanda, BENIN=Porto-Novo, BOTSWANA=Gaberone, BULGARIA=Sofia, BURKINA FASO=Ouagadougou, BURUNDI=Bujumbura, CAMEROON=Yaounde, CAPE VERDE=Praia, CENTRAL AFRICAN REPUBLIC=Bangui&#125;</span></span><br><span class="line"><span class="comment">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO, BURUNDI, CAMEROON, CAPE VERDE, CENTRAL AFRICAN REPUBLIC]</span></span><br><span class="line"><span class="comment">&#123;BENIN=Porto-Novo, ANGOLA=Luanda, ALGERIA=Algiers&#125;</span></span><br><span class="line"><span class="comment">&#123;ALGERIA=Algiers, ANGOLA=Luanda, BENIN=Porto-Novo&#125;</span></span><br><span class="line"><span class="comment">&#123;ALGERIA=Algiers, ANGOLA=Luanda, BENIN=Porto-Novo&#125;</span></span><br><span class="line"><span class="comment">&#123;ALGERIA=Algiers, ANGOLA=Luanda, BENIN=Porto-Novo&#125;</span></span><br><span class="line"><span class="comment">[BULGARIA, BURKINA FASO, BOTSWANA, BENIN, ANGOLA, ALGERIA]</span></span><br><span class="line"><span class="comment">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]</span></span><br><span class="line"><span class="comment">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]</span></span><br><span class="line"><span class="comment">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]</span></span><br><span class="line"><span class="comment">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]</span></span><br><span class="line"><span class="comment">Brasilia</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: net/mindview/util/CountingMapData.java</span></span><br><span class="line"><span class="comment">// Unlimited-length Map containing sample data.</span></span><br><span class="line"><span class="keyword">package</span> net.mindview.util;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountingMapData</span> <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">Integer</span>,<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> String[] chars = <span class="string">&quot;A B C D E F G H I J K L M N O P Q R S T U V W X Y Z&quot;</span>.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CountingMapData</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(size &lt; <span class="number">0</span>) <span class="keyword">this</span>.size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>.size = size;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span> <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">Integer</span>,<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> index;</span><br><span class="line">    Entry(<span class="keyword">int</span> index) &#123; <span class="keyword">this</span>.index = index; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> Integer.valueOf(index).equals(o);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getKey</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> index; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> chars[index % chars.length] + Integer.toString(index / chars.length);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">setValue</span><span class="params">(String value)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> Integer.valueOf(index).hashCode();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> Set&lt;Map.Entry&lt;Integer, String&gt;&gt; entrySet() &#123;</span><br><span class="line">    <span class="comment">// LinkedHashSet retains initialization order:</span></span><br><span class="line">    Set&lt;Map.Entry&lt;Integer,String&gt;&gt; entries = <span class="keyword">new</span> LinkedHashSet&lt;Map.Entry&lt;Integer,String&gt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">      entries.add(<span class="keyword">new</span> Entry(i));</span><br><span class="line">    <span class="keyword">return</span> entries;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="keyword">new</span> CountingMapData(<span class="number">60</span>));<span class="comment">//调用toString方法，toString方法中调用entrySet()方法。</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;  <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">&#123;0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0, 9=J0, 10=K0, 11=L0, 12=M0, 13=N0, 14=O0, 15=P0, 16=Q0, 17=R0, 18=S0, 19=T0, 20=U0, 21=V0, 22=W0, 23=X0, 24=Y0, 25=Z0, 26=A1, 27=B1, 28=C1, 29=D1, 30=E1, 31=F1, 32=G1, 33=H1, 34=I1, 35=J1, 36=K1, 37=L1, 38=M1, 39=N1, 40=O1, 41=P1, 42=Q1, 43=R1, 44=S1, 45=T1, 46=U1, 47=V1, 48=W1, 49=X1, 50=Y1, 51=Z1, 52=A2, 53=B2, 54=C2, 55=D2, 56=E2, 57=F2, 58=G2, 59=H2&#125;</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h2 id="3-Collection的功能方法"><a href="#3-Collection的功能方法" class="headerlink" title="3.Collection的功能方法"></a>3.Collection的功能方法</h2><p><code>Collection</code>所有操作：</p>
<ul>
<li>boolean add(T)</li>
<li>boolean addAll(Collection&lt;? extends T&gt;)</li>
<li>void clear()</li>
<li>boolean contains(T)</li>
<li>boolean isEmpty()</li>
<li>Iterator iterator()</li>
<li>boolean remove(Object)</li>
<li>boolean removeAll(Collection&lt;?&gt;)</li>
<li>boolean retainAll(Collection&lt;?&gt;)：交集</li>
<li>int size()</li>
<li>Object[] toArray()：</li>
<li>T[] toArray(T[] a)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/CollectionMethods.java</span></span><br><span class="line"><span class="comment">// Things you can do with all Collections.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionMethods</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Collection&lt;String&gt; c = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    c.addAll(Countries.names(<span class="number">6</span>));</span><br><span class="line">    c.add(<span class="string">&quot;ten&quot;</span>);</span><br><span class="line">    c.add(<span class="string">&quot;eleven&quot;</span>);</span><br><span class="line">    print(c);</span><br><span class="line">    <span class="comment">// Make an array from the List:</span></span><br><span class="line">    Object[] array = c.toArray();</span><br><span class="line">    <span class="comment">// Make a String array from the List:</span></span><br><span class="line">    String[] str = c.toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);</span><br><span class="line">    <span class="comment">// Find max and min elements; this means</span></span><br><span class="line">    <span class="comment">// different things depending on the way</span></span><br><span class="line">    <span class="comment">// the Comparable interface is implemented:</span></span><br><span class="line">    print(<span class="string">&quot;Collections.max(c) = &quot;</span> + Collections.max(c));</span><br><span class="line">    print(<span class="string">&quot;Collections.min(c) = &quot;</span> + Collections.min(c));</span><br><span class="line">    <span class="comment">// Add a Collection to another Collection</span></span><br><span class="line">    Collection&lt;String&gt; c2 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    c2.addAll(Countries.names(<span class="number">6</span>));</span><br><span class="line">    c.addAll(c2);</span><br><span class="line">    print(c);</span><br><span class="line">    c.remove(Countries.DATA[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    print(c);</span><br><span class="line">    c.remove(Countries.DATA[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">    print(c);</span><br><span class="line">    <span class="comment">// Remove all components that are</span></span><br><span class="line">    <span class="comment">// in the argument collection:</span></span><br><span class="line">    c.removeAll(c2);</span><br><span class="line">    print(c);</span><br><span class="line">    c.addAll(c2);</span><br><span class="line">    print(c);</span><br><span class="line">    <span class="comment">// Is an element in this Collection?</span></span><br><span class="line">    String val = Countries.DATA[<span class="number">3</span>][<span class="number">0</span>];</span><br><span class="line">    print(<span class="string">&quot;c.contains(&quot;</span> + val  + <span class="string">&quot;) = &quot;</span> + c.contains(val));</span><br><span class="line">    <span class="comment">// Is a Collection in this Collection?</span></span><br><span class="line">    print(<span class="string">&quot;c.containsAll(c2) = &quot;</span> + c.containsAll(c2));</span><br><span class="line">    Collection&lt;String&gt; c3 =</span><br><span class="line">      ((List&lt;String&gt;)c).subList(<span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">    <span class="comment">// Keep all the elements that are in both</span></span><br><span class="line">    <span class="comment">// c2 and c3 (an intersection of sets):</span></span><br><span class="line">    c2.retainAll(c3);</span><br><span class="line">    print(c2);</span><br><span class="line">    <span class="comment">// Throw away all the elements</span></span><br><span class="line">    <span class="comment">// in c2 that also appear in c3:</span></span><br><span class="line">    c2.removeAll(c3);</span><br><span class="line">    print(<span class="string">&quot;c2.isEmpty() = &quot;</span> +  c2.isEmpty());</span><br><span class="line">    c = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    c.addAll(Countries.names(<span class="number">6</span>));</span><br><span class="line">    print(c);</span><br><span class="line">    c.clear(); <span class="comment">// Remove all elements</span></span><br><span class="line">    print(<span class="string">&quot;after c.clear():&quot;</span> + c);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO, ten, eleven]</span></span><br><span class="line"><span class="comment">Collections.max(c) = ten</span></span><br><span class="line"><span class="comment">Collections.min(c) = ALGERIA</span></span><br><span class="line"><span class="comment">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO, ten, eleven, ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]</span></span><br><span class="line"><span class="comment">[ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO, ten, eleven, ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]</span></span><br><span class="line"><span class="comment">[BENIN, BOTSWANA, BULGARIA, BURKINA FASO, ten, eleven, ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]</span></span><br><span class="line"><span class="comment">[ten, eleven]</span></span><br><span class="line"><span class="comment">[ten, eleven, ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]</span></span><br><span class="line"><span class="comment">c.contains(BOTSWANA) = true</span></span><br><span class="line"><span class="comment">c.containsAll(c2) = true</span></span><br><span class="line"><span class="comment">[ANGOLA, BENIN]</span></span><br><span class="line"><span class="comment">c2.isEmpty() = true</span></span><br><span class="line"><span class="comment">[ALGERIA, ANGOLA, BENIN, BOTSWANA, BULGARIA, BURKINA FASO]</span></span><br><span class="line"><span class="comment">after c.clear():[]</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h2 id="4-可选操作"><a href="#4-可选操作" class="headerlink" title="4.可选操作"></a>4.可选操作</h2><p>最常见的未获支持的操作，都来源于背后由固定尺寸的数据结构支持的容器。当你用<code>Arrays.asList()</code>将数组转换为<code>List</code>时，就会得到这样的容器。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/Unsupported.java</span></span><br><span class="line"><span class="comment">// Unsupported operations in Java containers.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Unsupported</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(String msg, List&lt;String&gt; list)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;--- &quot;</span> + msg + <span class="string">&quot; ---&quot;</span>);</span><br><span class="line">    Collection&lt;String&gt; c = list;</span><br><span class="line">    Collection&lt;String&gt; subList = list.subList(<span class="number">1</span>,<span class="number">8</span>);</span><br><span class="line">    <span class="comment">// Copy of the sublist:</span></span><br><span class="line">    Collection&lt;String&gt; c2 = <span class="keyword">new</span> ArrayList&lt;String&gt;(subList);</span><br><span class="line">    <span class="keyword">try</span> &#123; c.retainAll(c2); &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;retainAll(): &quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123; c.removeAll(c2); &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;removeAll(): &quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123; c.clear(); &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;clear(): &quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123; c.add(<span class="string">&quot;X&quot;</span>); &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;add(): &quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123; c.addAll(c2); &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;addAll(): &quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123; c.remove(<span class="string">&quot;C&quot;</span>); &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;remove(): &quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// The List.set() method modifies the value but</span></span><br><span class="line">    <span class="comment">// doesn&#x27;t change the size of the data structure:</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      list.set(<span class="number">0</span>, <span class="string">&quot;X&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;List.set(): &quot;</span> + e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    List&lt;String&gt; list =</span><br><span class="line">      Arrays.asList(<span class="string">&quot;A B C D E F G H I J K L&quot;</span>.split(<span class="string">&quot; &quot;</span>));</span><br><span class="line">    test(<span class="string">&quot;Modifiable Copy&quot;</span>, <span class="keyword">new</span> ArrayList&lt;String&gt;(list));</span><br><span class="line">    test(<span class="string">&quot;Arrays.asList()&quot;</span>, list);</span><br><span class="line">    test(<span class="string">&quot;unmodifiableList()&quot;</span>,</span><br><span class="line">      Collections.unmodifiableList(</span><br><span class="line">        <span class="keyword">new</span> ArrayList&lt;String&gt;(list)));</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">--- Modifiable Copy ---</span></span><br><span class="line"><span class="comment">--- Arrays.asList() ---</span></span><br><span class="line"><span class="comment">retainAll(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">removeAll(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">clear(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">add(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">addAll(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">remove(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">--- unmodifiableList() ---</span></span><br><span class="line"><span class="comment">retainAll(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">removeAll(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">clear(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">add(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">addAll(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">remove(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">List.set(): java.lang.UnsupportedOperationException</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<p>把<code>Arrays.asList()</code>的结果作为构造器的参数传递给任何<code>Collection</code>，这样可以生成允许使用所有的方法的普通容器</p>
<h2 id="5-List的功能方法"><a href="#5-List的功能方法" class="headerlink" title="5.List的功能方法"></a>5.List的功能方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/Lists.java</span></span><br><span class="line"><span class="comment">// Things you can do with Lists.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Lists</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> b;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> String s;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> i;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Iterator&lt;String&gt; it;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> ListIterator&lt;String&gt; lit;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">basicTest</span><span class="params">(List&lt;String&gt; a)</span> </span>&#123;</span><br><span class="line">    a.add(<span class="number">1</span>, <span class="string">&quot;x&quot;</span>); <span class="comment">// Add at location 1</span></span><br><span class="line">    a.add(<span class="string">&quot;x&quot;</span>); <span class="comment">// Add at end</span></span><br><span class="line">    <span class="comment">// Add a collection:</span></span><br><span class="line">    a.addAll(Countries.names(<span class="number">25</span>));</span><br><span class="line">    <span class="comment">// Add a collection starting at location 3:</span></span><br><span class="line">    a.addAll(<span class="number">3</span>, Countries.names(<span class="number">25</span>));</span><br><span class="line">    b = a.contains(<span class="string">&quot;1&quot;</span>); <span class="comment">// Is it in there?</span></span><br><span class="line">    <span class="comment">// Is the entire collection in there?</span></span><br><span class="line">    b = a.containsAll(Countries.names(<span class="number">25</span>));</span><br><span class="line">    <span class="comment">// Lists allow random access, which is cheap</span></span><br><span class="line">    <span class="comment">// for ArrayList, expensive for LinkedList:</span></span><br><span class="line">    s = a.get(<span class="number">1</span>); <span class="comment">// Get (typed) object at location 1</span></span><br><span class="line">    i = a.indexOf(<span class="string">&quot;1&quot;</span>); <span class="comment">// Tell index of object</span></span><br><span class="line">    b = a.isEmpty(); <span class="comment">// Any elements inside?</span></span><br><span class="line">    it = a.iterator(); <span class="comment">// Ordinary Iterator</span></span><br><span class="line">    lit = a.listIterator(); <span class="comment">// ListIterator</span></span><br><span class="line">    lit = a.listIterator(<span class="number">3</span>); <span class="comment">// Start at loc 3</span></span><br><span class="line">    i = a.lastIndexOf(<span class="string">&quot;1&quot;</span>); <span class="comment">// Last match</span></span><br><span class="line">    a.remove(<span class="number">1</span>); <span class="comment">// Remove location 1</span></span><br><span class="line">    a.remove(<span class="string">&quot;3&quot;</span>); <span class="comment">// Remove this object</span></span><br><span class="line">    a.set(<span class="number">1</span>, <span class="string">&quot;y&quot;</span>); <span class="comment">// Set location 1 to &quot;y&quot;</span></span><br><span class="line">    <span class="comment">// Keep everything that&#x27;s in the argument</span></span><br><span class="line">    <span class="comment">// (the intersection of the two sets):</span></span><br><span class="line">    a.retainAll(Countries.names(<span class="number">25</span>));</span><br><span class="line">    <span class="comment">// Remove everything that&#x27;s in the argument:</span></span><br><span class="line">    a.removeAll(Countries.names(<span class="number">25</span>));</span><br><span class="line">    i = a.size(); <span class="comment">// How big is it?</span></span><br><span class="line">    a.clear(); <span class="comment">// Remove all elements</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">iterMotion</span><span class="params">(List&lt;String&gt; a)</span> </span>&#123;</span><br><span class="line">    ListIterator&lt;String&gt; it = a.listIterator();</span><br><span class="line">    b = it.hasNext();</span><br><span class="line">    b = it.hasPrevious();</span><br><span class="line">    s = it.next();</span><br><span class="line">    i = it.nextIndex();</span><br><span class="line">    s = it.previous();</span><br><span class="line">    i = it.previousIndex();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">iterManipulation</span><span class="params">(List&lt;String&gt; a)</span> </span>&#123;</span><br><span class="line">    ListIterator&lt;String&gt; it = a.listIterator();</span><br><span class="line">    it.add(<span class="string">&quot;47&quot;</span>);</span><br><span class="line">    <span class="comment">// Must move to an element after add():</span></span><br><span class="line">    it.next();</span><br><span class="line">    <span class="comment">// Remove the element after the newly produced one:</span></span><br><span class="line">    it.remove();</span><br><span class="line">    <span class="comment">// Must move to an element after remove():</span></span><br><span class="line">    it.next();</span><br><span class="line">    <span class="comment">// Change the element after the deleted one:</span></span><br><span class="line">    it.set(<span class="string">&quot;47&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testVisual</span><span class="params">(List&lt;String&gt; a)</span> </span>&#123;</span><br><span class="line">    print(a);</span><br><span class="line">    List&lt;String&gt; b = Countries.names(<span class="number">25</span>);</span><br><span class="line">    print(<span class="string">&quot;b = &quot;</span> + b);</span><br><span class="line">    a.addAll(b);</span><br><span class="line">    a.addAll(b);</span><br><span class="line">    print(a);</span><br><span class="line">    <span class="comment">// Insert, remove, and replace elements</span></span><br><span class="line">    <span class="comment">// using a ListIterator:</span></span><br><span class="line">    ListIterator&lt;String&gt; x = a.listIterator(a.size()/<span class="number">2</span>);</span><br><span class="line">    x.add(<span class="string">&quot;one&quot;</span>);</span><br><span class="line">    print(a);</span><br><span class="line">    print(x.next());</span><br><span class="line">    x.remove();</span><br><span class="line">    print(x.next());</span><br><span class="line">    x.set(<span class="string">&quot;47&quot;</span>);</span><br><span class="line">    print(a);</span><br><span class="line">    <span class="comment">// Traverse the list backwards:</span></span><br><span class="line">    x = a.listIterator(a.size());</span><br><span class="line">    <span class="keyword">while</span>(x.hasPrevious())</span><br><span class="line">      printnb(x.previous() + <span class="string">&quot; &quot;</span>);</span><br><span class="line">    print();</span><br><span class="line">    print(<span class="string">&quot;testVisual finished&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// There are some things that only LinkedLists can do:</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testLinkedList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LinkedList&lt;String&gt; ll = <span class="keyword">new</span> LinkedList&lt;String&gt;();</span><br><span class="line">    ll.addAll(Countries.names(<span class="number">25</span>));</span><br><span class="line">    print(ll);</span><br><span class="line">    <span class="comment">// Treat it like a stack, pushing:</span></span><br><span class="line">    ll.addFirst(<span class="string">&quot;one&quot;</span>);</span><br><span class="line">    ll.addFirst(<span class="string">&quot;two&quot;</span>);</span><br><span class="line">    print(ll);</span><br><span class="line">    <span class="comment">// Like &quot;peeking&quot; at the top of a stack:</span></span><br><span class="line">    print(ll.getFirst());</span><br><span class="line">    <span class="comment">// Like popping a stack:</span></span><br><span class="line">    print(ll.removeFirst());</span><br><span class="line">    print(ll.removeFirst());</span><br><span class="line">    <span class="comment">// Treat it like a queue, pulling elements</span></span><br><span class="line">    <span class="comment">// off the tail end:</span></span><br><span class="line">    print(ll.removeLast());</span><br><span class="line">    print(ll);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Make and fill a new list each time:</span></span><br><span class="line">    basicTest(</span><br><span class="line">      <span class="keyword">new</span> LinkedList&lt;String&gt;(Countries.names(<span class="number">25</span>)));</span><br><span class="line">    basicTest(</span><br><span class="line">      <span class="keyword">new</span> ArrayList&lt;String&gt;(Countries.names(<span class="number">25</span>)));</span><br><span class="line">    iterMotion(</span><br><span class="line">      <span class="keyword">new</span> LinkedList&lt;String&gt;(Countries.names(<span class="number">25</span>)));</span><br><span class="line">    iterMotion(</span><br><span class="line">      <span class="keyword">new</span> ArrayList&lt;String&gt;(Countries.names(<span class="number">25</span>)));</span><br><span class="line">    iterManipulation(</span><br><span class="line">      <span class="keyword">new</span> LinkedList&lt;String&gt;(Countries.names(<span class="number">25</span>)));</span><br><span class="line">    iterManipulation(</span><br><span class="line">      <span class="keyword">new</span> ArrayList&lt;String&gt;(Countries.names(<span class="number">25</span>)));</span><br><span class="line">    testVisual(</span><br><span class="line">      <span class="keyword">new</span> LinkedList&lt;String&gt;(Countries.names(<span class="number">25</span>)));</span><br><span class="line">    testLinkedList();</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* (Execute to see output) */</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h2 id="6-Set和存储顺序"><a href="#6-Set和存储顺序" class="headerlink" title="6.Set和存储顺序"></a>6.Set和存储顺序</h2><ul>
<li>Set(interface)：存入<code>Set</code>的每个元素都必须是唯一的，因为<code>Set</code>不保存重复元素，加入<code>Set</code>的元素必须定义<code>equals()</code>方法以确保对象的唯一性。<code>Set</code>与<code>Collection</code>有完全一样的接口。<code>Set</code>接口不保证维护元素的次序。</li>
<li>HashSet：为快速查找而设计的<code>Set</code>，存入<code>HashSet</code>的元素必须定义<code>hasCode()</code>。</li>
<li>TreeSet：保持次序的Set，底层为树结构，使用它可以从<code>Set</code>中提取有序的序列，元素必须实现<code>Comparable</code>接口。</li>
<li>LinkedHashSet：具有<code>HashSet</code>的查询速度，且内部使用链表维护元素的顺序。于是在使用迭代器遍历<code>Set</code>时，结果会按元素插入的次序显示，元素也必须定义<code>hashCode()</code>方法。</li>
</ul>
<p>你必须为散列存储和树型存储都创建一个<code>equals()</code>方法。但是<code>hashCode()</code>只有在这个类将会被置于<code>HashSet</code>或者<code>LinkedHashSet</code>中时才是必须的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/TypesForSets.java</span></span><br><span class="line"><span class="comment">// Methods necessary to put your own type in a Set.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SetType</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">SetType</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; i = n; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> o <span class="keyword">instanceof</span> SetType &amp;&amp; (i == ((SetType)o).i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> Integer.toString(i); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HashType</span> <span class="keyword">extends</span> <span class="title">SetType</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">HashType</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; <span class="keyword">super</span>(n); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> i; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeType</span> <span class="keyword">extends</span> <span class="title">SetType</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">TreeType</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TreeType</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; <span class="keyword">super</span>(n); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(TreeType arg)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (arg.i &lt; i ? -<span class="number">1</span> : (arg.i == i ? <span class="number">0</span> : <span class="number">1</span>));<span class="comment">//倒序</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypesForSets</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> &lt;T&gt; <span class="function">Set&lt;T&gt; <span class="title">fill</span><span class="params">(Set&lt;T&gt; set, Class&lt;T&gt; type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">          set.add(type.getConstructor(<span class="keyword">int</span>.class).newInstance(i));</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> set;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(Set&lt;T&gt; set, Class&lt;T&gt; type)</span> </span>&#123;</span><br><span class="line">    fill(set, type);</span><br><span class="line">    fill(set, type); <span class="comment">// Try to add duplicates</span></span><br><span class="line">    fill(set, type);</span><br><span class="line">    System.out.println(set);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    test(<span class="keyword">new</span> HashSet&lt;HashType&gt;(), HashType.class);</span><br><span class="line">    test(<span class="keyword">new</span> LinkedHashSet&lt;HashType&gt;(), HashType.class);</span><br><span class="line">    test(<span class="keyword">new</span> TreeSet&lt;TreeType&gt;(), TreeType.class);</span><br><span class="line">    <span class="comment">// Things that don&#x27;t work:</span></span><br><span class="line">    test(<span class="keyword">new</span> HashSet&lt;SetType&gt;(), SetType.class);</span><br><span class="line">    test(<span class="keyword">new</span> HashSet&lt;TreeType&gt;(), TreeType.class);</span><br><span class="line">    test(<span class="keyword">new</span> LinkedHashSet&lt;SetType&gt;(), SetType.class);</span><br><span class="line">    test(<span class="keyword">new</span> LinkedHashSet&lt;TreeType&gt;(), TreeType.class);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      test(<span class="keyword">new</span> TreeSet&lt;SetType&gt;(), SetType.class);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      test(<span class="keyword">new</span> TreeSet&lt;HashType&gt;(), HashType.class);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output: (Sample)</span></span><br><span class="line"><span class="comment">[2, 4, 9, 8, 6, 1, 3, 7, 5, 0]</span></span><br><span class="line"><span class="comment">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></span><br><span class="line"><span class="comment">[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]</span></span><br><span class="line"><span class="comment">[9, 9, 7, 5, 1, 2, 6, 3, 0, 7, 2, 4, 4, 7, 9, 1, 3, 6, 2, 4, 3, 0, 5, 0, 8, 8, 8, 6, 5, 1]//存储在HashSet的SetType</span></span><br><span class="line"><span class="comment">[0, 5, 5, 6, 5, 0, 3, 1, 9, 8, 4, 2, 3, 9, 7, 3, 4, 4, 0, 7, 1, 9, 6, 2, 1, 8, 2, 8, 6, 7]//存储在HashSet的TreeType</span></span><br><span class="line"><span class="comment">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></span><br><span class="line"><span class="comment">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></span><br><span class="line"><span class="comment">java.lang.ClassCastException: SetType cannot be cast to java.lang.Comparable</span></span><br><span class="line"><span class="comment">java.lang.ClassCastException: HashType cannot be cast to java.lang.Comparable</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<p>对于没有重新定义<code>hashCode()</code>方法的<code>SetType</code>或<code>TreeType</code>，如果将它们放置到任何散列实现中都会产生重复值，这样就违反了<code>Set</code>的基本契约。如果尝试着在<code>TreeSet</code>中使用没有实现<code>Comparable</code>的类型，将会抛出一个异常。</p>
<h3 id="6-1-SortedSet"><a href="#6-1-SortedSet" class="headerlink" title="6.1 SortedSet"></a>6.1 SortedSet</h3><ul>
<li>Object first()：返回容器中的第一个元素</li>
<li>Object last()：返回容器中的最末一个元素</li>
<li>Sorted subSet(fromElement,toElement)：生成此<code>Set</code>的子集，范围从<code>fromElement</code>（包含）到<code>toElement</code>（不包含）。</li>
<li>Sorted headSet(toElement)：生成此<code>Set</code>的子集，由小于<code>toElement</code>的元素组成。</li>
<li>Sorted tailSet(fromElement)：生成此<code>Set</code>的子集，由大于或等于<code>fromElement</code>的元素组成。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/SortedSetDemo.java</span></span><br><span class="line"><span class="comment">// What you can do with a TreeSet.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SortedSetDemo</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SortedSet&lt;String&gt; sortedSet = <span class="keyword">new</span> TreeSet&lt;String&gt;();</span><br><span class="line">    Collections.addAll(sortedSet,</span><br><span class="line">      <span class="string">&quot;one two three four five six seven eight&quot;</span></span><br><span class="line">        .split(<span class="string">&quot; &quot;</span>));</span><br><span class="line">    print(sortedSet);</span><br><span class="line">    String low = sortedSet.first();</span><br><span class="line">    String high = sortedSet.last();</span><br><span class="line">    print(low);</span><br><span class="line">    print(high);</span><br><span class="line">    Iterator&lt;String&gt; it = sortedSet.iterator();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span>(i == <span class="number">3</span>) low = it.next();</span><br><span class="line">      <span class="keyword">if</span>(i == <span class="number">6</span>) high = it.next();</span><br><span class="line">      <span class="keyword">else</span> it.next();</span><br><span class="line">    &#125;</span><br><span class="line">    print(low);</span><br><span class="line">    print(high);</span><br><span class="line">    print(sortedSet.subSet(low, high));</span><br><span class="line">    print(sortedSet.headSet(high));</span><br><span class="line">    print(sortedSet.tailSet(low));</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">[eight, five, four, one, seven, six, three, two]</span></span><br><span class="line"><span class="comment">eight</span></span><br><span class="line"><span class="comment">two</span></span><br><span class="line"><span class="comment">one</span></span><br><span class="line"><span class="comment">two</span></span><br><span class="line"><span class="comment">[one, seven, six, three]</span></span><br><span class="line"><span class="comment">[eight, five, four, one, seven, six, three]</span></span><br><span class="line"><span class="comment">[one, seven, six, three, two]</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h2 id="7-队列"><a href="#7-队列" class="headerlink" title="7.队列"></a>7.队列</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/QueueBehavior.java</span></span><br><span class="line"><span class="comment">// Compares the behavior of some of the queues</span></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueueBehavior</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(Queue&lt;T&gt; queue, Generator&lt;T&gt; gen)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">      queue.offer(gen.next());</span><br><span class="line">    <span class="keyword">while</span>(queue.peek() != <span class="keyword">null</span>)</span><br><span class="line">      System.out.print(queue.remove() + <span class="string">&quot; &quot;</span>);</span><br><span class="line">    System.out.println();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Gen</span> <span class="keyword">implements</span> <span class="title">Generator</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    String[] s = (<span class="string">&quot;one two three four five six seven &quot;</span> +</span><br><span class="line">      <span class="string">&quot;eight nine ten&quot;</span>).split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">next</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> s[i++]; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    test(<span class="keyword">new</span> LinkedList&lt;String&gt;(), <span class="keyword">new</span> Gen());</span><br><span class="line">    test(<span class="keyword">new</span> PriorityQueue&lt;String&gt;(), <span class="keyword">new</span> Gen());</span><br><span class="line">    test(<span class="keyword">new</span> ArrayBlockingQueue&lt;String&gt;(count), <span class="keyword">new</span> Gen());</span><br><span class="line">    test(<span class="keyword">new</span> ConcurrentLinkedQueue&lt;String&gt;(), <span class="keyword">new</span> Gen());</span><br><span class="line">    test(<span class="keyword">new</span> LinkedBlockingQueue&lt;String&gt;(), <span class="keyword">new</span> Gen());</span><br><span class="line">    test(<span class="keyword">new</span> PriorityBlockingQueue&lt;String&gt;(), <span class="keyword">new</span> Gen());</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">one two three four five six seven eight nine ten</span></span><br><span class="line"><span class="comment">eight five four nine one seven six ten three two</span></span><br><span class="line"><span class="comment">one two three four five six seven eight nine ten</span></span><br><span class="line"><span class="comment">one two three four five six seven eight nine ten</span></span><br><span class="line"><span class="comment">one two three four five six seven eight nine ten</span></span><br><span class="line"><span class="comment">eight five four nine one seven six ten three two</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<p>除了优先级队列，<code>Queue</code>将精确地按照元素被置于<code>Queue</code>中的顺序产生它们。</p>
<h3 id="7-1-优先级队列"><a href="#7-1-优先级队列" class="headerlink" title="7.1 优先级队列"></a>7.1 优先级队列</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/ToDoList.java</span></span><br><span class="line"><span class="comment">// A more complex use of PriorityQueue.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ToDoList</span> <span class="keyword">extends</span> <span class="title">PriorityQueue</span>&lt;<span class="title">ToDoList</span>.<span class="title">ToDoItem</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoItem</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">ToDoItem</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">char</span> primary;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> secondary;</span><br><span class="line">    <span class="keyword">private</span> String item;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ToDoItem</span><span class="params">(String td, <span class="keyword">char</span> pri, <span class="keyword">int</span> sec)</span> </span>&#123;</span><br><span class="line">      primary = pri;</span><br><span class="line">      secondary = sec;</span><br><span class="line">      item = td;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(ToDoItem arg)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(primary &gt; arg.primary)</span><br><span class="line">        <span class="keyword">return</span> +<span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span>(primary == arg.primary)</span><br><span class="line">        <span class="keyword">if</span>(secondary &gt; arg.secondary)</span><br><span class="line">          <span class="keyword">return</span> +<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(secondary == arg.secondary)</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> Character.toString(primary) +</span><br><span class="line">        secondary + <span class="string">&quot;: &quot;</span> + item;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String td, <span class="keyword">char</span> pri, <span class="keyword">int</span> sec)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.add(<span class="keyword">new</span> ToDoItem(td, pri, sec));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ToDoList toDoList = <span class="keyword">new</span> ToDoList();</span><br><span class="line">    toDoList.add(<span class="string">&quot;Empty trash&quot;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="number">4</span>);</span><br><span class="line">    toDoList.add(<span class="string">&quot;Feed dog&quot;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">    toDoList.add(<span class="string">&quot;Feed bird&quot;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="number">7</span>);</span><br><span class="line">    toDoList.add(<span class="string">&quot;Mow lawn&quot;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="number">3</span>);</span><br><span class="line">    toDoList.add(<span class="string">&quot;Water lawn&quot;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">    toDoList.add(<span class="string">&quot;Feed cat&quot;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span>(!toDoList.isEmpty())</span><br><span class="line">      System.out.println(toDoList.remove());</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">A1: Water lawn</span></span><br><span class="line"><span class="comment">A2: Feed dog</span></span><br><span class="line"><span class="comment">B1: Feed cat</span></span><br><span class="line"><span class="comment">B7: Feed bird</span></span><br><span class="line"><span class="comment">C3: Mow lawn</span></span><br><span class="line"><span class="comment">C4: Empty trash</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h3 id="7-2双向队列"><a href="#7-2双向队列" class="headerlink" title="7.2双向队列"></a>7.2双向队列</h3><p>在<code>LinkedList</code>中包含支持双向队列的方法，但是在<code>Java</code>标准类库中没有任何显式的用于双向队列的接口（本书基于JavaSE5，JavaSE6增加了<code>Deque</code>的接口）。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: net/mindview/util/Deque.java</span></span><br><span class="line"><span class="comment">// Creating a Deque from a LinkedList.</span></span><br><span class="line"><span class="keyword">package</span> net.mindview.util;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Deque</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> LinkedList&lt;T&gt; deque = <span class="keyword">new</span> LinkedList&lt;T&gt;();</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFirst</span><span class="params">(T e)</span> </span>&#123; deque.addFirst(e); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(T e)</span> </span>&#123; deque.addLast(e); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> T <span class="title">getFirst</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> deque.getFirst(); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> T <span class="title">getLast</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> deque.getLast(); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> T <span class="title">removeFirst</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> deque.removeFirst(); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> T <span class="title">removeLast</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> deque.removeLast(); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> deque.size(); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> deque.toString(); &#125;</span><br><span class="line">  <span class="comment">// And other methods as necessary...</span></span><br><span class="line">&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/DequeTest.java</span></span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DequeTest</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">fillTest</span><span class="params">(Deque&lt;Integer&gt; deque)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">20</span>; i &lt; <span class="number">27</span>; i++)</span><br><span class="line">      deque.addFirst(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">50</span>; i &lt; <span class="number">55</span>; i++)</span><br><span class="line">      deque.addLast(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Deque&lt;Integer&gt; di = <span class="keyword">new</span> Deque&lt;Integer&gt;();</span><br><span class="line">    fillTest(di);</span><br><span class="line">    print(di);</span><br><span class="line">    <span class="keyword">while</span>(di.size() != <span class="number">0</span>)</span><br><span class="line">      printnb(di.removeFirst() + <span class="string">&quot; &quot;</span>);</span><br><span class="line">    print();</span><br><span class="line">    fillTest(di);</span><br><span class="line">    <span class="keyword">while</span>(di.size() != <span class="number">0</span>)</span><br><span class="line">      printnb(di.removeLast() + <span class="string">&quot; &quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">[26, 25, 24, 23, 22, 21, 20, 50, 51, 52, 53, 54]</span></span><br><span class="line"><span class="comment">26 25 24 23 22 21 20 50 51 52 53 54</span></span><br><span class="line"><span class="comment">54 53 52 51 50 20 21 22 23 24 25 26</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h2 id="8-Map"><a href="#8-Map" class="headerlink" title="8.Map"></a>8.Map</h2><p><img src="https://i.imgur.com/iwoHbui.png" alt="Imgur"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/AssociativeArray.java</span></span><br><span class="line"><span class="comment">// Associates keys with values.</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AssociativeArray</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Object[][] pairs;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> index;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">AssociativeArray</span><span class="params">(<span class="keyword">int</span> length)</span> </span>&#123;</span><br><span class="line">    pairs = <span class="keyword">new</span> Object[length][<span class="number">2</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &gt;= pairs.length)</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> ArrayIndexOutOfBoundsException();</span><br><span class="line">    pairs[index++] = <span class="keyword">new</span> Object[]&#123; key, value &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(K key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; index; i++)</span><br><span class="line">      <span class="keyword">if</span>(key.equals(pairs[i][<span class="number">0</span>]))</span><br><span class="line">        <span class="keyword">return</span> (V)pairs[i][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>; <span class="comment">// Did not find key</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    StringBuilder result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">      result.append(pairs[i][<span class="number">0</span>].toString());</span><br><span class="line">      result.append(<span class="string">&quot; : &quot;</span>);</span><br><span class="line">      result.append(pairs[i][<span class="number">1</span>].toString());</span><br><span class="line">      <span class="keyword">if</span>(i &lt; index - <span class="number">1</span>)</span><br><span class="line">        result.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result.toString();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    AssociativeArray&lt;String,String&gt; map =</span><br><span class="line">      <span class="keyword">new</span> AssociativeArray&lt;String,String&gt;(<span class="number">6</span>);</span><br><span class="line">    map.put(<span class="string">&quot;sky&quot;</span>, <span class="string">&quot;blue&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;grass&quot;</span>, <span class="string">&quot;green&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;ocean&quot;</span>, <span class="string">&quot;dancing&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;tree&quot;</span>, <span class="string">&quot;tall&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;earth&quot;</span>, <span class="string">&quot;brown&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;sun&quot;</span>, <span class="string">&quot;warm&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      map.put(<span class="string">&quot;extra&quot;</span>, <span class="string">&quot;object&quot;</span>); <span class="comment">// Past the end</span></span><br><span class="line">    &#125; <span class="keyword">catch</span>(ArrayIndexOutOfBoundsException e) &#123;</span><br><span class="line">      print(<span class="string">&quot;Too many objects!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    print(map);</span><br><span class="line">    print(map.get(<span class="string">&quot;ocean&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">Too many objects!</span></span><br><span class="line"><span class="comment">sky : blue</span></span><br><span class="line"><span class="comment">grass : green</span></span><br><span class="line"><span class="comment">ocean : dancing</span></span><br><span class="line"><span class="comment">tree : tall</span></span><br><span class="line"><span class="comment">earth : brown</span></span><br><span class="line"><span class="comment">sun : warm</span></span><br><span class="line"><span class="comment">dancing</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h3 id="8-1-性能"><a href="#8-1-性能" class="headerlink" title="8.1 性能"></a>8.1 性能</h3><ul>
<li>HashMap：<code>Map</code>基于散列表的实现（它取代了Hashtable），插入和查询键值对的开销是固定的。可以通过构造器设置<code>容量</code>和<code>负载因子</code>，以调整容器的性能。</li>
<li>LinkedHashMap：类似于<code>HashMap</code>，但是迭代遍历的顺序是插入次序，或者是<strong>最近最少使用（LRU）</strong>的次序。只比<code>HashMap</code>慢一点，而在迭代访问时反而更快，因为它使用链表维护内部次序。</li>
<li>TreeMap：基于红黑树的实现。查看“键”或“键值对”时，它们会被排序（次序由Comparable或Comparator决定）。 <code>TreeMap</code>的特点在于，所得到的结果是经过排序的。<code>TreeMap</code>是唯一的带有<code>subMap()</code>方法的<code>Map</code>，它可以返回一个子树。</li>
<li>WeakHashMap：<code>弱键（weak key）</code>映射，允许释放映射所指向的对象，这是为解决某类特殊问题而设计的。如果映射之外没有引用指向某个“键”，则次“键”可以被垃圾收集器回收。</li>
<li>ConcurrentHashMap：一种线程安全的<code>Map</code>，它不涉及同步加锁。</li>
<li>IdentityHashMap：使用==替代<code>equals()</code>对“键”进行比较的散列映射。专为解决特殊问题而设计的。</li>
</ul>
<p>任何键都必须具有一个<code>equals()</code>方法；如果键被用于散列Map，那么它必须还具有恰当的<code>hashCode()</code>方法；如果键被用于<code>TreeMap</code>，那么它必须实现<code>Comparable</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/Maps.java</span></span><br><span class="line"><span class="comment">// Things you can do with Maps.</span></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Maps</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printKeys</span><span class="params">(Map&lt;Integer,String&gt; map)</span> </span>&#123;</span><br><span class="line">    printnb(<span class="string">&quot;Size = &quot;</span> + map.size() + <span class="string">&quot;, &quot;</span>);</span><br><span class="line">    printnb(<span class="string">&quot;Keys: &quot;</span>);</span><br><span class="line">    print(map.keySet()); <span class="comment">// Produce a Set of the keys</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(Map&lt;Integer,String&gt; map)</span> </span>&#123;</span><br><span class="line">    print(map.getClass().getSimpleName());</span><br><span class="line">    map.putAll(<span class="keyword">new</span> CountingMapData(<span class="number">25</span>));</span><br><span class="line">    <span class="comment">// Map has &#x27;Set&#x27; behavior for keys:</span></span><br><span class="line">    map.putAll(<span class="keyword">new</span> CountingMapData(<span class="number">25</span>));</span><br><span class="line">    printKeys(map);</span><br><span class="line">    <span class="comment">// Producing a Collection of the values:</span></span><br><span class="line">    printnb(<span class="string">&quot;Values: &quot;</span>);</span><br><span class="line">    print(map.values());</span><br><span class="line">    print(map);</span><br><span class="line">    print(<span class="string">&quot;map.containsKey(11): &quot;</span> + map.containsKey(<span class="number">11</span>));</span><br><span class="line">    print(<span class="string">&quot;map.get(11): &quot;</span> + map.get(<span class="number">11</span>));</span><br><span class="line">    print(<span class="string">&quot;map.containsValue(\&quot;F0\&quot;): &quot;</span></span><br><span class="line">      + map.containsValue(<span class="string">&quot;F0&quot;</span>));</span><br><span class="line">    Integer key = map.keySet().iterator().next();</span><br><span class="line">    print(<span class="string">&quot;First key in map: &quot;</span> + key);</span><br><span class="line">    map.remove(key);</span><br><span class="line">    printKeys(map);</span><br><span class="line">    map.clear();</span><br><span class="line">    print(<span class="string">&quot;map.isEmpty(): &quot;</span> + map.isEmpty());</span><br><span class="line">    map.putAll(<span class="keyword">new</span> CountingMapData(<span class="number">25</span>));</span><br><span class="line">    <span class="comment">// Operations on the Set change the Map:</span></span><br><span class="line">    map.keySet().removeAll(map.keySet());</span><br><span class="line">    print(<span class="string">&quot;map.isEmpty(): &quot;</span> + map.isEmpty());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    test(<span class="keyword">new</span> HashMap&lt;Integer,String&gt;());</span><br><span class="line">    test(<span class="keyword">new</span> TreeMap&lt;Integer,String&gt;());</span><br><span class="line">    test(<span class="keyword">new</span> LinkedHashMap&lt;Integer,String&gt;());</span><br><span class="line">    test(<span class="keyword">new</span> IdentityHashMap&lt;Integer,String&gt;());</span><br><span class="line">    test(<span class="keyword">new</span> ConcurrentHashMap&lt;Integer,String&gt;());</span><br><span class="line">    test(<span class="keyword">new</span> WeakHashMap&lt;Integer,String&gt;());</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">HashMap</span></span><br><span class="line"><span class="comment">Size = 25, Keys: [15, 8, 23, 16, 7, 22, 9, 21, 6, 1, 14, 24, 4, 19, 11, 18, 3, 12, 17, 2, 13, 20, 10, 5, 0]</span></span><br><span class="line"><span class="comment">Values: [P0, I0, X0, Q0, H0, W0, J0, V0, G0, B0, O0, Y0, E0, T0, L0, S0, D0, M0, R0, C0, N0, U0, K0, F0, A0]</span></span><br><span class="line"><span class="comment">&#123;15=P0, 8=I0, 23=X0, 16=Q0, 7=H0, 22=W0, 9=J0, 21=V0, 6=G0, 1=B0, 14=O0, 24=Y0, 4=E0, 19=T0, 11=L0, 18=S0, 3=D0, 12=M0, 17=R0, 2=C0, 13=N0, 20=U0, 10=K0, 5=F0, 0=A0&#125;</span></span><br><span class="line"><span class="comment">map.containsKey(11): true</span></span><br><span class="line"><span class="comment">map.get(11): L0</span></span><br><span class="line"><span class="comment">map.containsValue(&quot;F0&quot;): true</span></span><br><span class="line"><span class="comment">First key in map: 15</span></span><br><span class="line"><span class="comment">Size = 24, Keys: [8, 23, 16, 7, 22, 9, 21, 6, 1, 14, 24, 4, 19, 11, 18, 3, 12, 17, 2, 13, 20, 10, 5, 0]</span></span><br><span class="line"><span class="comment">map.isEmpty(): true</span></span><br><span class="line"><span class="comment">map.isEmpty(): true</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h3 id="8-2-SortedMap"><a href="#8-2-SortedMap" class="headerlink" title="8.2 SortedMap"></a>8.2 SortedMap</h3><p>使用<code>SortedMap</code>，可以确保键处于排序状态。</p>
<ul>
<li>Comparator comparator()：返回当前<code>Map</code>使用的<code>Comparator</code>；或者返回 <code>null</code>，表示以自然方式排序。</li>
<li>T firstKey()：返回Map中的第一个键。</li>
<li>T lastKey()：返回Map中最末一个键。</li>
<li>SortedMap subMap(fromKey,toKey)：生成此Map的子集，范围由<code>fromKey</code>到<code>toKey</code>的键确定。</li>
<li>SortedMap headMap(toKey)：由键小于<code>toKey</code>的所有键值对组成。</li>
<li>SortedMap tailMap(fromKey)：由键大于或等于<code>fromKey</code>的所有键值对组成。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/SortedMapDemo.java</span></span><br><span class="line"><span class="comment">// What you can do with a TreeMap.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SortedMapDemo</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    TreeMap&lt;Integer,String&gt; sortedMap =</span><br><span class="line">      <span class="keyword">new</span> TreeMap&lt;Integer,String&gt;(<span class="keyword">new</span> CountingMapData(<span class="number">10</span>));</span><br><span class="line">    print(sortedMap);</span><br><span class="line">    Integer low = sortedMap.firstKey();</span><br><span class="line">    Integer high = sortedMap.lastKey();</span><br><span class="line">    print(low);</span><br><span class="line">    print(high);</span><br><span class="line">    Iterator&lt;Integer&gt; it = sortedMap.keySet().iterator();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span>(i == <span class="number">3</span>) low = it.next();</span><br><span class="line">      <span class="keyword">if</span>(i == <span class="number">6</span>) high = it.next();</span><br><span class="line">      <span class="keyword">else</span> it.next();</span><br><span class="line">    &#125;</span><br><span class="line">    print(low);</span><br><span class="line">    print(high);</span><br><span class="line">    print(sortedMap.subMap(low, high));</span><br><span class="line">    print(sortedMap.headMap(high));</span><br><span class="line">    print(sortedMap.tailMap(low));</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">&#123;0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0, 9=J0&#125;</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">9</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">&#123;3=D0, 4=E0, 5=F0, 6=G0&#125;</span></span><br><span class="line"><span class="comment">&#123;0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0&#125;</span></span><br><span class="line"><span class="comment">&#123;3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0, 9=J0&#125;</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h3 id="8-3-LinkedHashMap"><a href="#8-3-LinkedHashMap" class="headerlink" title="8.3 LinkedHashMap"></a>8.3 LinkedHashMap</h3><p><code>LinkedHashMap</code>散列化所有的元素，但是在遍历键值对时，却又以元素的插入顺序返回键值对。此外，可以在构造器中设定<code>LinkedHashMap</code>，使之采用基于访问的<code>最近最少使用（LRU）</code>算法，于是没有被访问过的元素就会出现在队列的前面。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/LinkedHashMapDemo.java</span></span><br><span class="line"><span class="comment">// What you can do with a LinkedHashMap.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedHashMapDemo</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    LinkedHashMap&lt;Integer,String&gt; linkedMap = <span class="keyword">new</span> LinkedHashMap&lt;Integer,String&gt;(<span class="keyword">new</span> CountingMapData(<span class="number">9</span>));</span><br><span class="line">    print(linkedMap);</span><br><span class="line">    <span class="comment">// Least-recently-used order:</span></span><br><span class="line">    linkedMap = <span class="keyword">new</span> LinkedHashMap&lt;Integer,String&gt;(<span class="number">16</span>, <span class="number">0.75f</span>, <span class="keyword">true</span>);<span class="comment">//</span></span><br><span class="line">    linkedMap.putAll(<span class="keyword">new</span> CountingMapData(<span class="number">9</span>));</span><br><span class="line">    print(linkedMap);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) <span class="comment">// Cause accesses:</span></span><br><span class="line">      linkedMap.get(i);</span><br><span class="line">    print(linkedMap);</span><br><span class="line">    linkedMap.get(<span class="number">0</span>);</span><br><span class="line">    print(linkedMap);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">&#123;0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0&#125;</span></span><br><span class="line"><span class="comment">&#123;0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 6=G0, 7=H0, 8=I0&#125;</span></span><br><span class="line"><span class="comment">&#123;6=G0, 7=H0, 8=I0, 0=A0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0&#125;</span></span><br><span class="line"><span class="comment">&#123;6=G0, 7=H0, 8=I0, 1=B0, 2=C0, 3=D0, 4=E0, 5=F0, 0=A0&#125;</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h2 id="9-散列和散列码"><a href="#9-散列和散列码" class="headerlink" title="9.散列和散列码"></a>9.散列和散列码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/Groundhog.java</span></span><br><span class="line"><span class="comment">// Looks plausible, but doesn&#x27;t work as a HashMap key.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Groundhog</span> </span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">int</span> number;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Groundhog</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; number = n; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Groundhog #&quot;</span> + number;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//: containers/Prediction.java</span></span><br><span class="line"><span class="comment">// Predicting the weather with groundhogs.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Prediction</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Random rand = <span class="keyword">new</span> Random(<span class="number">47</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">boolean</span> shadow = rand.nextDouble() &gt; <span class="number">0.5</span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(shadow)</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;Six more weeks of Winter!&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;Early Spring!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//: containers/SpringDetector.java</span></span><br><span class="line"><span class="comment">// What will the weather be?</span></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringDetector</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Uses a Groundhog or class derived from Groundhog:</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;T extends Groundhog&gt;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">detectSpring</span><span class="params">(Class&lt;T&gt; type)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    Constructor&lt;T&gt; ghog = type.getConstructor(<span class="keyword">int</span>.class);</span><br><span class="line">    Map&lt;Groundhog,Prediction&gt; map =</span><br><span class="line">      <span class="keyword">new</span> HashMap&lt;Groundhog,Prediction&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">      map.put(ghog.newInstance(i), <span class="keyword">new</span> Prediction());</span><br><span class="line">    print(<span class="string">&quot;map = &quot;</span> + map);</span><br><span class="line">    Groundhog gh = ghog.newInstance(<span class="number">3</span>);</span><br><span class="line">    print(<span class="string">&quot;Looking up prediction for &quot;</span> + gh);</span><br><span class="line">    <span class="keyword">if</span>(map.containsKey(gh))</span><br><span class="line">      print(map.get(gh));</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      print(<span class="string">&quot;Key not found: &quot;</span> + gh);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    detectSpring(Groundhog.class);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">map = &#123;Groundhog #3=Early Spring!, Groundhog #7=Early Spring!, Groundhog #5=Early Spring!, Groundhog #9=Six more weeks of Winter!, Groundhog #8=Six more weeks of Winter!, Groundhog #0=Six more weeks of Winter!, Groundhog #6=Early Spring!, Groundhog #4=Six more weeks of Winter!, Groundhog #1=Six more weeks of Winter!, Groundhog #2=Early Spring!&#125;</span></span><br><span class="line"><span class="comment">Looking up prediction for Groundhog #3</span></span><br><span class="line"><span class="comment">Key not found: Groundhog #3</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<p>正确的<code>equals()</code>方法必须满足下列5个条件： 1. 自反性。对任意x，x.equals(x)一定返回<code>true</code>。 2. 对称性。对任意x和y，如果<code>y.equals(x)</code>返回<code>true</code>，则<code>x.equals(y)</code>也返回<code>true</code>。 3. 传递性。对任意x、y、z，如果有<code>x.equals(y)</code>返回<code>true</code>，则<code>x.equals(z)</code>一定返回<code>true</code>。 4. 一致性。对任意x和y，如果对象中用于等价比较的信息没有改变，那么无论调用<code>x.equals(y)</code>多少次，返回的结果应该保持一致，要么一直是<code>true</code>，要么一直是<code>false</code>。 5. 对任何不是<code>null</code>的x，<code>x.equals(null)</code>一定返回<code>false</code>。</p>
<p>同时重载<code>hashCode()</code>和<code>equals()</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/Groundhog2.java</span></span><br><span class="line"><span class="comment">// A class that&#x27;s used as a key in a HashMap</span></span><br><span class="line"><span class="comment">// must override hashCode() and equals().</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Groundhog2</span> <span class="keyword">extends</span> <span class="title">Groundhog</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Groundhog2</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; <span class="keyword">super</span>(n); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> number; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> o <span class="keyword">instanceof</span> Groundhog2 &amp;&amp;</span><br><span class="line">      (number == ((Groundhog2)o).number);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//: containers/SpringDetector2.java</span></span><br><span class="line"><span class="comment">// A working key.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringDetector2</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    SpringDetector.detectSpring(Groundhog2.class);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">map = &#123;Groundhog #2=Early Spring!, Groundhog #4=Six more weeks of Winter!, Groundhog #9=Six more weeks of Winter!, Groundhog #8=Six more weeks of Winter!, Groundhog #6=Early Spring!, Groundhog #1=Six more weeks of Winter!, Groundhog #3=Early Spring!, Groundhog #7=Early Spring!, Groundhog #5=Early Spring!, Groundhog #0=Six more weeks of Winter!&#125;</span></span><br><span class="line"><span class="comment">Looking up prediction for Groundhog #3</span></span><br><span class="line"><span class="comment">Early Spring!</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h3 id="9-1-理解hashCode"><a href="#9-1-理解hashCode" class="headerlink" title="9.1 理解hashCode()"></a>9.1 理解hashCode()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/SlowMap.java</span></span><br><span class="line"><span class="comment">// A Map implemented with ArrayLists.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SlowMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> List&lt;K&gt; keys = <span class="keyword">new</span> ArrayList&lt;K&gt;();</span><br><span class="line">  <span class="keyword">private</span> List&lt;V&gt; values = <span class="keyword">new</span> ArrayList&lt;V&gt;();</span><br><span class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    V oldValue = get(key); <span class="comment">// The old value or null</span></span><br><span class="line">    <span class="keyword">if</span>(!keys.contains(key)) &#123;</span><br><span class="line">      keys.add(key);</span><br><span class="line">      values.add(value);</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">      values.set(keys.indexOf(key), value);</span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123; <span class="comment">// key is type Object, not K</span></span><br><span class="line">    <span class="keyword">if</span>(!keys.contains(key))</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">return</span> values.get(keys.indexOf(key));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet() &#123;</span><br><span class="line">    Set&lt;Map.Entry&lt;K,V&gt;&gt; set= <span class="keyword">new</span> HashSet&lt;Map.Entry&lt;K,V&gt;&gt;();</span><br><span class="line">    Iterator&lt;K&gt; ki = keys.iterator();</span><br><span class="line">    Iterator&lt;V&gt; vi = values.iterator();</span><br><span class="line">    <span class="keyword">while</span>(ki.hasNext())</span><br><span class="line">      set.add(<span class="keyword">new</span> MapEntry&lt;K,V&gt;(ki.next(), vi.next()));</span><br><span class="line">    <span class="keyword">return</span> set;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SlowMap&lt;String,String&gt; m= <span class="keyword">new</span> SlowMap&lt;String,String&gt;();</span><br><span class="line">    m.putAll(Countries.capitals(<span class="number">15</span>));</span><br><span class="line">    System.out.println(m);</span><br><span class="line">    System.out.println(m.get(<span class="string">&quot;BULGARIA&quot;</span>));</span><br><span class="line">    System.out.println(m.entrySet());</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">&#123;CAMEROON=Yaounde, CHAD=N&#x27;djamena, CONGO=Brazzaville, CAPE VERDE=Praia, ALGERIA=Algiers, COMOROS=Moroni, CENTRAL AFRICAN REPUBLIC=Bangui, BOTSWANA=Gaberone, BURUNDI=Bujumbura, BENIN=Porto-Novo, BULGARIA=Sofia, EGYPT=Cairo, ANGOLA=Luanda, BURKINA FASO=Ouagadougou, DJIBOUTI=Dijibouti&#125;</span></span><br><span class="line"><span class="comment">Sofia</span></span><br><span class="line"><span class="comment">[CAMEROON=Yaounde, CHAD=N&#x27;djamena, CONGO=Brazzaville, CAPE VERDE=Praia, ALGERIA=Algiers, COMOROS=Moroni, CENTRAL AFRICAN REPUBLIC=Bangui, BOTSWANA=Gaberone, BURUNDI=Bujumbura, BENIN=Porto-Novo, BULGARIA=Sofia, EGYPT=Cairo, ANGOLA=Luanda, BURKINA FASO=Ouagadougou, DJIBOUTI=Dijibouti]</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/MapEntry.java</span></span><br><span class="line"><span class="comment">// A simple Map.Entry for sample Map implementations.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapEntry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> K key;</span><br><span class="line">  <span class="keyword">private</span> V value;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MapEntry</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.key = key;</span><br><span class="line">    <span class="keyword">this</span>.value = value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> K <span class="title">getKey</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> key; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">getValue</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">setValue</span><span class="params">(V v)</span> </span>&#123;</span><br><span class="line">    V result = value;</span><br><span class="line">    value = v;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (key==<span class="keyword">null</span> ? <span class="number">0</span> : key.hashCode()) ^</span><br><span class="line">      (value==<span class="keyword">null</span> ? <span class="number">0</span> : value.hashCode());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!(o <span class="keyword">instanceof</span> MapEntry)) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    MapEntry me = (MapEntry)o;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">      (key == <span class="keyword">null</span> ?</span><br><span class="line">       me.getKey() == <span class="keyword">null</span> : key.equals(me.getKey())) &amp;&amp;</span><br><span class="line">      (value == <span class="keyword">null</span> ?</span><br><span class="line">       me.getValue()== <span class="keyword">null</span> : value.equals(me.getValue()));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> key + <span class="string">&quot;=&quot;</span> + value; &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>

<h3 id="9-2-为速度而散列"><a href="#9-2-为速度而散列" class="headerlink" title="9.2 为速度而散列"></a>9.2 为速度而散列</h3><p>散列将键保存在某处，以便能够很快找到。存储一组元素最快的数据结构是数组，所以使用它来表示键的信息。数组并不保存键本来。而是通过键对象生成一个数字，将其作为数组的下标。这个数字就是散列码，由定义在<code>Object</code>中的，且可能由你的类覆盖的<code>hashCode()</code>方法生成。</p>
<p>为解决数组容量被固定的问题，不同的键可以产生相同的下标。也就是说，可能会有<code>冲突</code>。因此，数组多大就不重要了，任何键总能在数组中找到它的位置。</p>
<p>于是查询一个值的过程首先就是计算散列码，然后使用散列码查询数组。如果能够保证没有冲突，那可就有一个<code>完美的散列函数</code>，但是这种情况只是特例。通常，冲突由<code>外部链接处理</code>：数组并不直接保存值，而是保存值的<code>list</code>。然后对<code>list</code>中的值使用<code>equals()</code>方法进行线性的查询。这部分的查询自然比较慢，但是，如果散列函数好的话，数组的每个位置就只有较少的值。因此，不是查询整个<code>list</code>，而是快速地跳到数组的某个位置，只对很少的元素进行比较。这便是<code>HashMap</code>会如此快的原因。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/SimpleHashMap.java</span></span><br><span class="line"><span class="comment">// A demonstration hashed Map.</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> net.mindview.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleHashMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// Choose a prime number for the hash table</span></span><br><span class="line">  <span class="comment">// size, to achieve a uniform distribution:</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SIZE = <span class="number">997</span>;</span><br><span class="line">  <span class="comment">// You can&#x27;t have a physical array of generics,</span></span><br><span class="line">  <span class="comment">// but you can upcast to one:</span></span><br><span class="line">  <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">  LinkedList&lt;MapEntry&lt;K,V&gt;&gt;[] buckets = <span class="keyword">new</span> LinkedList[SIZE];</span><br><span class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    V oldValue = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">int</span> index = Math.abs(key.hashCode()) % SIZE;</span><br><span class="line">    <span class="keyword">if</span>(buckets[index] == <span class="keyword">null</span>)</span><br><span class="line">      buckets[index] = <span class="keyword">new</span> LinkedList&lt;MapEntry&lt;K,V&gt;&gt;();</span><br><span class="line">    LinkedList&lt;MapEntry&lt;K,V&gt;&gt; bucket = buckets[index];</span><br><span class="line">    MapEntry&lt;K,V&gt; pair = <span class="keyword">new</span> MapEntry&lt;K,V&gt;(key, value);</span><br><span class="line">    <span class="keyword">boolean</span> found = <span class="keyword">false</span>;</span><br><span class="line">    ListIterator&lt;MapEntry&lt;K,V&gt;&gt; it = bucket.listIterator();</span><br><span class="line">    <span class="keyword">while</span>(it.hasNext()) &#123;</span><br><span class="line">      MapEntry&lt;K,V&gt; iPair = it.next();</span><br><span class="line">      <span class="keyword">if</span>(iPair.getKey().equals(key)) &#123;</span><br><span class="line">        oldValue = iPair.getValue();</span><br><span class="line">        it.set(pair); <span class="comment">// Replace old with new</span></span><br><span class="line">        found = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!found)</span><br><span class="line">      buckets[index].add(pair);</span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> index = Math.abs(key.hashCode()) % SIZE;</span><br><span class="line">    <span class="keyword">if</span>(buckets[index] == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">for</span>(MapEntry&lt;K,V&gt; iPair : buckets[index])</span><br><span class="line">      <span class="keyword">if</span>(iPair.getKey().equals(key))</span><br><span class="line">        <span class="keyword">return</span> iPair.getValue();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet() &#123;</span><br><span class="line">    Set&lt;Map.Entry&lt;K,V&gt;&gt; set= <span class="keyword">new</span> HashSet&lt;Map.Entry&lt;K,V&gt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(LinkedList&lt;MapEntry&lt;K,V&gt;&gt; bucket : buckets) &#123;</span><br><span class="line">      <span class="keyword">if</span>(bucket == <span class="keyword">null</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">for</span>(MapEntry&lt;K,V&gt; mpair : bucket)</span><br><span class="line">        set.add(mpair);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> set;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SimpleHashMap&lt;String,String&gt; m =</span><br><span class="line">      <span class="keyword">new</span> SimpleHashMap&lt;String,String&gt;();</span><br><span class="line">    m.putAll(Countries.capitals(<span class="number">25</span>));</span><br><span class="line">    System.out.println(m);</span><br><span class="line">    System.out.println(m.get(<span class="string">&quot;ERITREA&quot;</span>));</span><br><span class="line">    System.out.println(m.entrySet());</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">&#123;CAMEROON=Yaounde, CONGO=Brazzaville, CHAD=N&#x27;djamena, COTE D&#x27;IVOIR (IVORY COAST)=Yamoussoukro, CENTRAL AFRICAN REPUBLIC=Bangui, GUINEA=Conakry, BOTSWANA=Gaberone, BISSAU=Bissau, EGYPT=Cairo, ANGOLA=Luanda, BURKINA FASO=Ouagadougou, ERITREA=Asmara, THE GAMBIA=Banjul, KENYA=Nairobi, GABON=Libreville, CAPE VERDE=Praia, ALGERIA=Algiers, COMOROS=Moroni, EQUATORIAL GUINEA=Malabo, BURUNDI=Bujumbura, BENIN=Porto-Novo, BULGARIA=Sofia, GHANA=Accra, DJIBOUTI=Dijibouti, ETHIOPIA=Addis Ababa&#125;</span></span><br><span class="line"><span class="comment">Asmara</span></span><br><span class="line"><span class="comment">[CAMEROON=Yaounde, CONGO=Brazzaville, CHAD=N&#x27;djamena, COTE D&#x27;IVOIR (IVORY COAST)=Yamoussoukro, CENTRAL AFRICAN REPUBLIC=Bangui, GUINEA=Conakry, BOTSWANA=Gaberone, BISSAU=Bissau, EGYPT=Cairo, ANGOLA=Luanda, BURKINA FASO=Ouagadougou, ERITREA=Asmara, THE GAMBIA=Banjul, KENYA=Nairobi, GABON=Libreville, CAPE VERDE=Praia, ALGERIA=Algiers, COMOROS=Moroni, EQUATORIAL GUINEA=Malabo, BURUNDI=Bujumbura, BENIN=Porto-Novo, BULGARIA=Sofia, GHANA=Accra, DJIBOUTI=Dijibouti, ETHIOPIA=Addis Ababa]</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<p>由于散列表中“槽位”通常称为<code>桶位（bucket）</code>，因此我们将表示实际散列表的数组命名为<code>bucket</code>，为使散列分布均匀，桶的数量通常使用质数。注意，为了能够自动处理冲突，使用一个<code>LinkedList</code>的数组；每一个新的元素只是直接添加到list末尾的某个特定桶位中。</p>
<h3 id="9-3-覆盖hashCode"><a href="#9-3-覆盖hashCode" class="headerlink" title="9.3 覆盖hashCode()"></a>9.3 覆盖hashCode()</h3><p>首先，你无法控制<code>bucket</code>数组的下标值的产生。这个值依赖于具体的<code>HashMap</code>对象的容量，而容量的改变与容器的充满程度和负载因子有关。<code>hashCode()</code>生成的结果，经过处理后成为桶位的下标。</p>
<p>设计<code>hashCode()</code>时最重要的因素就是：无论何时，对同一个对象调用<code>hashCode()</code>都应该生成同样的值。如果将一个对象用<code>put()</code>添加进<code>HashMap</code>时产生一个<code>hashCode()</code>值，而用<code>get()</code>取出时却产生了另一个<code>hashCode</code>值，那么聚无法重新取得该对象了。所以，如果你的<code>hashCode()</code>方法依赖于对象中易变的数据，用户就要当心了，因为此数据变化时，<code>hashCode()</code>就会生成一个不同的散列码，相当于产生了一个不同的键。</p>
<p>此外，也不应该使<code>hashCode()</code>依赖于具有唯一性的对象信息，尤其是使用<code>this</code>的值，这只能产生很糟糕的<code>hashCode()</code>。因为这样无法生成一个新的键，使之与<code>put()</code>中原始的键值对中的键相同。</p>
<p>Effective Java 为怎样写出一份像样<code>hashCode()</code>给出了基本的指导： 1.给int变量result赋予某个非零值常量，例如17 2.为对象内每个有意义的域f（即每个可以做equals()操作的域）计算出一个int散列码c:</p>
<table>
<thead>
<tr>
<th align="left">域类型</th>
<th align="left">计算</th>
</tr>
</thead>
<tbody><tr>
<td align="left">boolean</td>
<td align="left">c=(f?0:1)</td>
</tr>
<tr>
<td align="left">byte、char、short或int</td>
<td align="left">c=(int)f</td>
</tr>
<tr>
<td align="left">long</td>
<td align="left">c=(int)(f^f&gt;&gt;&gt;32)</td>
</tr>
<tr>
<td align="left">float</td>
<td align="left">c=Float.floatToIntBits(f)</td>
</tr>
<tr>
<td align="left">double</td>
<td align="left">long l= Double.doubleToLongBits();c=(int)(l^(l&gt;&gt;&gt;32))</td>
</tr>
<tr>
<td align="left">Object,其equals()调用这个域的equals()</td>
<td align="left">c=f.hashCode()</td>
</tr>
<tr>
<td align="left">数组</td>
<td align="left">对每个元素应用上述规则</td>
</tr>
</tbody></table>
<p>3.合并计算得到的散列码</p>
<p>result = 37*result+c;</p>
<p>4.返回result. 5.检查hashCode()最后生成的结果，确保相同的对象有相同的散列码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: containers/CountedString.java</span></span><br><span class="line"><span class="comment">// Creating a good hashCode().</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> net.mindview.util.Print.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountedString</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> List&lt;String&gt; created =</span><br><span class="line">    <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">  <span class="keyword">private</span> String s;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CountedString</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    s = str;</span><br><span class="line">    created.add(s);</span><br><span class="line">    <span class="comment">// id is the total number of instances</span></span><br><span class="line">    <span class="comment">// of this string in use by CountedString:</span></span><br><span class="line">    <span class="keyword">for</span>(String s2 : created)</span><br><span class="line">      <span class="keyword">if</span>(s2.equals(s))</span><br><span class="line">        id++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;String: &quot;</span> + s + <span class="string">&quot; id: &quot;</span> + id +</span><br><span class="line">      <span class="string">&quot; hashCode(): &quot;</span> + hashCode();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// The very simple approach:</span></span><br><span class="line">    <span class="comment">// return s.hashCode() * id;</span></span><br><span class="line">    <span class="comment">// Using Joshua Bloch&#x27;s recipe:</span></span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">17</span>;</span><br><span class="line">    result = <span class="number">37</span> * result + s.hashCode();</span><br><span class="line">    result = <span class="number">37</span> * result + id;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> o <span class="keyword">instanceof</span> CountedString &amp;&amp;</span><br><span class="line">      s.equals(((CountedString)o).s) &amp;&amp;</span><br><span class="line">      id == ((CountedString)o).id;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Map&lt;CountedString,Integer&gt; map =</span><br><span class="line">      <span class="keyword">new</span> HashMap&lt;CountedString,Integer&gt;();</span><br><span class="line">    CountedString[] cs = <span class="keyword">new</span> CountedString[<span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cs.length; i++) &#123;</span><br><span class="line">      cs[i] = <span class="keyword">new</span> CountedString(<span class="string">&quot;hi&quot;</span>);</span><br><span class="line">      map.put(cs[i], i); <span class="comment">// Autobox int -&gt; Integer</span></span><br><span class="line">    &#125;</span><br><span class="line">    print(map);</span><br><span class="line">    <span class="keyword">for</span>(CountedString cstring : cs) &#123;</span><br><span class="line">      print(<span class="string">&quot;Looking up &quot;</span> + cstring);</span><br><span class="line">      print(map.get(cstring));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output: (Sample)</span></span><br><span class="line"><span class="comment">&#123;String: hi id: 4 hashCode(): 146450=3, String: hi id: 1 hashCode(): 146447=0, String: hi id: 3 hashCode(): 146449=2, String: hi id: 5 hashCode(): 146451=4, String: hi id: 2 hashCode(): 146448=1&#125;</span></span><br><span class="line"><span class="comment">Looking up String: hi id: 1 hashCode(): 146447</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">Looking up String: hi id: 2 hashCode(): 146448</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">Looking up String: hi id: 3 hashCode(): 146449</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">Looking up String: hi id: 4 hashCode(): 146450</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">Looking up String: hi id: 5 hashCode(): 146451</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h2 id="10-选择接口的不同实现"><a href="#10-选择接口的不同实现" class="headerlink" title="10.选择接口的不同实现"></a>10.选择接口的不同实现</h2><h3 id="10-1-性能测试框架"><a href="#10-1-性能测试框架" class="headerlink" title="10.1 性能测试框架"></a>10.1 性能测试框架</h3><h3 id="10-2-对List的选择"><a href="#10-2-对List的选择" class="headerlink" title="10.2 对List的选择"></a>10.2 对List的选择</h3><h3 id="10-3-微基准测试的危险"><a href="#10-3-微基准测试的危险" class="headerlink" title="10.3 微基准测试的危险"></a>10.3 微基准测试的危险</h3><h3 id="10-4-对Set的选择"><a href="#10-4-对Set的选择" class="headerlink" title="10.4 对Set的选择"></a>10.4 对Set的选择</h3><h3 id="10-5-对Map的选择"><a href="#10-5-对Map的选择" class="headerlink" title="10.5 对Map的选择"></a>10.5 对Map的选择</h3><h2 id="11-实用方法"><a href="#11-实用方法" class="headerlink" title="11.实用方法"></a>11.实用方法</h2><h3 id="11-1-List的排序和查询"><a href="#11-1-List的排序和查询" class="headerlink" title="11.1 List的排序和查询"></a>11.1 List的排序和查询</h3><h3 id="11-2-设定Collection或Map为不可修改"><a href="#11-2-设定Collection或Map为不可修改" class="headerlink" title="11.2 设定Collection或Map为不可修改"></a>11.2 设定Collection或Map为不可修改</h3><h3 id="11-3-Collection或Map的同步控制"><a href="#11-3-Collection或Map的同步控制" class="headerlink" title="11.3 Collection或Map的同步控制"></a>11.3 Collection或Map的同步控制</h3><h2 id="12-持有引用"><a href="#12-持有引用" class="headerlink" title="12.持有引用"></a>12.持有引用</h2><h3 id="12-1-WeakHashMap"><a href="#12-1-WeakHashMap" class="headerlink" title="12.1 WeakHashMap"></a>12.1 WeakHashMap</h3><h2 id="13-Java1-0-1-1的容器"><a href="#13-Java1-0-1-1的容器" class="headerlink" title="13.Java1.0/1.1的容器"></a>13.Java1.0/1.1的容器</h2><h3 id="13-2-Hashtable"><a href="#13-2-Hashtable" class="headerlink" title="13.2 Hashtable"></a>13.2 Hashtable</h3><h3 id="13-3-Stack"><a href="#13-3-Stack" class="headerlink" title="13.3 Stack"></a>13.3 Stack</h3><h3 id="13-4-BitSet"><a href="#13-4-BitSet" class="headerlink" title="13.4 BitSet"></a>13.4 BitSet</h3></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">马林康</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://malinkang.cn/2016/07/02/thinking-in-java-containers-in-depth/">https://malinkang.cn/2016/07/02/thinking-in-java-containers-in-depth/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://malinkang.cn" target="_blank">马林康的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a><a class="post-meta__tags" href="/tags/Thinking-in-Java/">Thinking in Java</a></div><div class="post_share"><div class="social-share" data-image="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字37.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2016/07/09/thinking-in-java-i-o/"><img class="prev-cover" src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字11.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">《Java编程思想》第18章I/O系统</div></div></a></div><div class="next-post pull-right"><a href="/2016/06/25/thinking-in-java-arrays/"><img class="next-cover" src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字04.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">《Java编程思想》第16章数组</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2016/04/02/thinking-in-java-controlling-execution/" title="《Java编程思想》第4章控制流程"><img class="cover" src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字35.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-04-02</div><div class="title">《Java编程思想》第4章控制流程</div></div></a></div><div><a href="/2016/03/26/thinking-in-java-operators/" title="《Java编程思想》第3章操作符"><img class="cover" src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字19.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-03-26</div><div class="title">《Java编程思想》第3章操作符</div></div></a></div><div><a href="/2016/05/28/thinking-in-java-error-handling-with-exceptions/" title="《Java编程思想》第12章通过异常处理错误"><img class="cover" src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字48.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-05-28</div><div class="title">《Java编程思想》第12章通过异常处理错误</div></div></a></div><div><a href="/2016/04/16/thinking-in-java-access-control/" title="《Java编程思想》第6章访问权限控制"><img class="cover" src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字17.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-04-16</div><div class="title">《Java编程思想》第6章访问权限控制</div></div></a></div><div><a href="/2016/07/23/thinking-in-java-annotations/" title="《Java编程思想》读书笔记第20章注解"><img class="cover" src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字41.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-07-23</div><div class="title">《Java编程思想》读书笔记第20章注解</div></div></a></div><div><a href="/2016/07/30/thinking-in-java-concurrency/" title="《Java编程思想》第21章并发"><img class="cover" src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/你的名字25.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-07-30</div><div class="title">《Java编程思想》第21章并发</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">马林康</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">51</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/malinkang" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://twitter.com/maliinkang" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a><a class="social-icon" href="https://weibo.com/maliinkang" target="_blank" title="Weibo"><i class="fab fa-weibo"></i></a><a class="social-icon" href="https://instagram.com/maliinkang" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AE%8C%E6%95%B4%E7%9A%84%E5%AE%B9%E5%99%A8%E5%88%86%E7%B1%BB%E6%B3%95"><span class="toc-number">1.</span> <span class="toc-text">1.完整的容器分类法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%A1%AB%E5%85%85%E5%AE%B9%E5%99%A8"><span class="toc-number">2.</span> <span class="toc-text">2.填充容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E4%B8%80%E7%A7%8DGenerator%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 一种Generator解决方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Map%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 Map生成器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E4%BD%BF%E7%94%A8Abstract%E7%B1%BB"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 使用Abstract类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Collection%E7%9A%84%E5%8A%9F%E8%83%BD%E6%96%B9%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">3.Collection的功能方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8F%AF%E9%80%89%E6%93%8D%E4%BD%9C"><span class="toc-number">4.</span> <span class="toc-text">4.可选操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-List%E7%9A%84%E5%8A%9F%E8%83%BD%E6%96%B9%E6%B3%95"><span class="toc-number">5.</span> <span class="toc-text">5.List的功能方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Set%E5%92%8C%E5%AD%98%E5%82%A8%E9%A1%BA%E5%BA%8F"><span class="toc-number">6.</span> <span class="toc-text">6.Set和存储顺序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-SortedSet"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 SortedSet</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E9%98%9F%E5%88%97"><span class="toc-number">7.</span> <span class="toc-text">7.队列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E4%BC%98%E5%85%88%E7%BA%A7%E9%98%9F%E5%88%97"><span class="toc-number">7.1.</span> <span class="toc-text">7.1 优先级队列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2%E5%8F%8C%E5%90%91%E9%98%9F%E5%88%97"><span class="toc-number">7.2.</span> <span class="toc-text">7.2双向队列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Map"><span class="toc-number">8.</span> <span class="toc-text">8.Map</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E6%80%A7%E8%83%BD"><span class="toc-number">8.1.</span> <span class="toc-text">8.1 性能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-SortedMap"><span class="toc-number">8.2.</span> <span class="toc-text">8.2 SortedMap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-LinkedHashMap"><span class="toc-number">8.3.</span> <span class="toc-text">8.3 LinkedHashMap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%95%A3%E5%88%97%E5%92%8C%E6%95%A3%E5%88%97%E7%A0%81"><span class="toc-number">9.</span> <span class="toc-text">9.散列和散列码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E7%90%86%E8%A7%A3hashCode"><span class="toc-number">9.1.</span> <span class="toc-text">9.1 理解hashCode()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E4%B8%BA%E9%80%9F%E5%BA%A6%E8%80%8C%E6%95%A3%E5%88%97"><span class="toc-number">9.2.</span> <span class="toc-text">9.2 为速度而散列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E8%A6%86%E7%9B%96hashCode"><span class="toc-number">9.3.</span> <span class="toc-text">9.3 覆盖hashCode()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E9%80%89%E6%8B%A9%E6%8E%A5%E5%8F%A3%E7%9A%84%E4%B8%8D%E5%90%8C%E5%AE%9E%E7%8E%B0"><span class="toc-number">10.</span> <span class="toc-text">10.选择接口的不同实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6"><span class="toc-number">10.1.</span> <span class="toc-text">10.1 性能测试框架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E5%AF%B9List%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">10.2.</span> <span class="toc-text">10.2 对List的选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-%E5%BE%AE%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95%E7%9A%84%E5%8D%B1%E9%99%A9"><span class="toc-number">10.3.</span> <span class="toc-text">10.3 微基准测试的危险</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-%E5%AF%B9Set%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">10.4.</span> <span class="toc-text">10.4 对Set的选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-5-%E5%AF%B9Map%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">10.5.</span> <span class="toc-text">10.5 对Map的选择</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E5%AE%9E%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">11.</span> <span class="toc-text">11.实用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-List%E7%9A%84%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E8%AF%A2"><span class="toc-number">11.1.</span> <span class="toc-text">11.1 List的排序和查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E8%AE%BE%E5%AE%9ACollection%E6%88%96Map%E4%B8%BA%E4%B8%8D%E5%8F%AF%E4%BF%AE%E6%94%B9"><span class="toc-number">11.2.</span> <span class="toc-text">11.2 设定Collection或Map为不可修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-Collection%E6%88%96Map%E7%9A%84%E5%90%8C%E6%AD%A5%E6%8E%A7%E5%88%B6"><span class="toc-number">11.3.</span> <span class="toc-text">11.3 Collection或Map的同步控制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E6%8C%81%E6%9C%89%E5%BC%95%E7%94%A8"><span class="toc-number">12.</span> <span class="toc-text">12.持有引用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-WeakHashMap"><span class="toc-number">12.1.</span> <span class="toc-text">12.1 WeakHashMap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-Java1-0-1-1%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="toc-number">13.</span> <span class="toc-text">13.Java1.0&#x2F;1.1的容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-Hashtable"><span class="toc-number">13.1.</span> <span class="toc-text">13.2 Hashtable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-Stack"><span class="toc-number">13.2.</span> <span class="toc-text">13.3 Stack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-4-BitSet"><span class="toc-number">13.3.</span> <span class="toc-text">13.4 BitSet</span></a></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/01/19/deskclock-analysis/" title="deskclock-analysis"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="deskclock-analysis"/></a><div class="content"><a class="title" href="/2021/01/19/deskclock-analysis/" title="deskclock-analysis">deskclock-analysis</a><time datetime="2021-01-19T01:21:04.000Z" title="发表于 2021-01-19 09:21:04">2021-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/14/bound-services/" title="绑定服务"><img src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/千与千寻05.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="绑定服务"/></a><div class="content"><a class="title" href="/2020/12/14/bound-services/" title="绑定服务">绑定服务</a><time datetime="2020-12-14T11:18:41.000Z" title="发表于 2020-12-14 19:18:41">2020-12-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/07/workmanager-source-analysis/" title="WorkManager源码分析"><img src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/指环王.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WorkManager源码分析"/></a><div class="content"><a class="title" href="/2020/12/07/workmanager-source-analysis/" title="WorkManager源码分析">WorkManager源码分析</a><time datetime="2020-12-07T12:40:56.000Z" title="发表于 2020-12-07 20:40:56">2020-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/02/butterknife-source-analysis/" title="ButterKnife源码分析"><img src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/疯狂动物城.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ButterKnife源码分析"/></a><div class="content"><a class="title" href="/2020/12/02/butterknife-source-analysis/" title="ButterKnife源码分析">ButterKnife源码分析</a><time datetime="2020-12-02T08:37:06.000Z" title="发表于 2020-12-02 16:37:06">2020-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/27/rxjava-source-analysis/" title="RxJava源码分析"><img src="https://malinkang-1253444926.cos.ap-beijing.myqcloud.com/blog/images/cover/罗马假日.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RxJava源码分析"/></a><div class="content"><a class="title" href="/2020/11/27/rxjava-source-analysis/" title="RxJava源码分析">RxJava源码分析</a><time datetime="2020-11-27T15:47:34.000Z" title="发表于 2020-11-27 23:47:34">2020-11-27</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2014 - 2021 By 马林康</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://malinkang.cn/2016/07/02/thinking-in-java-containers-in-depth/'
    this.page.identifier = '2016/07/02/thinking-in-java-containers-in-depth/'
    this.page.title = '《Java编程思想》第17章容器深入研究'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://malinkang.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Disqus' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>